(globalThis.webpackChunk_flippingbook_publication=globalThis.webpackChunk_flippingbook_publication||[]).push([[10],{462:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});const s={computed:{fullPdf:function(){return this.$store.state.downloads.allPagesVisible&&this.$store.getters["downloads/getFullPdf"]},customFiles:function(){return this.$store.getters["downloads/getCustomFiles"]},pageFiles:function(){return this.$store.state.downloads.currentPagesVisible&&this.$store.getters["downloads/getPageFiles"]},windowTitle(){return this.$i18n.t("SaveWindow.TITLE")},fullTooltip(){return this.$t("SaveWindow.SAVE_FULL_PUBLICATION_TOOLTIP")},pagesTitle:function(){return{full:this.$t("SaveWindow.FULL_PUBLICATION"),left:this.$t("SaveWindow.SAVE_LEFT_PAGE"),right:this.$t("SaveWindow.SAVE_RIGHT_PAGE"),one:this.$t("SaveWindow.SAVE_CURRENT_PAGE"),withNotes:this.$t("SaveWindow.SAVE_WITH_NOTES"),cancel:this.$t("SaveWindow.CANCEL_BUTTON")}},pagesTooltip:function(){return{full:this.$t("SaveWindow.SAVE_FULL_PUBLICATION_TOOLTIP"),left:this.$t("SaveWindow.SAVE_LEFT_PAGE_TOOLTIP"),right:this.$t("SaveWindow.SAVE_RIGHT_PAGE_TOOLTIP"),one:this.$t("SaveWindow.SAVE_CURRENT_PAGE_TOOLTIP")}},infoMessages:function(){return{info:this.$t("SaveWindow.EMBED_NOTES_INFO"),error:this.$t("SaveWindow.ERROR_MESSAGE"),waiting:this.$t("SaveWindow.WAITING")}},pagerState:function(){return this.$store.getters["pager/legacyState"]}}}},6411:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var s=i(1443);const o={methods:{movePagerLeft:function(t){let{target:e}=t;(0,s.oJ)(this.$store,{target:e})},movePagerRight:function(t){let{target:e}=t;(0,s.X0)(this.$store,{target:e})},movePagerLeftmost:function(t){let{target:e=null,navTarget:i=!1}=t;(0,s.tc)(this.$store,{target:e,navTarget:i})},movePagerRightmost:function(t){let{target:e=null,navTarget:i=!1}=t;(0,s.w9)(this.$store,{target:e,navTarget:i})}}}},3866:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});const s={props:{itemData:{type:[Object,Array],required:!0}},name:"SearchResultItem",computed:{isItemDataArray(){return Array.isArray(this.itemData)},pageId(){return this.isItemDataArray?this.itemData[0].pageId:this.itemData.pageId},textData(){return this.isItemDataArray?this.itemData[0].relevance<=this.itemData[1].relevance?this.itemData[0].text:this.itemData[1].text:this.itemData.text},title:function(){let t;if(this.$store.state.pager.spreadMode)if(this.isItemDataArray){let e=this.$store.getters["pages/pageCaptionById"]({id:this.itemData[0].pageId.toString()}),i=this.$store.getters["pages/pageCaptionById"]({id:this.itemData[1].pageId.toString()});this.$store.state.book.rightToLeft&&([e,i]=[i,e]),t=e+" - "+i}else{const e=this.$store.getters["pages/pageIndexById"](this.pageId.toString()),i=e%2==0?e-1:e+1,s=this.$store.getters["pages/pageIdByIndex"](i);let o=this.$store.getters["pages/pageCaptionById"]({id:this.pageId.toString()});if(s){let r=this.$store.getters["pages/pageCaptionById"]({id:s.toString()});this.$store.state.book.rightToLeft&&([o,r]=[r,o]),t=e>i?r+" - "+o:o+" - "+r}else t=o}else t=this.$store.getters["pages/pageCaptionById"]({id:this.pageId.toString(),forceFullWide:this.itemData.isWide&&!this.itemData.isDivided,widePageSecondHalf:this.itemData.widePageSecondHalf});return this.$i18n.t("SearchToolWindow.PAGE_NUMBER",{0:t})},moreResults(){const t=this.isItemDataArray?this.itemData[0].count+this.itemData[1].count:this.itemData.count,e=this.isItemDataArray?this.itemData[0].relevance<=this.itemData[1].relevance?0:1:null,i=this.isItemDataArray?this.itemData[e].previewCount:this.itemData.previewCount;return t-i>0?"..."+this.$i18n.tc("SearchToolWindow.MORE_RESULTS",t-i,{0:t-i}):null}}}},2248:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});var s=i(6382),o=i.n(s);const r={data:function(){return{tempTimeout:null,showClear:!1,inputDir:this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"}},computed:{results:function(){return this.$store.state.search.results},progress:function(){return this.$store.getters["search/getProgress"]},isSearching:function(){return 100!==this.progress&&null!==this.progress},isInitializing:function(){return this.$store.getters["search/isInitializing"]},preloaderVisible:function(){return this.isSearching||this.isInitializing&&!this.searchQueryIsEmpty},searchQueryIsEmpty:function(){return 0===this.$store.state.search.query.length},exactMatch:{get:function(){return this.$store.state.search.exactMatch},set:function(t){this.$store.dispatch("search/setExactMatch",{component:"search",value:t}),this.updateSearchQuery()}}},methods:{input:function(t){if(t){if(this.showClear=!0,!t.trim())return}else this.showClear=!1;this.tempTimeout&&clearTimeout(this.tempTimeout),this.tempTimeout=setTimeout((function(){this.$refs.searchInput&&(this.tempTimeout=null,this.$root.log("search.query",this.$refs.searchInput.value),this.updateSearchQuery())}).bind(this),500),this.setInputDir()},updateSearchQuery:function(){let t=this.$refs.searchInput.value;t=t.trim().replace(/\s*(\s)\s*/gm,"$1"),this.$store.dispatch("search/setQuery",{value:t})},clear:function(){this.$refs.searchInput.value&&(this.$store.dispatch("search/setQuery",{value:""}),this.$refs.searchInput.value="",this.showClear=!1,this.$nextTick(this.focusInput)),this.setInputDir()},setInputDir:function(){if(this.$refs.searchInput.value){const t=o().getDirection(this.$refs.searchInput.value);this.inputDir=t?"ltr"===t?"ltr":"rtl":"ltr"}else this.inputDir=this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"}}}},663:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var s=i(6382),o=i.n(s),r=i(7503);const a={props:{data:{type:Object,required:!0}},components:{thumb:r.Z},computed:{singleMode(){return this.$store.state.pager.singleMode},textDirection:function(){return o().getDirection(this.data.caption)},itemStyles:function(){const t={};return this.data.size&&(t.width=this.data.size.width+"px",t.height=this.data.size.height+"px"),t},slideMode:function(){return this.$store.state.pager.slideMode},contentCrop:function(){return this.slideMode&&this.$store.state.book.contentCrop}}}},3549:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});const s={computed:{title:function(){return this.$i18n.t("ThumbnailsToolWindow.TITLE")},isRtl(){return this.$store.state.book.rightToLeft},pagerState(){return this.$store.getters["pager/state"]},singleMode(){return this.pagerState.singleMode},slideMode:function(){return this.pagerState.slideMode},mode:function(){return this.pagerState.mode},contentCrop(){return this.slideMode&&this.$store.state.book.contentCrop},thumbSizes(){return this.getThumbSizes(!1)},thumbDoubleSizes(){return this.getThumbSizes(!0)},hasPages(){return this.$store.getters["pages/pagesCount"]>0},numerationOffset(){return this.$store.state.book.numerationOffset},lowercaseRomans(){return this.$store.state.workspace.lowercaseRomans}}}},3760:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var s=i(6382),o=i.n(s),r=i(8531);const a={props:{itemData:{type:Object,required:!0},depth:{type:[Number,String],default:0}},computed:{width:function(){return this.depth<=2?214-20*this.depth:154},pageLabel:function(){return this.$store.getters["pages/pageCaptionByIndex"](this.itemData.page-1)},showPageLabels:function(){return this.$store.state.toc.showPageLabels},itemTitle:function(){return"<span>"+(0,r.jJ)((0,r.m9)(this.itemData.title)).replace(/\n/g,"</span><span>")+"</span>"},textDirection:function(){return o().getDirection(this.itemData.title)},isLocaleRtl(){return this.$store.getters["i18n/isLocaleRtl"]}},methods:{toggleOpen:function(t){this.$store.dispatch("toc/toggleState",this.itemData)},refresh:function(){this.$parent.refresh()}},updated:function(){this.$parent.refresh()},mounted:function(){this.$parent.refresh()}}},8002:(t,e,i)=>{"use strict";i.d(e,{Z:()=>s});const s={computed:{tocItems:function(){return this.$store.state.toc.enabled?this.$store.state.toc.children:[]},level2Items:function(){if(this.$store.state.toc.children)for(let t=0,e=this.$store.state.toc.children.length;t<e;t++)if(this.$store.state.toc.children[t].children)return!0;return!1}},methods:{updateHeight:function(){this.$children[0].refresh()}}}},562:(t,e,i)=>{"use strict";let s;i.d(e,{Z:()=>o});const o={computed:{isPagerMoveWatcherActive(){return this.$store.state.pager.isMoveWatcherActive},isMobile(){return this.$store.getters["workspace/isMobile"]},animationType(){return this.$store.state.workspace.animationType},pagerState:function(){return this.$store.getters["pager/state"]}},watch:{pagerState(t){if(s&&t.zoomMode)return this.$store.dispatch("pager/setMoveWatcher",!1),void(s=!1);const e=this.isMobile?["thumbnails","toc"]:[];this.isPagerMoveWatcherActive&&-1!==e.indexOf(t.target)&&(s=!0,this.$nextTick((()=>{this.$root.$emit("bottomMenu:zoomIn")})))},animationType(t,e){this.isPagerMoveWatcherActive&&!t&&"pagerMove"===e&&(s=!0,this.$nextTick((()=>{this.$root.$emit("bottomMenu:zoomIn"),"history"===this.$store.state.pager.lastTarget&&(this.$store.dispatch("pager/setMoveWatcher",!1),s=!1)})))}}}},1083:(t,e,i)=>{i(4147).register({accessibility:{width:36,height:36,viewBox:"0 0 24 24",data:'<path pid="0" d="M20.5 6c-2.61.7-5.67 1-8.5 1s-5.89-.3-8.5-1L3 8c1.86.5 4 .83 6 1v13h2v-6h2v6h2V9c2-.17 4.14-.5 6-1l-.5-2zM12 6c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z"/>'}})},8856:(t,e,i)=>{i(4147).register({"add-note":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M3 3v13h6l3 5 3-5h6V3H3zm5 6h3V6h2v3h3v2h-3v3h-2v-3H8V9z"/>'}})},607:(t,e,i)=>{i(4147).register({"arrow-down":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M12 16.772c.31 0 .62-.124.836-.341l7.597-7.132c.496-.465.527-1.24.062-1.767-.465-.496-1.24-.527-1.767-.062l-6.729 6.356-6.76-6.325c-.495-.465-1.27-.434-1.767.062-.465.496-.434 1.271.062 1.767l7.597 7.132c.248.186.558.31.868.31z"/>'}})},464:(t,e,i)=>{i(4147).register({"book-first":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M10.468 10.61a2.005 2.005 0 000 2.838l6.262 6.258a1 1 0 00.71.294 1 1 0 00.71-.294 1 1 0 000-1.42l-6.263-6.258 6.319-6.315a1.005 1.005 0 00-1.42-1.42l-6.318 6.316zM6 5.98v12.04c0 .556.45 1.004 1.004 1.004.556 0 1.005-.448 1.005-1.004V5.98c0-.555-.449-1.004-1.005-1.004C6.45 4.976 6 5.425 6 5.98z"/>'}})},925:(t,e,i)=>{i(4147).register({"book-last":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M8.22 4.303A1.003 1.003 0 106.8 5.721l6.313 6.307-6.256 6.252a1 1 0 00.71 1.711 1 1 0 00.709-.294l6.255-6.251a2.004 2.004 0 000-2.836L8.22 4.303zm9.77.68c-.555 0-1.003.45-1.003 1.003v12.028a1.002 1.002 0 102.006 0V5.986c0-.553-.449-1.003-1.003-1.003z"/>'}})},9036:(t,e,i)=>{i(4147).register({"book-next":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M8.872 22.991a1.799 1.799 0 01-1.272-3.07l7.884-7.885-7.956-7.957a1.798 1.798 0 112.543-2.543l8.592 8.593c.509.508.789 1.186.789 1.908 0 .721-.28 1.4-.789 1.907l-8.52 8.52a1.79 1.79 0 01-1.271.527z"/>'}})},6965:(t,e,i)=>{i(4147).register({"book-prev":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M14.312 22.461l-8.519-8.52a2.676 2.676 0 01-.788-1.905c0-.721.28-1.4.788-1.908l8.59-8.592a1.8 1.8 0 012.543 2.543l-7.954 7.956 7.882 7.882a1.8 1.8 0 01-2.542 2.544z"/>'}})},2731:(t,e,i)=>{i(4147).register({cancel:{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M3 4.414L10.586 12 3 19.586 4.414 21 12 13.414 19.586 21 21 19.586 13.414 12 21 4.414 19.586 3 12 10.586 4.414 3z"/>'}})},3374:(t,e,i)=>{i(4147).register({"chevron-right":{width:24,height:24,viewBox:"0 0 24 24",data:'<path pid="0" fill-rule="evenodd" clip-rule="evenodd" d="M9.663 6.033a1 1 0 011.414 0l5.26 5.26a1 1 0 010 1.414l-5.26 5.26a1 1 0 01-1.414-1.414L14.216 12 9.663 7.447a1 1 0 010-1.414z" _fill="#354353"/>'}})},1691:(t,e,i)=>{i(4147).register({cross:{width:24,height:24,viewBox:"0 0 24 24",data:'<path pid="0" fill-rule="evenodd" clip-rule="evenodd" d="M16.707 7.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414-1.414l8-8a1 1 0 011.414 0z" _fill="#354353"/><path pid="1" fill-rule="evenodd" clip-rule="evenodd" d="M7.293 7.293a1 1 0 011.414 0l8 8a1 1 0 01-1.414 1.414l-8-8a1 1 0 010-1.414z" _fill="#354353"/>'}})},5274:(t,e,i)=>{i(4147).register({"down-arrow":{width:16,height:16,viewBox:"0 0 16 16",data:'<path pid="0" d="M13.998 5.003H2.009l5.983 5.99 6.006-5.99"/>'}})},2209:(t,e,i)=>{i(4147).register({drag:{width:16,height:16,viewBox:"0 0 100 100",data:'<path pid="0" d="M24.6 63.2c1.4 1.5 3.8 1.6 5.3.2s1.6-3.8.2-5.3l-.2-.2-4.2-4.2h21v21l-4.2-4.2c-1.4-1.5-3.8-1.6-5.3-.2-1.5 1.4-1.6 3.8-.2 5.3l.2.2 10.6 10.6c1.5 1.5 3.8 1.5 5.3 0l10.5-10.6c1.5-1.4 1.6-3.8.2-5.3-1.4-1.5-3.8-1.6-5.3-.2l-.2.2-4.2 4.2v-21h21L71 57.9c-1.5 1.4-1.6 3.8-.2 5.3 1.4 1.5 3.8 1.6 5.3.2l.2-.2 10.6-10.6c1.5-1.5 1.5-3.8 0-5.3L76.2 36.7c-1.4-1.5-3.8-1.6-5.3-.2-1.5 1.4-1.6 3.8-.2 5.3l.2.2 4.2 4.2h-21v-21l4.2 4.2c1.4 1.5 3.8 1.6 5.3.2s1.6-3.8.2-5.3l-.2-.2-10.5-10.5c-1.5-1.5-3.8-1.5-5.3 0L37.2 24.2c-1.5 1.4-1.6 3.8-.2 5.3 1.4 1.5 3.8 1.6 5.3.2l.2-.2 4.2-4.2v21h-21l4.2-4.2c1.5-1.4 1.6-3.8.2-5.3-1.4-1.5-3.8-1.6-5.3-.2l-.2.2L14 47.3c-1.5 1.5-1.5 3.8 0 5.3l10.6 10.6z"/>'}})},9074:(t,e,i)=>{i(4147).register({equalizer:{width:100,height:100,viewBox:"0 0 100 100",data:'<path pid="0" d="M76.667 23.333V20a3.344 3.344 0 00-3.334-3.333H60A3.344 3.344 0 0056.667 20v3.333H10V30h46.667v3.333c0 1.833 1.5 3.333 3.333 3.333h13.333c1.833 0 3.334-1.5 3.334-3.333V30H90v-6.667H76.667zM70 30h-6.667v-6.667H70V30zM43.333 46.667v-3.333C43.333 41.5 41.833 40 40 40H26.667a3.344 3.344 0 00-3.334 3.333v3.333H10v6.667h13.333v3.332a3.344 3.344 0 003.334 3.334H40c1.833 0 3.333-1.5 3.333-3.334v-3.332H90v-6.667H43.333zm-6.666 6.667H30v-6.667h6.667v6.667zM70 70v-3.334a3.343 3.343 0 00-3.333-3.332H53.333A3.343 3.343 0 0050 66.666V70H10v6.666h40V80a3.345 3.345 0 003.333 3.334h13.334A3.345 3.345 0 0070 80v-3.334h20V70H70zm-6.667 6.666h-6.666V70h6.666v6.666z"/>'}})},5903:(t,e,i)=>{i(4147).register({fullscreen:{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M6.733 5.1l2.1-2.1H3v5.833l2.1-2.1 2.8 2.8A1.167 1.167 0 109.533 7.9l-2.8-2.8zM18.9 17.328l-2.8-2.869a1.18 1.18 0 00-1.633-.23 1.135 1.135 0 000 1.837l2.916 2.754L15.167 21H21v-5.738l-2.1 2.066zm-3.014-7.664l2.854-2.806L21 8.845V3h-5.947l2.141 2.104L14.34 7.91a1.155 1.155 0 000 1.637.96.96 0 001.546.117zm-7.857 4.673L5.222 17.26 3 15.156v5.847h5.847l-2.105-2.105 2.924-2.807a1.17 1.17 0 000-1.637 1.052 1.052 0 00-1.637-.117z"/>'}})},5843:(t,e,i)=>{i(4147).register({"mobile-left":{width:16,height:16,viewBox:"0 0 24 40",data:'<path pid="0" d="M19.172 38L2.583 21.414a2.006 2.006 0 010-2.828L19.168 2l2.828 2.828L6.826 20 22 35.172 19.172 38z"/>'}})},9117:(t,e,i)=>{i(4147).register({"mobile-right":{width:16,height:16,viewBox:"0 0 24 40",data:'<path pid="0" d="M4.828 2l16.589 16.586c.777.778.777 2.05 0 2.828L4.832 38l-2.828-2.828L17.174 20 2 4.828 4.828 2z"/>'}})},2150:(t,e,i)=>{i(4147).register({"note-content":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M5.6 7.673c-.96 0-1.6-.534-1.6-1.335 0-.8.64-1.334 1.6-1.334h12.8c.96 0 1.6.534 1.6 1.334 0 .801-.64 1.335-1.6 1.335H5.6zm7.543 6.673h-7.62C4.61 14.346 4 13.812 4 13.012c0-.801.61-1.335 1.524-1.335h7.619c.914 0 1.524.534 1.524 1.335 0 .8-.61 1.334-1.524 1.334zM0 2v15.902h7.5L12 24l4.5-6.098H24V2H0z"/>'}})},6722:(t,e,i)=>{i(4147).register({"open-link":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M4 5.5C4 4.75 4.75 4 5.5 4H12v2H7c-.42 0-1 .583-1 1.005V17c0 .422.58 1 1 1h10c.42 0 1-.578 1-1v-5h2v6.5c0 .75-.75 1.5-1.5 1.5h-13c-.75 0-1.5-.75-1.5-1.75V5.5zM13.715 3H21l-.002 7.428L18.33 7.74 13.11 13 11 10.874l5.264-5.305L13.715 3z"/>'}})},5958:(t,e,i)=>{i(4147).register({"rounded-close":{width:16,height:16,viewBox:"0 0 16 16",data:'<path pid="0" d="M8.003 1.007A6.996 6.996 0 1015 8.003a6.988 6.988 0 00-6.98-6.996h-.016zm2.881 8.89a.312.312 0 010 .493l-.494.494a.312.312 0 01-.494 0L8.003 8.991 6.11 10.884a.312.312 0 01-.494 0l-.493-.494a.312.312 0 010-.494l1.893-1.893L5.123 6.11a.304.304 0 010-.494l.493-.493a.304.304 0 01.494 0l1.893 1.893 1.893-1.893a.312.312 0 01.494 0l.494.493a.312.312 0 010 .494L8.991 8.003l1.893 1.893z"/>'}})},6010:(t,e,i)=>{i(4147).register({search:{width:24,height:24,viewBox:"0 0 24 24",data:'<path pid="0" d="M15.49 17.61A8.144 8.144 0 0111.14 19c-4.452-.102-8.038-3.625-8.14-8 .036-4.35 3.575-7.89 8-8 4.425.112 7.965 3.65 8 8a7.813 7.813 0 01-1.38 4.499l4.451 4.45-2.121 2.122-4.46-4.46zM11.104 17c3.3-.09 5.919-2.757 5.895-6-.026-3.263-2.681-5.916-6-6-3.319.083-5.973 2.737-6 6 .077 3.281 2.766 5.923 6.105 6z"/>'}})},169:(t,e,i)=>{i(4147).register({text:{width:16,height:16,viewBox:"0 0 30 30",data:'<g fill-rule="evenodd"><path pid="0" fill-rule="nonzero" d="M25.642 16.116a1.647 1.647 0 00-.267-.716c-.208-.287-.532-.43-.97-.43-.625 0-1.053.31-1.283.931-.121.33-.182.768-.182 1.315 0 .521.06.94.182 1.257.222.59.638.885 1.25.885.434 0 .743-.117.925-.351.182-.235.293-.539.332-.912h1.894c-.043.564-.247 1.098-.612 1.602-.581.811-1.443 1.217-2.584 1.217-1.142 0-1.982-.338-2.52-1.016-.538-.677-.807-1.556-.807-2.636 0-1.22.297-2.168.892-2.845s1.415-1.016 2.46-1.016c.89 0 1.619.2 2.185.599.567.4.902 1.105 1.006 2.116h-1.901z"/><path pid="1" d="M3 8h16v15H3V8zm12.9 5.414c-.517 0-.942.109-1.276.326-.282.173-.54.425-.775.755v-3.412H12v9.584h1.816v-.892c.248.347.478.59.69.729.356.234.827.351 1.413.351.933 0 1.66-.362 2.181-1.087.521-.725.782-1.638.782-2.74 0-1.064-.264-1.932-.792-2.605-.527-.673-1.257-1.009-2.19-1.009zm-.476 5.912c-.55 0-.96-.2-1.23-.6-.27-.399-.404-.902-.404-1.51 0-.516.065-.937.196-1.263.251-.612.714-.918 1.386-.918.664 0 1.12.313 1.368.938.13.33.195.746.195 1.25 0 .629-.132 1.137-.397 1.523-.265.386-.636.58-1.114.58zm-7.03-2.11v.69c-.012.62-.187 1.048-.524 1.283a1.89 1.89 0 01-1.103.351.992.992 0 01-.641-.211c-.176-.141-.264-.37-.264-.687 0-.356.143-.619.43-.788.169-.1.449-.184.84-.254l.416-.078c.209-.039.372-.081.492-.127.12-.045.237-.105.355-.179zm-1.126-.866l-.631.078c-.716.092-1.259.243-1.628.456C4.336 17.274 4 17.906 4 18.78c0 .672.21 1.192.628 1.559.42.367.95.55 1.592.55.504 0 .955-.115 1.354-.345.334-.195.63-.432.886-.71.013.16.03.304.052.43.021.126.06.26.117.404h2.018v-.274a.665.665 0 01-.273-.215c-.061-.086-.098-.251-.111-.494a31.08 31.08 0 01-.013-.82v-3.256c0-.855-.302-1.437-.905-1.745-.603-.308-1.293-.462-2.07-.462-1.194 0-2.036.313-2.526.938-.308.399-.482.909-.521 1.53h1.79c.044-.274.13-.491.26-.652.183-.217.493-.325.932-.325.39 0 .686.055.888.166.202.11.303.311.303.602 0 .239-.132.415-.397.527-.148.066-.393.12-.736.163zM19 5h1v21h-1zM17 4h5v1h-5zM17 26h5v1h-5z"/></g>'}})},5606:(t,e,i)=>{i(4147).register({thumbnails:{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M9 3c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1H4c-.6 0-1-.4-1-1V4c0-.6.4-1 1-1h5zm11 0c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1h-5c-.6 0-1-.4-1-1V4c0-.6.4-1 1-1h5zM9 14c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1H4c-.6 0-1-.4-1-1v-5c0-.6.4-1 1-1h5zm11 0c.6 0 1 .4 1 1v5c0 .6-.4 1-1 1h-5c-.6 0-1-.4-1-1v-5c0-.6.4-1 1-1h5z"/>'}})},6062:(t,e,i)=>{i(4147).register({"trash-can":{width:16,height:16,viewBox:"0 0 24 24",data:'<path pid="0" d="M15.976 17.862c0 .607-.414 1.138-.885 1.138H8.893c-.47 0-.869-.513-.869-1.12L8.002 8H16l-.023 9.862zM20 6h-5V4.466C15 3.66 14.853 3 14.013 3h-3.858C9.315 3 9 3.659 9 4.466V6H4v2h2v10c0 1.843 1.153 3 2.893 3h6.198C16.84 21 18 19.852 18 18V8h2V6z"/><path pid="1" d="M13 18h1V9h-1zM10 18h1V9h-1z"/>'}})},6177:(t,e,i)=>{i(4147).register({error:{width:16,height:16,viewBox:"0 0 128 128",data:'<path pid="0" d="M64 23.9a39.47 39.47 0 11-39.47 39.47A39.52 39.52 0 0164 23.9m0-10a49.47 49.47 0 1049.47 49.47A49.47 49.47 0 0064 13.9z"/><path pid="1" d="M30.207 90.732l60.507-60.508 7.071 7.072-60.507 60.507z"/>'}})},5284:(t,e,i)=>{i(4147).register({"made-with":{width:119,height:30,viewBox:"0 0 119 30",data:'<path pid="0" d="M27.102 26.063c0 .29-.233.525-.525.525h-1.052a.525.525 0 01-.525-.525V15.052c0-.355.3-.526.497-.526h6.337c.29 0 .524.232.524.524v1.05c0 .289-.237.524-.524.524H27.21a.105.105 0 00-.108.102v2.68c0 .056.047.102.105.102h3.836c.29 0 .527.233.527.524v1.05c0 .29-.234.524-.527.524h-3.836a.105.105 0 00-.105.106v4.35zm8.672-11.538A.525.525 0 0035.25 14l-1.052.13c-.396.05-.525.236-.525.525 0 0-.006 9.801 0 9.833-.006 1.37 1.127 2.104 2.102 2.099.976-.006.528.005.528.005a.53.53 0 00.523-.529V24.89c0-.23-.187-.4-.387-.4h-.27a.384.384 0 01-.394-.374v-9.59zm3.416 2.885h1.053c.29 0 .524.183.524.526v8.126c0 .29-.233.526-.524.526H39.19a.526.526 0 01-.525-.526v-8.126c0-.29.14-.526.525-.526zm-.525-2.36a1.051 1.051 0 012.102 0 1.05 1.05 0 01-2.102 0zm4.207 5.198a25.36 25.36 0 01-.002-.32v.364a3.148 3.148 0 013.154-3.144h.788a3.151 3.151 0 013.153 3.146v3.41a3.149 3.149 0 01-3.155 3.146h-.26a3.49 3.49 0 01-1.578-.387v2.484c0 .29-.233.525-.525.525h-1.052a.525.525 0 01-.525-.525v-8.652c0-.016 0-.031.002-.047zm2.1.044v3.414c0 .72.589 1.308 1.314 1.308h.263c.725 0 1.314-.585 1.314-1.308v-3.414c0-.72-.589-1.309-1.314-1.309h-.263c-.725 0-1.314.586-1.314 1.309zm6.835-.044a25.36 25.36 0 01-.002-.32v.364a3.148 3.148 0 013.153-3.144h.789a3.152 3.152 0 013.154 3.146v3.41a3.149 3.149 0 01-3.156 3.146h-.26c-.552 0-1.091-.14-1.578-.387v2.484c0 .29-.233.525-.525.525H52.33a.525.525 0 01-.525-.525v-8.652c0-.016 0-.031.002-.047zm2.1.044v3.414c0 .72.589 1.308 1.315 1.308h.262c.725 0 1.314-.585 1.314-1.308v-3.414c0-.72-.588-1.309-1.314-1.309h-.262c-.726 0-1.315.586-1.315 1.309zm7.358-2.882h1.052c.29 0 .525.183.525.526v8.126c0 .29-.233.526-.525.526h-1.052a.526.526 0 01-.525-.526v-8.126c0-.29.165-.526.525-.526zm-.525-2.36a1.051 1.051 0 012.102 0 1.05 1.05 0 01-2.102 0zm4.73 11.538h1.052a.523.523 0 00.525-.526v-5.767c0-.725.588-1.312 1.315-1.312h.262c.725 0 1.314.588 1.314 1.31v5.779a.52.52 0 00.524.523l1.053-.005a.526.526 0 00.525-.526v-5.77a3.15 3.15 0 00-3.153-3.146h-.789c-.488 0-.95.11-1.362.307a.52.52 0 00-.214-.045H65.47a.524.524 0 00-.525.526v8.126a.524.524 0 00.525.526zm15.773-6.581c0 .286-.01.524-.02.858.002.63.016 2.596.009 4.742-.008 2.552-1.31 4.136-3.668 4.128h-.265c-1.79.013-2.91-1.157-2.91-1.157a.414.414 0 01.016-.577l.72-.79c.156-.14.288-.1.412 0 .123.098.733.843 2.027.816.764-.015 1.59-.482 1.59-1.567-.519.287-.995.393-1.595.393h-.26a3.149 3.149 0 01-3.155-3.147v-3.41a3.151 3.151 0 013.153-3.146h.789a3.148 3.148 0 013.153 3.144l.004-.287zm-2.106.287c0-.723-.588-1.309-1.314-1.309h-.262c-.726 0-1.314.59-1.314 1.31v3.413c0 .723.588 1.309 1.314 1.309h.262c.726 0 1.314-.59 1.314-1.309v-3.414zm9.458 6.294H84.13a.525.525 0 01-.526-.527v-11.01c0-.29.233-.526.526-.526h4.337a3.15 3.15 0 013.153 3.147 3.141 3.141 0 01-1.312 2.556 3.405 3.405 0 011.706 2.951 3.413 3.413 0 01-3.418 3.409zm-.262-4.982h-2.52a.103.103 0 00-.107.102v2.68c0 .057.047.102.106.102h2.521c.797 0 1.446-.646 1.446-1.442 0-.795-.647-1.442-1.446-1.442zm-.394-5.245h-2.125a.105.105 0 00-.108.105v2.937c0 .06.048.105.108.105h2.125c.871 0 1.577-.705 1.577-1.574 0-.867-.706-1.573-1.577-1.573zm5.65 3.933a3.149 3.149 0 013.154-3.146h.789a3.151 3.151 0 013.153 3.146v3.41a3.15 3.15 0 01-3.153 3.146h-.789a3.151 3.151 0 01-3.153-3.147v-3.409zm2.103-.002v3.414c0 .72.589 1.308 1.314 1.308h.263c.726 0 1.314-.585 1.314-1.308v-3.414c0-.72-.588-1.309-1.314-1.309h-.263c-.725 0-1.314.586-1.314 1.309zm6.307.002a3.15 3.15 0 013.154-3.146h.788a3.151 3.151 0 013.154 3.146v3.41a3.15 3.15 0 01-3.154 3.146h-.788a3.151 3.151 0 01-3.154-3.147v-3.409zm2.077-.002v3.414c0 .72.588 1.308 1.314 1.308h.262c.726 0 1.314-.585 1.314-1.308v-3.414c0-.72-.588-1.309-1.314-1.309h-.262c-.726 0-1.314.586-1.314 1.309zm11.949 5.975c.094.113.286.323.43.323h1.841c.25 0 .31-.286.215-.41l-3.785-4.566c1.911-1.227 2.738-3.59 2.773-3.804.035-.213-.044-.387-.331-.387h-1.359c-.378 0-.392.296-.514.507-.122.212-.569 1.807-2.517 2.726V14.79a.525.525 0 00-.526-.525H111.2c-.349 0-.526.261-.526.525v11.277c0 .29.236.524.526.524h1.052a.523.523 0 00.525-.524V22.4l3.247 3.867zM.009 27.961A1.163 1.163 0 010 27.813V14.145c0-.1.014-.199.038-.291.189-1.038 1.075-1.826 2.144-1.833.332-.001.648.072.932.206l5.899 3.126-.004-.001c.02-.013.156-.104.208-.133l5.67-3.013c.282-.134.599-.208.931-.206 1.138.008 2.07.902 2.173 2.038.006.05.009.098.009.148v13.669c0 .1-.013.199-.038.292-.189 1.037-1.075 1.825-2.144 1.832a2.144 2.144 0 01-.932-.206L8.991 26.65c-.02.012-.156.103-.208.132l-5.67 3.013c-.283.134-.599.208-.931.206-1.138-.008-2.07-.902-2.173-2.038zm2.635-.556l5.242-2.712a1.746 1.746 0 00.58-2.37l-.001.001.004-.003-.771-1.353a3.96 3.96 0 01-.65-2.057c-.02-.66.122-1.287.39-1.845l.008.005-4.803-2.455a.468.468 0 00-.642.43v1.47H2V26.976a.466.466 0 00.644.43zm13.354-.451v-1.47H16V15.026a.466.466 0 00-.643-.43l-5.243 2.712a1.746 1.746 0 00-.579 2.37l.001-.001-.005.002.771 1.354c.39.593.626 1.297.65 2.056.02.66-.122 1.288-.39 1.845l4.795 2.45a.467.467 0 00.643-.431z"/><path pid="1" class="made-with" fill-rule="evenodd" d="M13.102 2.543c.73 0 1.303.183 1.717.548.414.365.629.868.645 1.509v2.918c0 .582.074 1.045.222 1.388V9H14.55c-.063-.125-.114-.348-.153-.668-.504.524-1.105.785-1.805.785-.625 0-1.137-.177-1.538-.53-.4-.354-.6-.802-.6-1.345 0-.66.25-1.173.753-1.538.502-.365 1.208-.548 2.118-.548h1.055v-.498c0-.379-.114-.68-.34-.905-.227-.225-.56-.337-1.002-.337-.387 0-.711.098-.973.293-.262.195-.392.432-.392.709h-1.09c0-.316.112-.622.337-.917a2.3 2.3 0 01.914-.7 3.075 3.075 0 011.268-.258zM22.361 0v9h-.996l-.053-.68c-.433.532-1.037.797-1.81.797-.735 0-1.333-.3-1.796-.902-.463-.602-.695-1.387-.695-2.356v-.082c0-.972.23-1.755.692-2.346.46-.592 1.064-.888 1.81-.888.743 0 1.33.254 1.764.762V0h1.084zm4.29 2.543c.824 0 1.465.271 1.922.814.457.543.685 1.32.685 2.332v.452h-4.294c.015.625.198 1.13.547 1.514.35.385.794.577 1.333.577.383 0 .707-.078.973-.234.266-.156.498-.363.697-.621l.662.516c-.53.816-1.328 1.224-2.39 1.224-.86 0-1.559-.282-2.098-.846-.539-.565-.808-1.32-.808-2.265v-.2c0-.628.12-1.19.36-1.684s.576-.88 1.008-1.16c.431-.28.9-.419 1.403-.419zm20.682-1.418V2.66h1.183v.838h-1.183V7.43c0 .254.052.444.158.571.105.127.285.19.539.19.125 0 .297-.023.516-.07V9a3.143 3.143 0 01-.833.117c-.484 0-.85-.146-1.095-.44-.246-.292-.37-.708-.37-1.247V3.498h-1.154V2.66h1.155V1.125h1.084zM6.768 2.543c1.39 0 2.097.736 2.12 2.209V9H7.806V4.816c0-.453-.104-.792-.31-1.016-.208-.225-.555-.337-1.044-.337-.402 0-.736.12-1.002.36-.265.24-.42.564-.463.97V9h-1.09V4.846c0-.922-.45-1.383-1.353-1.383-.71 0-1.197.303-1.459.908V9H0V2.66h1.026l.029.703c.465-.547 1.092-.82 1.88-.82.887 0 1.49.34 1.811 1.02.211-.305.486-.551.823-.739.338-.187.738-.281 1.199-.281zm27.45.117l1.248 4.746 1.476-4.746h.873l1.506 4.846L40.54 2.66h1.084L39.778 9H38.9l-1.54-4.805L35.858 9h-.88l-1.84-6.34h1.079zm9.797 0V9h-1.084V2.66h1.084zM50.978 0v3.428c.48-.59 1.106-.885 1.875-.885 1.34 0 2.016.756 2.027 2.268V9h-1.084V4.805c-.004-.457-.108-.795-.313-1.014-.205-.219-.525-.328-.958-.328-.352 0-.66.094-.926.281a1.91 1.91 0 00-.621.738V9h-1.084V0h1.084zM19.783 3.463c-.531 0-.945.205-1.242.615-.297.41-.445 1.018-.445 1.822 0 .72.148 1.282.445 1.688.297.406.707.61 1.23.61.688 0 1.19-.31 1.506-.926V4.359c-.324-.597-.822-.896-1.494-.896zm-5.403 2.46h-.85c-1.328 0-1.992.39-1.992 1.167 0 .34.113.605.34.797.226.191.517.287.873.287.34 0 .662-.088.967-.264.304-.176.525-.404.662-.685V5.924zm12.271-2.49c-.437 0-.805.16-1.102.478-.296.319-.48.765-.55 1.34h3.175v-.083c-.03-.55-.18-.978-.445-1.28-.265-.303-.625-.454-1.078-.454zM43.482.353c.211 0 .371.06.48.181a.64.64 0 01.165.446.62.62 0 01-.164.439c-.11.117-.27.176-.48.176-.212 0-.371-.059-.478-.176a.626.626 0 01-.162-.44c0-.175.054-.324.162-.445.107-.12.266-.181.477-.181z"/>'}})},1619:(t,e,i)=>{i(4147).register({"page-wide":{width:500,height:370,viewBox:"0 0 500 370",data:'<g clip-path="url(#clip0_3_2)" _fill="#000"><path pid="0" d="M0 17h230V0H0v17zM0 51h230V34H0v17zM0 85h115V68H0v17zM270 302h230v-17H270v17zM270 336h230v-17H270v17zM270 370h115v-17H270v17zM270 187h230v-17H270v17zM270 221h230v-17H270v17zM270 255h115v-17H270v17zM0 136h230v-17H0v17zM0 170h230v-17H0v17zM0 204h115v-17H0v17zM270 140h230V0H270v140zM0 370h230V230H0v140z"/></g><defs><clipPath id="clip0_3_2"><path pid="1" _fill="#fff" d="M0 0h500v370H0z"/></clipPath></defs>'}})},9719:(t,e,i)=>{i(4147).register({page:{width:250,height:370,viewBox:"0 0 250 370",data:'<path pid="0" d="M0 17h250V0H0v17zM0 51h250V34H0v17zM0 85h125V68H0v17zM0 302h250v-17H0v17zM0 336h250v-17H0v17zM0 370h125v-17H0v17zM0 255h250V115H0v140z" _fill="#000"/>'}})},148:(t,e,i)=>{i(4147).register({replay:{width:16,height:16,viewBox:"0 0 70 70",data:'<use xlink:href="#a" transform="rotate(60 21.655 37.507)"/><defs><path pid="0" id="a" d="M5.885 12.428L1.49 9.97c-.777-.435-1.693.287-1.45 1.144L4.006 25.15a1 1 0 001.235.69l14.036-3.966c.857-.242.993-1.4.216-1.835l-4.878-2.729c4.194-7.024 13.267-9.4 20.377-5.296 7.174 4.142 9.632 13.316 5.49 20.49-4.142 7.175-13.316 9.633-20.49 5.49l-5 8.66c11.957 6.904 27.247 2.807 34.15-9.15 6.904-11.957 2.807-27.247-9.15-34.15C28.06-3.536 12.81.529 5.885 12.428z"/></defs>'}})},2358:(t,e,i)=>{"use strict";function s(t){let{filenameOrUrl:e,relativePath:i="assets/pages/content/",encode:s=!1}=t;return/^(?:https?|medialib):\/\//.test(e)?e:i+(s?encodeURIComponent(e):e)}i.d(e,{n:()=>s})},2567:(t,e,i)=>{"use strict";i.d(e,{Z:()=>r});var s=i(320);const o={cTest:!1,id:function(t){return document.getElementById(t)},tag:function(t){return document.getElementsByTagName(t)[0]},tags:function(t){return document.getElementsByTagName(t)},byClass:function(t){return document.getElementsByClassName(t)},add:function(t){return document.createElement(t)},round:function(t,e){e=e||0;let i=1;for(let s=0;s<e;s++)i*=10;return Math.round(t*i)/i},css:function(t,e){for(const i in e)if(e.hasOwnProperty(i)){let s=i.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}));s="float"===s?"cssFloat":s,t.style[s]=e[i]}},del:function(t){return(0,s.HD)(t)?o.id(t)&&o.id(t).parentNode.removeChild(o.id(t)):t.parentNode.removeChild(t),!0},addClass:function(t,e){t.classList.add(e)},removeClass:function(t,e){t.classList.remove(e)},createElement:function(t,e,i,o,r){i=i||-1;const a=document.createElement(t);for(const s in e)e.hasOwnProperty(s)&&("styles"!==s?a.setAttribute(s,e[s]):this.css(a,e.styles));if("top"===o)-1!==i&&((0,s.HD)(i)?document.getElementById(i).insertBefore(a,document.getElementById(i).firstChild):i.insertBefore(a,i.firstChild));else if("after"===o){const t=r.nextSibling,e=r.parentNode;t?e.insertBefore(a,t):e.appendChild(a)}else if("before"===o){const t=r.previousSibling,e=r.parentNode;t?e.insertBefore(a,r):e.appendChild(a)}else-1!==i&&((0,s.HD)(i)?document.getElementById(i).appendChild(a):i.appendChild(a));return a},clear:function(t){(0,s.HD)(t)&&(t=t.id(t)),t.innerHTML=""}},r=o},1909:(t,e,i)=>{"use strict";function s(t){const e=/(?:(?:https?:)?\/\/)?(?:[^.]+\.)?(\w+)(\.|\-)/.exec(t);return e?e[1]:null}function o(t){const e=t.split("/");return e[e.length-1]}i.d(e,{V:()=>s,c:()=>o})},5657:(t,e,i)=>{"use strict";i.d(e,{F:()=>o,q:()=>s});const s=function(t){const e=t.format?"."+t.format:"";return t.name+e},o=function(t){let{data:e,maxSize:i}=t;window.devicePixelRatio>=1.5&&(i*=1.5);const s=e.sizes.reduce(((t,e)=>t<i?e>t?e:t:e>=i&&e<t?e:t));let o=e.name.split("{size}");o=o.map((t=>encodeURIComponent(t)));return{name:o.join("{size}"),size:s,format:e.format}}},1443:(t,e,i)=>{"use strict";function s(t,e){let{target:i}=e;const s=t.state.book.rightToLeft;t.dispatch(s?"pager/goForward":"pager/goBackward",{target:i})}function o(t,e){let{target:i}=e;const s=t.state.book.rightToLeft;t.dispatch(s?"pager/goBackward":"pager/goForward",{target:i})}function r(t,e){let{target:i=null,navTarget:s=!1}=e;const o=t.state.book.rightToLeft,r=s?o?"nav-last":"nav-first":i;t.dispatch(o?"pager/goToLast":"pager/goToFirst",{target:r})}function a(t,e){let{target:i=null,navTarget:s=!1}=e;const o=t.state.book.rightToLeft,r=s?o?"nav-first":"nav-last":i;t.dispatch(o?"pager/goToFirst":"pager/goToLast",{target:r})}i.d(e,{X0:()=>o,oJ:()=>s,tc:()=>r,w9:()=>a})},8384:(t,e,i)=>{"use strict";i.d(e,{Z:()=>ro});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"book-container",class:t.containerClass},[t.hasPages?i(t.bookComponent,{ref:"bookComponent",tag:"component",attrs:{"container-size":t.containerSize,"page-size":t.bookSize,dir:"ltr"}}):t._e(),t._v(" "),!t.isMobile&&t.showPrevSubstrate?i("div",{staticClass:"book-substrate-prev",style:t.substrateStyle,attrs:{"aria-hidden":"true"},on:{click:t.goToLeftPage,mouseover:function(e){return t.arrowHover("prev",!0)},mouseout:function(e){return t.arrowHover("prev",!1)}}}):t._e(),t._v(" "),!t.isMobile&&t.showNextSubstrate?i("div",{staticClass:"book-substrate-next",style:t.substrateStyle,attrs:{"aria-hidden":"true"},on:{click:t.goToRightPage,mouseover:function(e){return t.arrowHover("next",!0)},mouseout:function(e){return t.arrowHover("next",!1)}}}):t._e(),t._v(" "),i("transition",{attrs:{name:"bars-fade"}},[t.showSimpleArrows?i("nav-buttons",{attrs:{show:!0}}):t._e(),t._v(" "),t.showSmartArrows?i("slide-nav-buttons",{attrs:{show:!0}}):t._e()],1),t._v(" "),i("note-editor"),t._v(" "),"html"===t.version?i("logo",{key:t.logoKey,ref:"logoComponent"}):t._e(),t._v(" "),i("transition",{attrs:{name:"slide-fade"}},["html"===t.version?i("zoom-panel"):t._e()],1),t._v(" "),i("transition",{attrs:{name:t.ctrFade},on:{"after-enter":t.afterFade}},[t.miniState&&!t.miniFullScreen?i("div",{key:"maxi",class:t.clickToReadClass,attrs:{role:"button",tabindex:"0"},on:{click:t.wsToggleFullscreen,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:t.wsToggleFullscreen(e)}}},[t._v("\n            "+t._s(t.clickToReadText)+"\n        ")]):t._e(),t._v(" "),t.miniState&&t.miniFullScreen?i("div",{key:"mini",class:t.miniClickToReadClass,attrs:{title:t.$t("BottomMenu.FULLSCREEN_BUTTON_TIP")},on:{click:t.wsToggleFullscreen}},[i("div",{staticClass:"fullscreen-button-mini-holder"},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"fullscreen"}})],1)]):t._e()])],1)},o=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",t._g({staticClass:"flip-book",class:t.flipBookClass,attrs:{tag:"div"}},t.bookEventHandlers),[i("v-touch",t._g({ref:"bookHolder",staticClass:"book-holder",style:[t.bookHolderStyle],attrs:{tag:"div",id:"book-holder","data-frozen-by":t.frozenBy,"data-zoom-wrapper":""},nativeOn:{transitionend:function(e){return t.transitionEnd(e)}}},t.bookHolderEventHandlers),[t.selectTextEnabled?i("select-text-panel"):t._e(),t._v(" "),i("transition",{attrs:{name:"bars-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showLeftButtons,expression:"showLeftButtons"}],staticClass:"previous-button",on:{mouseover:function(e){return t.arrowHover("prev",!0)},mouseout:function(e){return t.arrowHover("prev",!1)}}},[t.notesEnabled&&!t.showRightAddNote?i("button",{staticClass:"icon-add-note left-add-note stripe-btn",attrs:{tabindex:"0","aria-label":t.addNoteTitleText,title:t.addNoteTitleText,"data-nav-name":"notes-left"},on:{click:function(e){return e.stopPropagation(),t.btnAddNote("left")},mousedown:function(t){t.preventDefault()},mouseover:function(e){return e.stopPropagation(),t.arrowHover("prev",!1)}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"add-note"}})],1):t._e(),t._v(" "),i("button",{staticClass:"icon-book-prev stripe-btn",attrs:{tabindex:"0","aria-label":t.leftArrowTitle,title:t.leftArrowTitle,"data-nav-name":"go-left"},on:{click:function(e){return e.stopPropagation(),t.leftPage(e)},mousedown:function(t){t.preventDefault()}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"book-prev"}})],1),t._v(" "),i("button",{staticClass:"icon-book-first stripe-btn",attrs:{tabindex:"0","aria-label":t.leftMostArrowTitle,title:t.leftMostArrowTitle,"data-nav-name":"go-last-left"},on:{click:function(e){return e.stopPropagation(),t.leftmostPage(e)},mouseover:function(e){return e.stopPropagation(),t.arrowHover("prev",!1)},mousedown:function(t){t.preventDefault()}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"book-first"}})],1)])]),t._v(" "),i("transition",{attrs:{name:"bars-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showRightButtons,expression:"showRightButtons"}],staticClass:"next-button",on:{mouseover:function(e){return t.arrowHover("next",!0)},mouseout:function(e){return t.arrowHover("next",!1)}}},[t.notesEnabled&&t.showRightAddNote?i("button",{staticClass:"icon-add-note right-add-note stripe-btn",attrs:{tabindex:"0","aria-label":t.addNoteTitleText,title:t.addNoteTitleText,"data-nav-name":"notes-right"},on:{click:function(e){return e.stopPropagation(),t.btnAddNote("right")},mouseover:function(e){return e.stopPropagation(),t.arrowHover("next",!1)},mousedown:function(t){t.preventDefault()}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"add-note"}})],1):t._e(),t._v(" "),i("button",{staticClass:"icon-book-next stripe-btn",attrs:{tabindex:"0","aria-label":t.rightArrowTitle,title:t.rightArrowTitle,"data-nav-name":"go-right"},on:{click:function(e){return e.stopPropagation(),t.rightPage(e)},mousedown:function(t){t.preventDefault()}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"book-next"}})],1),t._v(" "),i("button",{staticClass:"icon-book-last stripe-btn",attrs:{tabindex:"0","aria-label":t.rightMostArrowTitle,title:t.rightMostArrowTitle,"data-nav-name":"go-last-right"},on:{click:function(e){return e.stopPropagation(),t.rightmostPage(e)},mouseover:function(e){return e.stopPropagation(),t.arrowHover("next",!1)},mousedown:function(t){t.preventDefault()}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"book-last"}})],1)])]),t._v(" "),i("transition",{attrs:{name:"bars-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showOnlyAddNote,expression:"showOnlyAddNote"}],staticClass:"next-button only-note"},[i("button",{staticClass:"icon-add-note right-add-note stripe-btn",attrs:{tabindex:"0","aria-label":t.addNoteTitleText,title:t.addNoteTitleText,"data-nav-name":"notes-right"},on:{click:function(e){return e.stopPropagation(),t.btnAddNote("right")},mousedown:function(t){t.preventDefault()}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"add-note"}})],1)])])],1)],1)},a=[],n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.className,style:t.pageStyle,attrs:{"data-page-id":t.pageId,"aria-hidden":!t.isCurrent},on:{mousedown:[function(e){return e.preventDefault(),t.onMouseDown(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])||"button"in e&&2!==e.button?null:void e.stopPropagation()}]}},[i("transition",{attrs:{name:"page-fade"}},[t.showPreloaderContainer?i("div",{staticClass:"page-preloader",style:{backgroundColor:t.backgroundColor}},[t.isCurrent||t.isMobileApp?i("div",{staticClass:"preloader-container"},[t.showSpinner?i("spinner",{staticClass:"preloader-spinner",attrs:{size:36,"line-size":3,"line-fg-color":"#5692AE","line-bg-color":"#ffffff"}}):t._e(),t._v(" "),i("div",{staticClass:"preloader-bg"}),t._v(" "),i("div",{staticClass:"preloader-header",attrs:{dir:t.dir}},[t._v(t._s(t.preloaderHeader))]),t._v(" "),i("div",{staticClass:"preloader-text",attrs:{dir:t.dir}},[t._v(t._s(t.preloaderText))])],1):t._e(),t._v(" "),t.showThumbnail?i("div",{staticClass:"preloader-th",style:t.thumbnailStyle},[i("img",{attrs:{crossOrigin:t.crossOrigin,src:t.thumbnailUrl}})]):t._e()]):t._e()]),t._v(" "),i("div",{staticClass:"background",style:t.contentStyle,attrs:{"data-id":t.pageId}},[i("img",{ref:"bgImage",staticClass:"bg-layer",attrs:{crossOrigin:t.crossOrigin,src:"","aria-hidden":"true"}}),t._v(" "),t._l(t.backgroundsCache,(function(e,s){return t.canvasUpdated?t._e():i("img",{key:s,attrs:{"data-img":"backgroundsCache",crossOrigin:t.crossOrigin,src:e,"aria-hidden":"true"},on:{load:function(i){return t.bgCacheImageLoaded(e)}}})})),t._v(" "),t.vectorLayerCache?i("img",{ref:"bgSVG",class:"svg-layer"+(t.isCurrent?"":" svg-layer-not-current"),attrs:{crossOrigin:t.crossOrigin,src:t.vectorLayerCache}}):t._e()],2),t._v(" "),t.showHighlights?i("div",{staticClass:"highlights",style:t.contentStyle},[t._l(t.highlights,(function(t){return[i("div",{style:t.style})]}))],2):t._e(),t._v(" "),i("v-touch",{staticClass:"touch-layer",style:t.contentTouchLayerStyle,attrs:{options:{domEvents:!0}},on:{tap:t.onContentTap}},["flip-book"===t.bookComponent?i("div",{staticClass:"flip-area"}):t._e(),t._v(" "),!t.isMobile&&t.selectTextEnabled?i("select-text",{directives:[{name:"show",rawName:"v-show",value:t.isCurrent&&!t.contentFreezed&&"animating"!==t.bookStatus&&"calculating"!==t.bookStatus,expression:"isCurrent && !contentFreezed &&\n                    bookStatus !== 'animating' && bookStatus !== 'calculating'"}],attrs:{contStyle:t.contentStyle,"page-side":t.pageSide,"is-wide":t.isWide,"page-id":t.pageId,containerSize:t.contentSize,isCurrent:t.isCurrent,isLoaded:!t.isLoadingCache}}):t._e(),t._v(" "),!t.isLoadingCache&&t.isCurrent&&t.selectTextEnabled&&t.mobileShowEffectPass?i("select-text-mobile",{attrs:{contStyle:t.contentStyle,"page-side":t.pageSide,"is-wide":t.isWide,"page-id":t.pageId,containerSize:t.contentSize,isCurrent:t.isCurrent}}):t._e(),t._v(" "),t.renderInvisibleContent?i("div",{directives:[{name:"show",rawName:"v-show",value:t.showInvisibleContent,expression:"showInvisibleContent"}],staticClass:"content inv",style:t.contentStyle},[t._l(t.sortedContent.inv,(function(e){return[i(e.component,{directives:[{name:"show",rawName:"v-show",value:!t.isLoadingCache,expression:"!isLoadingCache"}],key:e.itemId,tag:"component",attrs:{contentMargin:t.marginSide,data:e,isCurrent:t.isCurrent},on:{ready:t.contentItemReady,error:t.contentError}})]}))],2):t._e(),t._v(" "),i("div",{staticClass:"content vis",style:t.contentStyle},[t._l(t.sortedContent.visible,(function(e){return[i(e.component,{directives:[{name:"show",rawName:"v-show",value:!t.isLoadingCache,expression:"!isLoadingCache"}],key:e.itemId,tag:"component",attrs:{data:e,contentMargin:t.marginSide,isCurrent:t.isCurrent,iconInitialAnimationDelay:t.initialPopupIconHighlight},on:{ready:t.contentItemReady,error:t.contentError}})]}))],2)],1),t._v(" "),t._l(t.notesArray,(function(e,s){return i("note",{key:s,attrs:{data:e,pageSize:t.pageSize,pageSide:t.pageSide,isWide:t.isWide,isOutsideHardcover:t.isOutsideHardcover}})})),t._v(" "),t.flipCornerEnabled?i("flip-me",{attrs:{pageId:t.pageId,isLeft:t.isLeftFlipCorner}}):t._e()],2)},h=[],l=i(5622),c=i(90),d=i(776);const p={props:{id:{type:[String,Number],required:!0},side:{type:String,required:!1,default:"both",validator:function(t){return-1!==["left","right","both"].indexOf(t)}},bordered:{type:Boolean,default:!1},size:{type:Object,required:!1,default:null},renderContent:{type:Boolean,default:!0},contentCrop:{type:Boolean,default:!1}},data:function(){return{alreadyLoaded:!1,thDebounced:!0,isCurrent:!1,pageId:this.id,pageSide:this.side,crossOrigin:(0,d.Z)().getCrossOrigin(),lastIsCurrent:!1,thumbnailUrl:null,backgroundColor:"#ffffff",isWide:!1,isWideLeft:!1,isStub:!1,isReady:!1,isDownloaded:!1,hasError:!1,isOutsideHardcover:!1,propWidth:null,propHeight:null,loadPending:!1,whitePixelUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="}},watch:{id:function(t){this.pageId=t},pageId:function(t,e){t&&(this.getOnceProperties(),this.getAPIProperties(),this.getProperties()),this.deregisterPage(e),this.registerPage(t)},side:function(t){this.pageSide=t},hasError:function(t){t&&this.isCurrent&&this.$root.$emit("pageLoaded"),t&&this.isZoomed&&this.setCursor("inherit")},isPreloaderShown:function(t){t||this.$emit("preloader:off",this)},changeProperty:function(t){t?.pageID===this.pageId&&this.getPropertiesDebounced()},apiChange:function(){this.getAPIProperties()},downloadProgressUpdated:"getDownloadProgress"},created:function(){this.getPropertiesDebounced=(0,l.Ds)((()=>{this.getProperties()}),100),this.getOnceProperties(),this.getAPIProperties(),this.getProperties(),this.getDownloadProgress(),this.registerPage(),this.loadPending||(this.loadPending=!0,this.alreadyLoaded=!0,this.getPropertiesTimeout=setTimeout((()=>{this.getProperties()}),500)),this.$root.$on("render:finish",this.getIsCurrent),this.getIsCurrent();const t=this.$store.getters["pages/isFirstPage"](this.pageId),e=this.$store.getters["pages/isLastPage"](this.pageId);this.hideLeftStripe=this.isRTLBook?e:t,this.hideRightStripe=this.isRTLBook?t:e;const i=this.$store.state.workspace.userAgentInfo;i.browser.facebook&&i.os.android&&(this.noImageCache=!0)},mounted:function(){setTimeout((()=>{!this.isCurrent||this.isReady&&this.isDownloaded||this.$root.$emit("pageLoaded")}),1e3)},beforeDestroy:function(){this.getPropertiesDebounced.destroy(),clearTimeout(this.getPropertiesTimeout),this.$root.$off("render:finish",this.getIsCurrent),this.deregisterPage(),this.noImageCache&&this.$store.dispatch("pages/resetPageResources",{pageID:this.pageId})},methods:{setCursor:function(t){this.isMobile||(this.$el.style.cursor=t)},getIsCurrent:function(){this.isCurrent=this.$store.getters["pager/isCurrentPage"]({pageId:this.pageId,pageSide:this.pageSide})},getOnceProperties:function(){this.propWidth=this.$store.getters["pages/pageProp"](this.pageId,"width"),this.propHeight=this.$store.getters["pages/pageProp"](this.pageId,"height")},registerPage:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageId;this.renderContent&&this.$pageRegistry.registerPage(t,this.pageSide,this)},deregisterPage:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pageId;this.renderContent&&this.$pageRegistry.deregisterPage(t,this.pageSide)},getSpreadTwin:function(){const t=this.$store.getters["pager/state"];return this.isCurrent&&t.spreadMode?this.pageId!==t.leftPage||this.isWide&&"right"===this.pageSide?this.pageId===t.rightPage?this.$pageRegistry.getPageComponent(t.leftPage,"left"):null:this.$pageRegistry.getPageComponent(t.rightPage,"right"):null},getDownloadProgress:function(){this.isDownloaded=this.$store.getters["pages/isDownloaded"](this.pageId)}},computed:{showThumbnail:function(){return this.isReady&&this.isDownloaded&&!this.hasError},isMobile:function(){return this.$store.getters["workspace/isMobile"]},isRTLBook:function(){return this.$store.state.book.rightToLeft},apiChange(){return this.$store.state.pages.apiChange},changeProperty(){return this.$store.state.pages.changeInPage},downloadProgressUpdated(){return this.$store.state.pages.downloadProgressUpdated},contentFreezed(){return"pending"!==this.$store.state.pager.flipState},updatePending(){return!this.isMobile&&this.isZoomed&&this.$store.getters["pages/pageProp"](this.pageId,"updatePending")},preloaderHeader(){return this.hasError?this.$t("Other.PAGE_ERROR_TITLE"):null},preloaderText(){return this.hasError?this.$t("Other.PAGE_ERROR_MESSAGE"):this.isReady?this.isDownloaded?null:this.$t("Other.DOWNLOADING_PAGE"):this.$t("Other.CONVERTING_PAGE")},backgroundLuma(){return this.backgroundColor?(0,c.R)((0,c.l)(this.backgroundColor)):1},enforceTransparentBg(){return this.$store.state.workspace.alteredSVGColors&&this.$store.state.workspace.userAgentInfo.browser.samsung},isZoomed:function(){return this.$store.state.pages.size.zoomFactor>1},dir(){return this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"},isResizing:function(){return this.$store.state.workspace.isResizing},isPreloaderShown:function(){return this.$store.state.workspace.preloader},pageWidthMultiplier:function(){return this.isWide&&"both"===this.pageSide?2:1},pagesSize(){return this.$store.getters["pages/size"]},contentSize(){if(this.pageId){const t=this.isOutsideHardcover&&parseInt(this.propWidth,10)===parseInt(this.$store.state.book.bookSize.width,10)&&parseInt(this.propHeight,10)===parseInt(this.$store.state.book.bookSize.height,10)?"FILL":null;return this.$store.getters["pages/contentSize"]({pageID:this.pageId,pageSide:this.pageSide,pageSize:this.pageSize,resizeOverride:t})}return{width:0,height:0,offsetX:0,offsetY:0,scaleRatio:{w:0,h:0}}}}};var g=i(6411),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",{class:"selecttext"+(t.showCanvas?" active":""),style:t.contStyle,on:{pan:t.pan,panstart:t.reset,panend:t.panEnd,pancancel:t.panEnd}},[t.showCanvas?i("canvas",{class:t.canvasClass,style:{position:"absolute",right:t.isWide&&"right"===t.pageSide?0:"none"},attrs:{width:t.containerSize.width,height:t.containerSize.height}}):t._e(),t._v(" "),t._l(t.textBlockSizes,(function(e,s){return i("div",{staticClass:"text-block",style:{width:e.width+"px",top:e.top+"px",left:e.left+"px",height:e.height+"px"},attrs:{"data-set":"select-text-block"}},[t.inspectorMode?i("span",{staticClass:"block-inspector-mode"},[t._v(t._s(s))]):t._e(),t._v(" "),t._l(t.finalTree[s].lines,(function(s,o){return t.inspectorMode?i("span",{staticClass:"line-inspector-mode",style:{top:s.top*t.containerSize.scaleRatio.h-e.top+"px",left:s.left*t.containerSize.scaleRatio.w-e.left+"px",width:s.width*t.containerSize.scaleRatio.w+"px",height:s.height*t.containerSize.scaleRatio.h+"px"}},[t._v(t._s(o))]):t._e()}))],2)}))],2)},f=[];function m(t,e){this.finalTree=t,this.isRTL=e,this.fullSelectedBlocks=[],this.partSelectedBlocks=[],this.fullSelectedLines=[],this.partSelectedLines=[],this.leftSelectedLines=[],this.rightSelectedLines=[],this.fullSelectedSymbols=[]}function b(t,e,i){if(t.bottom=t.top+t.height,t.right=t.left+t.width,0===t.width||0===t.height)return{rectCrossed:!1,fullSelected:!1};if(t.top<=e.top&&t.bottom>=e.bottom&&t.left<=e.left&&t.right>=e.right)return{rectCrossed:!1,fullSelected:!0};if(t.top<=e.top&&t.bottom>=e.bottom&&(t.left>=e.left&&t.left<=e.right||t.right<=e.right&&t.right>=e.left))return{rectCrossed:!0,fullSelected:!0};if(t.bottom<e.top||t.top>e.bottom||t.left>e.right||t.right<e.left)return{rectCrossed:!1,fullSelected:!1};let s,o,r,a,n,h;return i?(s=t.top>e.top&&t.bottom>e.bottom,o=t.top<e.top&&t.bottom<e.bottom):(s=t.top<e.top&&t.bottom<e.bottom,o=t.top>e.top&&t.bottom>e.bottom),"right"===t.cursorHSide?(r=e.right>t.right&&e.left<t.right,n=e.right>t.left&&e.left<t.left):(r=e.right>t.left&&e.left<t.left,n=e.right>t.right&&e.left<t.right),"top"===t.cursorVSide?(a=e.top<t.top&&e.bottom>t.top,h=e.top<t.bottom&&e.bottom>t.bottom):(a=e.top<t.bottom&&e.bottom>t.bottom,h=e.top<t.top&&e.bottom>t.top),{activePoint:r&&a,startPoint:n&&h,leftSelected:s,rightSelected:o,rectCrossed:!0,fullSelected:!1}}m.prototype.selectSymbols=function(t,e){const i=this._intersectRects(t,e);this._collectSelectedBlocks(i),this._collectSelectedLines(i),this._collectSelectedSymbols(i);return this._getSelectedSymbols(e)},m.prototype._collectSelectedBlocks=function(t){this.crossInfos=this._getCrossInfos(t);const e=this.crossInfos.filter((t=>t.startPoint||t.activePoint)).length<2;for(let i=0,s=this.finalTree.length;i<s;i++){const t=this.crossInfos[i];null!==t&&(t.fullSelected?this.fullSelectedBlocks.push(i):t.rectCrossed&&(e||t.startPoint||t.activePoint)&&this.partSelectedBlocks.push(i))}this._simplifySelectedBlocks()},m.prototype._collectSelectedLines=function(t){this.inverseLineSelection=!1;const e=2===this.partSelectedBlocks.map((t=>this.crossInfos[t])).filter((t=>t.startPoint||t.activePoint)).length;for(let i=0,s=this.partSelectedBlocks.length;i<s;i++){const s=this.partSelectedBlocks[i],o=e?this._modifyCurrentSelectRect(i,t):t;for(let t=0,e=this.finalTree[s].lines.length;t<e;t++){const e=b(o,this.finalTree[s].lines[t],this.isRTL),i=s+"-"+t;e.fullSelected?this.fullSelectedLines.push(i):e.rectCrossed&&(this.partSelectedLines.push(i),w(e.leftSelected,this.leftSelectedLines,i),w(e.rightSelected,this.rightSelectedLines,i))}}this._simplifySelectedLines(),2===this.partSelectedLines.length&&(1===this.rightSelectedLines.length&&0===this.leftSelectedLines.length?this.leftSelectedLines=this.partSelectedLines.filter((t=>t!==this.rightSelectedLines[0])):1===this.leftSelectedLines.length&&0===this.rightSelectedLines.length&&(this.rightSelectedLines=this.partSelectedLines.filter((t=>t!==this.leftSelectedLines[0]))))},m.prototype._collectSelectedSymbols=function(t){for(let e=0,i=this.partSelectedLines.length;e<i;e++){const i=this.partSelectedLines[e].split("-"),s=i[0],o=i[1],r=this.isRTL?this._processLineRtl(t,e):this._processLineLtr(t,e);for(let t=0,e=this.finalTree[s].lines[o].symbols.length;t<e;t++){const e=s+"-"+o+"-"+t;w(v(r,this.finalTree[s].lines[o].symbols[t]),this.fullSelectedSymbols,e)}}},m.prototype._processLineLtr=function(t,e){const i=this.partSelectedLines[e],s=i.split("-"),o=s[0],r=s[1],a=Object.assign({},t);return-1!==this.leftSelectedLines.indexOf(i)?(a.left=this.finalTree[o].lines[r].left,a.bottom>this.finalTree[o].lines[r].top&&a.bottom<this.finalTree[o].lines[r].bottom&&"bottom"===a.cursorVSide?"right"===a.cursorHSide?a.right=t.right:a.right=t.left:"right"===a.cursorHSide&&(a.right=this.inverseLineSelection?t.right:t.left),a.width=a.right-a.left):-1!==this.rightSelectedLines.indexOf(i)&&(a.right=this.finalTree[o].lines[r].right,a.top>this.finalTree[o].lines[r].top&&a.top<this.finalTree[o].lines[r].bottom&&"top"===a.cursorVSide?"left"===a.cursorHSide?a.left=t.left:a.left=t.right:"left"===a.cursorHSide&&(a.left=this.inverseLineSelection?t.left:t.right),a.width=a.right-a.left),a},m.prototype._processLineRtl=function(t,e){const i=this.partSelectedLines[e],s=i.split("-"),o=s[0],r=s[1],a=Object.assign({},t);return-1!==this.leftSelectedLines.indexOf(i)?(a.left=this.finalTree[o].lines[r].left,a.top>this.finalTree[o].lines[r].top&&a.top<this.finalTree[o].lines[r].bottom&&"bottom"===a.cursorVSide?a.right="left"===a.cursorHSide?t.right:t.left:"left"===a.cursorHSide&&(a.right=this.inverseLineSelection?t.right:t.left),a.width=a.right-a.left):-1!==this.rightSelectedLines.indexOf(i)&&(a.right=this.finalTree[o].lines[r].right,a.bottom>this.finalTree[o].lines[r].top&&a.bottom<this.finalTree[o].lines[r].bottom&&"top"===a.cursorVSide?a.left="right"===a.cursorHSide?t.left:t.right:"right"===a.cursorHSide&&(a.left=this.inverseLineSelection?t.left:t.right),a.width=a.right-a.left),a},m.prototype._getSelectedSymbols=function(t){const e=[];for(let i=0,s=this.finalTree.length;i<s;i++)if(-1===this.fullSelectedBlocks.indexOf(i))if(-1===this.partSelectedBlocks.indexOf(i));else for(let o=0,r=this.finalTree[i].lines.length;o<r;o++)if(-1===this.fullSelectedLines.indexOf(i+"-"+o)){if(-1!==this.partSelectedLines.indexOf(i+"-"+o)){let s=[];for(let t=0,e=this.finalTree[i].lines[o].symbols.length;t<e;t++)-1!==this.fullSelectedSymbols.indexOf(i+"-"+o+"-"+t)&&s.push(this.finalTree[i].lines[o].symbols[t]);s=this._filterByAllowedRect(s,t),s.length>0&&(s.push(this._getLineBreak(s)),e.push(...s))}}else{const s=this._filterByAllowedRect(this.finalTree[i].lines[o].symbols,t);s.length>0&&e.push(...s,this._getLineBreak(s))}else e.push(...this._getSymbolsFromBlock(i,t));return this._removeRedundantLineBreaks(e)},m.prototype._intersectRects=function(t,e){if(!e)return t;const i=S(t.left,e.left,e.left+e.width),s=S(t.left+t.width,e.left,e.left+e.width),o=S(t.top,e.top,e.top+e.height),r=S(t.top+t.height,e.top,e.top+e.height),a={left:i,width:Math.max(s-i,0),right:s,top:o,height:Math.max(r-o,0),bottom:r};return Object.assign({},t,a)},m.prototype._filterByAllowedRect=function(t,e){if(!e)return t;const i=e.left+e.width,s=e.top+e.height;return t.filter((t=>{const o=t.left>=e.left&&t.right<=i||t.left>e.left&&t.left<=i||t.left<e.left&&t.right>=e.left,r=t.top>=e.top&&t.bottom<=s||t.top<e.top&&t.bottom>=e.top||t.top>e.top&&t.top<=s;return o&&r}))},m.prototype._removeRedundantLineBreaks=function(t){return 0===t.length||("\n"===t[0].word&&t.splice(0,1),"\n"===t[t.length-1].word&&t.pop()),t},m.prototype._modifyCurrentSelectRect=function(t,e){const i=this,s=this.partSelectedBlocks[t],o=this.crossInfos[this.partSelectedBlocks[t]],r=Object.assign({},e),a=t=>{r.height=this.finalTree[s].top+this.finalTree[s].height-r.top+2,r.top=e.top,t||(r.top+=e.height,i.inverseLineSelection=!0)},n=t=>{r.top=this.finalTree[s].top,r.height=e.height+e.top-this.finalTree[s].top,t||(r.height-=e.height,i.inverseLineSelection=!0)};if(0===t)if(o.startPoint){a("bottom"===r.cursorVSide)}else{a("bottom"!==r.cursorVSide)}else if(1===t)if(o.activePoint){n("bottom"===r.cursorVSide)}else{n("bottom"!==r.cursorVSide)}return r},m.prototype._simplifySelectedBlocks=function(){this.partSelectedBlocks.length>2&&(this.partSelectedBlocks=[Math.min(...this.partSelectedBlocks),Math.max(...this.partSelectedBlocks)]);const t=[...this.partSelectedBlocks,...this.fullSelectedBlocks];if(t.length>0){let e=Math.min(...t);const i=Math.max(...t),s=[];for(;e<=i;)s.push(e),e++;this.fullSelectedBlocks=s.filter((t=>-1===this.partSelectedBlocks.indexOf(t)))}},m.prototype._simplifySelectedLines=function(){const t=[...this.partSelectedLines,...this.fullSelectedLines],e=new Map,i=[];for(let s=0,o=t.length;s<o;s++){const i=t[s].split("-");e.get(i[0])||e.set(i[0],[]);const o=e.get(i[0]);o.push(i[1]),e.set(i[0],o)}for(const[s,o]of e){let t=Math.min(...o),e=Math.max(...o);for(-1!==this.partSelectedLines.indexOf(s+"-"+t)&&t++,-1!==this.partSelectedLines.indexOf(s+"-"+e)&&e--;t<=e;)i.push(s+"-"+t),t++}this.fullSelectedLines=i},m.prototype._getSymbolsFromBlock=function(t,e){const i=[],s=this.finalTree[t].lines||[];for(let o=0,r=s.length;o<r;o++){const t=this._filterByAllowedRect(s[o].symbols,e);t.length>0&&i.push(...t,this._getLineBreak(t))}return i},m.prototype._getLineBreak=function(t,e){const i=.01,s=e?t[0]:t[t.length-1],o={left:e?s.left-i:s.left+s.width,top:s.top,height:s.height,angle:s.angle,width:i,word:"\n",lineBreak:!0};return o.right=o.left+o.width,o},m.prototype._getCrossInfos=function(t){const e=[];for(let i=0,s=this.finalTree.length;i<s;i++){const s=this.finalTree[i];e[i]=s.onlyForSearch?null:b(t,s,this.isRTL)}return e};const S=function(t,e,i){return t<=e?e:t>=i?i:t};function v(t,e){return t.right=t.left+t.width,t.left<e.left&&t.right>e.right||(t.left<e.left+.7*e.width&&t.right>e.right||t.left<e.left&&t.right>e.right-.7*e.width)}function w(t,e,i){const s=e.indexOf(i);t?-1===s&&e.push(i):-1!==s&&e.splice(s,1)}var y=i(320);let k,x,$,z;try{i.e(18).then(i.bind(i,4015)).then((t=>{k=t,k.memory.grow(80),$=new TextEncoder("utf8"),z=new TextDecoder("utf8"),x=!0})).catch((t=>{console.log("fribidi wasn't initialized")}))}catch(ao){console.log("fribidi wasn't initialized")}const P="";function C(){}function T(t,e){const i=t.map((t=>t.rtl)).filter((t=>!(0,y.o8)(t)));return 0===i.length?e:i[0]}C.prototype.getSelectedText=function(t,e){const i=this._getLines(t);let s="";const o=x?this._processLineFribidi:this._processLineSimple;for(let r=0,a=i.length;r<a;r++){const t=i[r].some((t=>t.rtl))||e,n=i[r].map((t=>t.word)),h=t?o.call(this,i[r],e):n.join("");s+=this._processBrackets(h)+(r<a-1?"\n":"")}return s},C.prototype._processLineFribidi=function(t,e){const i=t.map((t=>t.word)),s=t.some((t=>t.rtl))?P:"",o=s+i.join("")+s,r=$.encode(o),a=new Uint8Array(k.memory.buffer),n=k.calloc(r.byteLength,1);a.set(r,n);const h=k.calloc(4*o.length,4),l=k.fribidi_utf8_to_unicode(n,r.byteLength,h),c=k.calloc(1,4),d=(e?1:0)|parseInt("10","16")|parseInt("100","16");a.set([d],c);const p=k.calloc(l,4),g=k.calloc(l,4),u=k.calloc(l,1);k.fribidi_get_bidi_types(h,l,p),k.fribidi_get_bracket_types(h,l,p,g);k.fribidi_get_par_embedding_levels_ex(p,g,l,c,u),a.slice(u,u+l);const f=3|parseInt("40000","16");k.fribidi_reorder_line(f,p,l,0,c,u,h,null),k.fribidi_shape(f,u,l,null,h);const m=k.calloc(2*r.byteLength,1);k.fribidi_unicode_to_utf8(h,l,m);const b=a.slice(m,m+r.byteLength),S=z.decode(b).replace(/\u200f/g,"");return k.free(h),k.free(n),k.free(m),k.free(c),k.free(p),k.free(g),k.free(u),S},C.prototype._processLineSimple=function(t){const e=this._getDirectionFragments(t);let i="";for(let s=0;s<e.length;s++){i=(T(e[s],!1)?e[s].reverse().map((t=>t.word)).join(""):e[s].map((t=>t.word)).join("")).trim()+(i.length>0?" ":"")+i}return i},C.prototype._processBrackets=function(t){const e=[{char:"(",open:!0,reversed:")"},{char:")",open:!1,reversed:"("},{char:"[",open:!0,reversed:"]"},{char:"]",open:!1,reversed:"["},{char:"{",open:!0,reversed:"}"},{char:"}",open:!1,reversed:"{"}];let i=t;for(let s=0;s<e.length;s++){let t=i.indexOf(e[s].char);for(;t>=0;)i=this._processBracket(i,t,e[s].open,e[s].reversed),t=i.indexOf(e[s].char,t+1)}return i},C.prototype._processBracket=function(t,e,i,s){const o=(t,e)=>e?/[\s,:;\\.\\!\\?]/.test(t):/[\s,:;]/.test(t);let r,a,n=t;return i?(r=e===n.length-1||o(n[e+1],!0),a=r&&e>0&&!o(n[e-1],!1),a&&(n=(e>0?n.substr(0,e):"")+s+(e<n.length-1?n.substr(e+1):""))):(r=0===e||o(n[e-1],!0),a=r&&e<n.length-1&&!o(n[e+1],!1),a&&(n=(e>0?n.substr(0,e):"")+s+(e<n.length-1?n.substr(e+1):""))),n},C.prototype._getLines=function(t){let e;return t.reduce(((t,i)=>{if("\n"===i.word)return e=!0,t;if(0===t.length)t.push([i]);else{const s=t[t.length-1];e?t.push([i]):s.push(i)}return e=!1,t}),[])},C.prototype._getDirectionFragments=function(t){return t.reduce(((t,e)=>{if(0===t.length)return t.push([e]),t;const i=t[t.length-1],s=T(i);return" "===e.word||(0,y.o8)(e.rtl)||(0,y.o8)(s)||e.rtl===s?i.push(e):t.push([e]),t}),[])};const M={props:["containerSize","pageId","isWide","pageSide","isLoaded","isCurrent","contStyle"],data:function(){return{finalTree:[],pageRect:null,selectedSymbols:[],showEffect:!1,isCrossWide:!1}},created:function(){this.updateSelectedTextDebounced=(0,l.Ds)((function(){const t=new C,e=this.$store.state.book.rightToLeft,i=t.getSelectedText(this.selectedSymbols,e);this.$store.dispatch("text/setSelectedText",i)}),100),this.drawSelectionDebounced=(0,l.Ds)(this.drawSelection,100),this.isCurrent&&this.getAndParseXML()},beforeDestroy:function(){this.updateSelectedTextDebounced.destroy()},methods:{initContext:function(){const t=this.$el.getElementsByTagName("canvas")[0];t&&(this.context=t.getContext("2d"))},resetContext:function(){this.context&&(this.context=null)},getAndParseXML:function(){if(!this.$store.getters["search/isSelectTextInfoLoaded"](this.pageId))return;const t="slide-book"===this.$store.state.workspace.bookComponent&&this.$store.state.pager.slideMode,e=this.$store.getters["search/getSelectTextInfo"](this.pageId,"right"===this.pageSide,t);this.finalTree=Object.freeze(e.finalTree),this.isCrossWide=e.isCrossWide,this.isRtlSelection=e.isRtlSelection,0!==this.userRect.width&&this.parseRect(this.$store.state.text.selectionRect)},parseRect:function(t){if(this.isWide&&!this.isCrossWide){const e=this.$store.getters["pages/pageProp"](this.pageId,"width")/2;if("left"===this.pageSide&&t.left>=e||"right"===this.pageSide&&t.left<e)return void(this.selectedSymbols=[])}if(!this.isCurrent)return void(this.selectedSymbols=[]);const e=new m(this.finalTree,this.isRtlSelection);this.selectedSymbols=e.selectSymbols(t,this.allowedRect),this.updateSelectedTextDebounced()},getPageRect:function(){this.$store.state.workspace.containerSize.width>0?this.pageRect=this.$el.getBoundingClientRect():this.pageRect=null},getBorderCollisions(t){return this.allowedRect?{left:t.left<this.allowedRect.left,right:t.right>this.allowedRect.left+this.allowedRect.width,top:t.top<this.allowedRect.top,bottom:t.bottom>this.allowedRect.bottom}:{}},getCornerSymbol(t){return{isRtlSelection:this.isRtlSelection,top:Math.round(t.top*this.containerSize.scaleRatio.h),left:Math.round(t.left*this.containerSize.scaleRatio.w),width:Math.round(t.width*this.containerSize.scaleRatio.w),height:Math.round(t.height*this.containerSize.scaleRatio.h),collisions:this.getBorderCollisions(t)}},drawSelection(){if(0!==this.selectedSymbols.length){this.$store.dispatch("workspace/setActiveInteractiveElement","selected-text"),this.context||this.initContext(),this.context.clearRect(0,0,this.containerSize.width,this.containerSize.height),this.context.fillStyle="#027bff";for(let t=0,e=this.selectedSymbols.length;t<e;t++){const e=this.selectedSymbols[t];this.context.fillRect(e.left*this.containerSize.scaleRatio.w-(this.isWide&&"right"===this.pageSide?this.pageRect.width/2:0),e.top*this.containerSize.scaleRatio.h,e.width*this.containerSize.scaleRatio.w+1,e.height*this.containerSize.scaleRatio.h)}}}},watch:{userRect:function(t,e){t.top===e.top&&t.left===e.left&&t.width===e.width&&t.height===e.height||this.parseRect(t)},selectedSymbols:function(t){null!==t?(t.length>0?this.$nextTick((()=>{this.drawSelection()})):this.resetContext(),this.cornerTimeout=setTimeout((()=>{if(this.selectedSymbols.length<1)return;let t,e;if(1===this.selectedSymbols.length)t=e=this.selectedSymbols[0];else if(this.isRtlSelection){const i=this.selectedSymbols.findIndex((t=>t.lineBreak));t=-1===i?this.selectedSymbols[0]:this.selectedSymbols[i-1];let s=this.selectedSymbols.length-1;for(;s>=0&&!this.selectedSymbols[s].lineBreak;)s-=1;e=-1===s?this.selectedSymbols[this.selectedSymbols.length-1]:s===this.selectedSymbols.length-1?this.selectedSymbols[s-1]:this.selectedSymbols[s+1]}else t=this.selectedSymbols[0],e=this.selectedSymbols[this.selectedSymbols.length-1],10===e.word.charCodeAt(0)&&(e=this.selectedSymbols[this.selectedSymbols.length-2]);this.$store.dispatch("text/setCornerSymbols",{first:this.getCornerSymbol(t),last:this.getCornerSymbol(e)})}),50),0===this.selectedSymbols.length&&this.$root.$emit("selectText:hidePanel")):this.$root.$emit("selectText:hidePanel")},isCurrent:function(t){t&&(0===this.finalTree.length&&this.getAndParseXML(),this.$nextTick((()=>{this.getPageRect()})))},selectTextInfoLoaded:function(t){t.pageId===this.pageId&&this.getAndParseXML()},animationInProgress:function(t){t||this.$store.getters["pager/isCurrentPage"]({pageId:this.pageId,pageSide:this.pageSide})&&this.getPageRect()},activeInteractiveElement(t){"selected-text"!==t&&"text-context-menu"!==t&&this.$store.dispatch("text/reset")}},computed:{canvasClass:function(){return{"select-text-canvas":!0,"show-effect":this.showEffect,"hide-before-effect":!this.showEffect&&this.effectOn}},effectOn:function(){return this.$store.state.text.effect},userRect:function(){const t={top:0,left:0,width:0,height:0};return this.$store.state.text.selectionRect&&(this.pageId===this.$store.state.text.pageID&&this.isWide&&this.pageSide!==this.$store.state.text.pageSide||this.pageId===this.$store.state.text.pageID&&this.pageSide===this.$store.state.text.pageSide&&this.isCurrent)?this.$store.state.text.selectionRect:t},allowedRect:function(){if(!this.isWide||!this.isCrossWide||!this.singleMode)return;const t=this.$store.getters["pages/pageProp"](this.pageId,"width")/2;return{left:"right"===this.pageSide?t:0,width:t,top:0,height:this.$store.getters["pages/pageProp"](this.pageId,"height")}},singleMode:function(){return this.$store.state.pager.singleMode},showCanvas(){return this.selectedSymbols.length>0},selectTextInfoLoaded(){return this.$store.state.search.selectTextInfoLoaded},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]},activeInteractiveElement(){return this.$store.state.workspace.activeInteractiveElement}}};var I=i(2155);const L={name:"select-text",mixins:[M],data:function(){return{isActive:!1,isDragging:!0}},mounted:function(){this.$nextTick((()=>{this.getPageRect()})),this.$parent.$parent.$on("highlight",this.highlight),this.$root.$on("publication:mouseleave",this.panEnd),this.$root.$on("zoomMove",this.zoomMove),this.effectOn&&this.$el.addEventListener("mousemove",this.checkMousePosition)},beforeDestroy(){this.resetContext(),this.$parent.$parent.$off("highlight",this.highlight),this.$root.$off("zoomMove",this.zoomMove),this.$root.$off("publication:mouseleave",this.panEnd),this.$el.removeEventListener("mousemove",this.checkMousePosition)},methods:{highlight:function(){this.effectOn&&(this.panEnd(),this.showEffect=!0,setTimeout((()=>{this.showEffect=!1,this.$store.dispatch("text/setEffect",!1)}),3e3))},reset:function(t){this.effectOn||(this.$el.removeEventListener("mousemove",this.checkMousePosition),this.$root.$emit("selectText:hidePanel"),t&&"panstart"===t.type&&(this.isActive=!0),this.$store.dispatch("text/reset"))},pan:function(t){if(!(this.pageRect&&this.isLoaded&&this.isCurrent&&(!this.isZoomed||!this.isDragging))||!this.isActive||this.selectAll||this.effectOn||this.animationInProgress)return;const e={top:t.deltaY>0?t.center.y-t.deltaY-this.pageRect.top:t.center.y-this.pageRect.top,left:t.deltaX>0?t.center.x-t.deltaX-this.pageRect.left:t.center.x-this.pageRect.left,width:Math.abs(t.deltaX),height:Math.abs(t.deltaY),offsetX:this.containerSize.offsetX,offsetY:this.containerSize.offsetY,cursorHSide:t.deltaX>0?"right":"left",cursorVSide:t.deltaY>0?"bottom":"top"};if(e.top=e.top/this.containerSize.scaleRatio.h,e.left/=this.containerSize.scaleRatio.w,e.width/=this.containerSize.scaleRatio.w,e.height/=this.containerSize.scaleRatio.h,this.isWide&&!this.isCrossWide){if("right"===e.cursorHSide&&"left"===this.pageSide&&e.left+e.width>this.containerSize.width/this.containerSize.scaleRatio.w)return;if("left"===e.cursorHSide&&"right"===this.pageSide&&e.left<this.containerSize.width/this.containerSize.scaleRatio.w)return}this.$store.dispatch("text/setSelectionAttributes",{pageID:this.pageId,pageSide:this.pageSide,selectionRect:e})},selectAllPageContent(){const t=this.$store.getters["pages/pageProp"](this.pageId,"wide"),e="right"===this.pageSide,i="slide-book"===this.$store.state.workspace.bookComponent&&"slide"===this.$store.state.pager.mode,{isCrossWide:s}=this.$store.getters["search/getSelectTextInfo"](this.pageId,e,i),o=this.$store.getters["pages/pageProp"](this.pageId,"width")/(t&&!s?2:1),r={height:this.$store.getters["pages/pageProp"](this.pageId,"height"),width:o,offsetX:this.containerSize.offsetX,offsetY:this.containerSize.offsetY,cursorHSide:"left",cursorVSide:"bottom"},a=s?{top:0,left:0}:e&&t?{left:o,top:0}:{top:0,left:0},n=(0,I.Z)(a,r);this.$store.dispatch("text/setSelectionAttributes",{pageID:this.pageId,pageSide:this.pageSide,selectionRect:n,selectAll:this.selectAll})},finalizePreliminarySelection:function(){const t={offsetX:this.containerSize.offsetX,offsetY:this.containerSize.offsetY},e=(0,I.Z)({},t,this.$store.state.text.selectionRect);e.width*=1,e.height*=1,e.top*=1,e.left*=1,this.$store.dispatch("text/setSelectionAttributes",{pageID:this.pageId,pageSide:this.pageSide,selectionRect:e})},panEnd:function(t){t&&t.srcEvent&&0===t.srcEvent.button&&this.mouseUp(),this.isActive=!1},mouseUp(){setTimeout((()=>{this.selectedSymbols.length>0&&(this.$root.$emit("selectText",{action:"select",pageId:this.pageId,text:this.$store.state.text.selectedText}),this.$root.$emit("selectText:showPanel"),this.$el.addEventListener("mousemove",this.checkMousePosition))}),100)},zoomMove(t){"drag"===t.direction&&(this.isDragging=t.active)},checkMousePosition(t){this.$parent.$parent.isPointInSelection(t)?this.$root.$emit("selectText:showPanel"):this.$root.$emit("selectText:hidePanel",{forceHide:!1})}},watch:{isActive:function(t){this.$store.dispatch("text/setInProgressSelection",t)},pageSize:function(){this.$root.$emit("selectText:hidePanel"),this.$nextTick((()=>{this.getPageRect()}))},sidebar:function(){this.$root.$emit("selectText:hidePanel"),this.$nextTick((()=>{this.getPageRect()}))},wsContainerSize:function(){this.$root.$emit("selectText:hidePanel"),this.$nextTick((()=>{this.getPageRect()}))},scrollPosition:function(){this.$nextTick((()=>{this.getPageRect()}))},isLoaded:function(t){this.getPageRect()},animationInProgress:function(){this.$store.dispatch("text/reset"),this.$root.$emit("selectText:hidePanel")},pageResize:function(){this.$nextTick((()=>{this.getPageRect()}))},selectAll:function(t){t&&this.selectAllPageContent()},preliminarySelection:function(t){this.validContainerSize&&t&&this.finalizePreliminarySelection()},containerSize:function(){this.validContainerSize&&(this.preliminarySelection?this.finalizePreliminarySelection():this.drawSelectionDebounced())}},computed:{inspectorMode(){return this.$store.state.workspace.inspectorMode},selectAll:function(){return this.$store.state.text.selectAll&&this.pageId===this.$store.state.text.pageID&&this.pageSide===this.$store.state.text.pageSide},preliminarySelection:function(){return this.$store.state.text.preliminarySelection&&this.pageId===this.$store.state.text.pageID&&this.pageSide===this.$store.state.text.pageSide},validContainerSize:function(){return this.containerSize?.width>0&&this.containerSize?.height>0},textBlockSizes:function(){return this.finalTree.map((t=>({width:Math.ceil(t.width*this.containerSize.scaleRatio.w),height:Math.ceil(t.height*this.containerSize.scaleRatio.h),left:Math.floor(t.left*this.containerSize.scaleRatio.w),top:Math.floor(t.top*this.containerSize.scaleRatio.h)})))},pageSize:function(){return this.$store.state.pages.size},sidebar:function(){return this.$store.state.sidebar.opened},wsContainerSize:function(){return this.$store.state.workspace.containerSize},scrollPosition:function(){return this.$store.getters["text/holderScroll"]},isZoomed:function(){return this.$store.state.pages.size.zoomFactor>1},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]},pageResize:function(){return this.$store.getters["pages/pageProp"](this.pageId,"pageResize")}}};var R=i(1900);const E=(0,R.Z)(L,u,f,!1,null,"22b6e05d",null).exports;var F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",{staticClass:"selecttext",style:t.contStyle,on:{tap:t.reset}},[this.showCanvas?i("canvas",{class:t.canvasClass,style:{position:"absolute",right:"right"===t.pageSide&&t.isWide?0:"none"},attrs:{width:t.containerSize.width,height:t.containerSize.height}}):t._e()])},O=[];const _={name:"select-text-mobile",mixins:[M],mounted:function(){this.$nextTick((()=>{this.getPageRect()})),this.$parent.$parent.$on("highlight",this.highlight)},beforeDestroy(){this.resetContext(),this.$parent.$parent.$off("highlight",this.highlight)},methods:{highlight:function(){this.effectOn&&(this.showEffect=!0,setTimeout((()=>{this.showEffect=!1,this.$store.dispatch("text/setEffect",!1)}),3e3))},reset(){this.$store.dispatch("text/reset")}},watch:{containerSize:function(){this.getAndParseXML()},animationInProgress:function(){this.$store.dispatch("text/reset")}},computed:{animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]}}};const D=(0,R.Z)(_,F,O,!1,null,"6d6ab027",null).exports;var W=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",{staticClass:"publication-note",style:t.noteStyle,attrs:{"data-note-id":t.data.id},on:{tap:t.onNoteClick,mousedown:function(t){t.stopPropagation()}}},[i("div",{ref:"icon",class:t.iconClass},[i("svgicon",{attrs:{focusable:"false",name:"note-content"}})],1)])},B=[],A=(i(2150),i(2567));const H=Number(getComputedStyle(document.documentElement).getPropertyValue("--z-index-publication-note-base")),N={name:"Note",props:{data:{type:Object,default:function(){return{}}},pageSize:{type:Object,default:function(){return{}}},pageSide:{type:String,default:""},isWide:Boolean,isOutsideHardcover:Boolean},data:function(){return{state:"mini",offsetX:0,offsetY:0,deltaX:0,deltaY:0,minDeltaX:0,minDeltaY:0,maxDeltaX:0,maxDeltaY:0,onMove:!1,position:"absolute",leftOffset:16,rightOffset:16,topOffset:28,bottomOffset:4}},computed:{isOpened:function(){return this.$store.state.notes.opened===this.data.id},isFirstPage:function(){return this.$store.getters["pages/isFirstPage"](this.data.page)},isLastPage:function(){return this.$store.getters["pages/isLastPage"](this.data.page)},scale:function(){return{w:this.pageSize.width/this.$store.state.book.bookSize.width/("both"===this.pageSide?2:1),h:this.pageSize.height/this.$store.state.book.bookSize.height}},noteStyle:function(){let t=0,e=0,i=0;if(this.isWide&&"right"===this.pageSide&&(t=-this.pageSize.width),this.onMove){if("right"===this.pageSide){const t=this.slideMode&&(this.isFirstPage&&!this.rtl||this.isLastPage&&this.rtl);this.isOutsideHardcover||t||(e=this.pageSize.width)}if("left"===this.pageSide){this.slideMode&&(this.isLastPage&&!this.rtl||this.isFirstPage&&this.rtl)||(i=this.pageSize.width)}this.slideMode&&(this.pagerSlideMode&&"both"!==this.pageSide||this.pagerSingleMode)&&(e=0,i=this.pageSize.width),this.pagerSingleMode&&(this.rtl&&"right"===this.pageSide?t-=this.pageSize.width:this.rtl||"left"!==this.pageSide||(t+=this.pageSize.width))}let s=this.data.pX*this.scale.w+this.deltaX+e+t;s=Math.max(this.leftOffset,Math.min(this.pageSize.width+e+i-this.rightOffset,s));let o=this.data.pY*this.scale.h+this.deltaY;return o=Math.max(this.topOffset,Math.min(this.pageSize.height-this.bottomOffset,o)),{"z-index":this.data.id+H,position:this.position,top:o+"px",left:s+"px"}},iconClass:function(){const t=["note-icon",this.data.color,this.state];return this.isOpened&&t.push("opened"),t},rtl:function(){return this.$store.state.book.rightToLeft},slideMode:function(){return"slide-book"===this.$store.state.workspace.bookComponent},pagerSlideMode:function(){return this.$store.state.pager.slideMode},pagerSingleMode:function(){return this.$store.state.pager.singleMode},currentBookHolder:function(){return this.slideMode?document.querySelector(".slide-wrapper.current .spread-wrapper"):document.getElementById("book-holder")},isFrozenOrNotReady(){return this.$store.state.workspace.freezed||"ready"!==this.$store.state.workspace.status||this.$store.state.workspace.isResizing||this.$store.state.pager.freezed}},mounted:function(){this.$refs.icon.addEventListener("mousedown",this.iconMouseDown,!0),this.parentEl=this.$el.parentElement},beforeDestroy:function(){this.$refs.icon.removeEventListener("mousedown",this.iconMouseDown,!0)},methods:{onNoteClick:function(t){this.isFrozenOrNotReady||(this.isOpened?this.$store.dispatch("workspace/setActiveInteractiveElement",null):this.$store.dispatch("notes/setOpenedId",{id:this.data.id,target:"icon"}))},iconMouseDown:function(t){0===t.button&&(t.preventDefault(),t.stopPropagation(),this.offsetX=t.pageX,this.offsetY=t.pageY,this.isOpened||this.$store.dispatch("notes/setOpenedId",{id:null}),this.$store.dispatch("notes/setMoving",!0),document.addEventListener("mousemove",this.iconMouseMove),document.addEventListener("mouseup",this.iconMouseUp),this.$root.$on("publication:mouseleave",this.iconMouseUp))},iconMouseMove:function(t){if(t.stopPropagation(),!this.onMove){if(this.moveElementToSpreadNotes(),this.slideMode&&!this.pagerSingleMode)this.minDeltaX=this.leftOffset-this.data.pX*this.scale.w,this.maxDeltaX=this.pageSize.width-this.data.pX*this.scale.w-this.rightOffset;else if("left"===this.pageSide){this.minDeltaX=this.leftOffset-this.data.pX*this.scale.w;const t=!this.isWide&&(this.isLastPage&&!this.rtl||this.isFirstPage&&this.rtl)?1:2;this.maxDeltaX=this.pageSize.width*t-this.data.pX*this.scale.w-this.rightOffset}else{const t=!this.isWide&&(this.isFirstPage&&!this.rtl||this.isLastPage&&this.rtl)?0:this.pageSize.width;this.minDeltaX=(this.isWide?this.pageSize.width:0)+this.leftOffset-t-this.data.pX*this.scale.w,this.maxDeltaX=this.pageSize.width*(this.isWide?2:1)-this.data.pX*this.scale.w-this.rightOffset}!this.pagerSingleMode||this.isFirstPage||this.isLastPage&&this.$store.getters["pages/pagesCount"]%2==0||("left"===this.pageSide?this.maxDeltaX-=this.pageSize.width:"right"===this.pageSide&&(this.minDeltaX+=this.pageSize.width)),this.minDeltaY=this.topOffset-this.data.pY*this.scale.h,this.maxDeltaY=(this.pageSize.height/this.scale.h-this.data.pY)*this.scale.h-this.bottomOffset,this.isOutsideHardcover||(this.position="fixed"),this.onMove=!0,this.state="move"}this.deltaX=Math.max(this.minDeltaX,Math.min(t.pageX-this.offsetX,this.maxDeltaX)),this.deltaY=Math.max(this.minDeltaY,Math.min(t.pageY-this.offsetY,this.maxDeltaY))},iconMouseUp:function(){if(document.removeEventListener("mousemove",this.iconMouseMove),document.removeEventListener("mouseup",this.iconMouseUp),this.$root.$off("publication:mouseleave",this.iconMouseUp),this.$store.dispatch("notes/setMoving",!1),this.moveElementToPageContainer(),this.onMove){this.onMove=!1,this.position="absolute";let t=this.data.page,e=this.deltaX/this.scale.w+this.data.pX;this.isWide||("left"===this.pageSide?e>this.pageSize.width/this.scale.w&&(e-=this.pageSize.width/this.scale.w,this.rtl?t--:t++):e<0&&(e+=this.pageSize.width/this.scale.w,this.rtl?t++:t--),e<this.leftOffset/this.scale.w&&(e=this.leftOffset/this.scale.w),e>this.pageSize.width/this.scale.w-this.rightOffset/this.scale.w&&(e=this.pageSize.width/this.scale.w-this.rightOffset/this.scale.w)),this.$store.dispatch("notes/moveNote",{id:this.data.id,page:t.toString(),pX:Math.round(100*e)/100,pY:Math.round(100*(this.deltaY/this.scale.h+this.data.pY))/100}),this.state="mini",this.deltaX=0,this.deltaY=0}},moveElementToSpreadNotes:function(){this.slideMode||this.isOutsideHardcover||(this.spreadNotesEl||(this.spreadNotesEl=this.createSpreadNotesElement()),this.spreadNotesEl.appendChild(this.$el))},moveElementToPageContainer:function(){this.slideMode||this.isOutsideHardcover||this.parentEl.appendChild(this.$el)},createSpreadNotesElement:function(){let t=document.getElementById("spread-notes");if(!t){const e=document.getElementById("book");t=A.Z.createElement("div",{id:"spread-notes"},e)}return t}}};const Z=(0,R.Z)(N,W,B,!1,null,"4f0d47b2",null).exports;var V=i(924),U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.classes},[i("div",{staticClass:"flip-me-backface",style:t.backfaceStyle},[t.isTranslucentReverseSide?t._l(t.backfaceBackgrounds,(function(e,s){return i("img",{key:s,staticClass:"flip-me-image",style:t.backfaceImgStyle,attrs:{crossOrigin:t.crossOrigin,src:e}})})):t._e(),t._v(" "),i("div",{staticClass:"flip-me-gradient2",style:t.backGradientStyle})],2),t._v(" "),i("div",{staticClass:"flip-me-mask",style:t.maskStyle},[i("div",{staticClass:"flip-me-gradient",style:t.nextGradientStyle}),t._v(" "),i("div",{staticClass:"flip-me-shift-page",style:t.shiftPageStyle},[i("div",{staticClass:"flip-me-next-page",style:t.nextPageStyle},t._l(t.nextBackgrounds,(function(e,s){return i("img",{key:s,staticClass:"flip-me-image",style:t.nextImgStyle,attrs:{crossOrigin:t.crossOrigin,src:e}})})),0)])])])},G=[],X=i(2029),j=i.n(X);const Y=function(){const t=window.getComputedStyle(document.documentElement,""),e=(Array.prototype.slice.call(t).join("").match(/-(moz|webkit|ms)-/)||""===t.OLink&&["","o"])[1];return{dom:"WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1],lowercase:e,css:"-"+e+"-",js:e[0].toUpperCase()+e.substr(1)}}(),q={name:"FlipMe",props:{pageId:{type:String,required:!0},isLeft:{type:Boolean,required:!0}},data:function(){return{angle:0,width:0,backfaceParams:null,nextPageParams:null,tween:null,crossOrigin:(0,d.Z)().getCrossOrigin()}},created(){const t=this.$store.getters["pager/flipState"],e=this.isLeft?t.currentLeft:t.currentRight,i=e+(this.isLeft?-1:1),s=e+(this.isLeft?-2:2);this.backfaceParams=this.$store.getters["pager/flipParams"](i),this.nextPageParams=this.$store.getters["pager/flipParams"](s)},mounted(){const t={angle:19,width:0};this.tween=new(j().Tween)(t).to({angle:19,width:7},800).easing(j().Easing.Cubic.InOut).onUpdate((()=>{if(this.width=t.width,this.angle=t.angle,0===t.width){const t=5*Math.random()+3,e=11*Math.random()+19;setTimeout((()=>{this.tween.to({angle:e,width:t})}),10)}})).yoyo(!0).repeat(1/0).delay(2e3).repeatDelay(200).start(),this.$parent.$once("onContentContainerClick",this.stopAnimation)},beforeDestroy(){this.stopAnimation()},computed:{classes(){return{"flip-me-container":!0,left:this.isLeft,"translucent-reverse-side":this.singleMode&&this.isTranslucentReverseSide}},singleMode(){return this.$store.state.pager.singleMode},isRTLBook(){return this.$store.state.book.rightToLeft},isTranslucentReverseSide(){return this.$store.state.workspace.components.book.isTranslucentReverseSide},nextBackgrounds(){return this.getBackgroundsArray(this.nextPageParams.pageId)},backfaceBackgrounds(){return this.getBackgroundsArray(this.backfaceParams.pageId)},pagesSize(){return this.$store.getters["pages/size"]},backfaceImgStyle(){return this.getImageStyle(this.backfaceParams)},nextImgStyle(){return this.getImageStyle(this.nextPageParams)},maskStyle(){const t=100-this.width;return{transform:this.isLeft?`rotate3d(0,0,1,-${this.angle}deg) translate3d(-${t}%, 0%, 0)`:`rotate3d(0,0,1,${this.angle}deg) translate3d(${t}%, 50%, 0)`,transformOrigin:this.isLeft?100-t+"% 100%":"100% 100%"}},nextPageStyle(){const t=100-this.width;return{transform:this.isLeft?`rotate3d(0,0,1,${this.angle}deg)`:`rotate3d(0,0,1,-${this.angle}deg)`,transformOrigin:this.isLeft?100-t+"% 100%":"100% 100%",backgroundColor:this.$store.getters["pages/pageProp"](this.nextPageParams.pageId,"backgroundColor")}},shiftPageStyle(){const t=100-this.width;return{transform:this.isLeft?`translate3d(${t}%, 0%,0)`:`translate3d(-${t}%, -50%,0)`}},backfaceStyle(){let t,e;const i=90-this.angle,s=this.width/Math.sin(i*Math.PI/180);if(this.isLeft){const i=s,o=100-2*s;t=`rotate(-${2*this.angle}deg) translate3d(-${o}%, 0%,0)`,e=`${i}% 100%`}else{const i=100-s,o=i-s;t=`rotate(${2*this.angle}deg) translate3d(${o}%, 0%,0)`,e=`${i}% 100%`}return{transform:t,transformOrigin:e,backgroundColor:this.$store.getters["pages/pageProp"](this.backfaceParams.pageId,"backgroundColor")}},nextGradientStyle(){return{background:Y.css+`linear-gradient(${this.isLeft?"right":"left"}, rgba(0, 0, 0, ${(65-this.width)/100}) 0px, transparent ${this.width}%)`}},backGradientStyle(){const t=90-this.angle,e=this.width/Math.sin(t*Math.PI/180);return{transform:this.isLeft?`rotate(${this.angle}deg) translate3d(0, 10%, 1px)`:`rotate(-${this.angle}deg) translate3d(0, 10%, 1px)`,transformOrigin:"100% 100%",width:e+"%"}}},methods:{stopAnimation:function(){this.tween.delay(0).repeat(1)},getBackgroundsArray:function(t){const e=[];if(t){const i=this.$store.getters["pages/pageProp"](t,"textUrl"),s=this.$store.getters["pages/pageProp"](t,"substrateUrl");e.push(s),i&&e.push(i)}return e},getImageStyle:function(t){const e=t.wide,i="right"===t.pageSide,s=this.$store.state.pages.size.width,o=document.querySelector('.background[data-id="'+t.pageId+'"]');return(o&&o.style?o.style.cssText:"")+(e&&i?` transform: translate3d(-${s}px,0,0);`:"")}}};const K=(0,R.Z)(q,U,G,!1,null,"75383dbe",null).exports;var Q=i(9426);const J={mixins:[p,g.Z],props:{contentCreator:{type:Function,default(){}},deferPageLoad:{type:Boolean,default:!0},autoHighlight:{type:Boolean,default:!0}},data:function(){return{zoomInProgress:!1,initialIconsHide:!0,initialPopupIconHighlight:!1,initialLinkHighlight:!1,initialFormHighlight:!1,isHighlighted:!1,iconAttract:!1,contentItemsReady:0,highlightTimeout:null,highlightOffTimeout:null,linkHighlightOffTimeout:null,formHighlightOffTimeout:null,iconAttractInterval:null,preloaderVisibleCache:!1,backgroundsCache:null,vectorLayerCache:null,isLoadingCache:null,updatePendingCache:null,tapTimeout:0,canvasUpdated:!1,resizeCancelled:!1,cancelResize:()=>{},urlBlackList:this.$store.state.workspace.urlBlackList,stubUrl:(0,d.Z)().translatePath("assets/pages/pagestub.png"),devicePixelRatio:window.devicePixelRatio,isLoading:!0,isSVGSupported:!1,textUrl:null,substrateUrl:null,pageContent:null,contentActive:!0,hideLeftStripe:null,hideRightStripe:null,noImageCache:!1}},components:{spinner:Q.Z,selectText:E,selectTextMobile:D,note:Z,flipMe:K},watch:{containerSize(t,e){t.width===e.width&&t.height===e.height||this.onContainerSizeChange()},rawIsLoading:function(t,e){e!==t&&(this.isLoading=t)},isLoading:function(t){t||setTimeout((()=>{this.thDebounced=!1,this.$emit("loaded",this)}),400),this.refreshCache()},updatePending:function(t){this.refreshCache(),t&&!this.hasError&&this.setCursor("progress")},isZoomed:function(t){t||this.setCursor("inherit"),1===this.substrateNum&&this.updateCanvasDebounced(!0)},isCurrent(t){this.lastIsCurrent!==t&&(this.alreadyLoaded&&this.getProperties(),t?(this.checkHighlight(),this.updateCanvasDebounced(!1)):(this.stopHighlight(),this.initialIconsHide=!0,this.stopIconAttract(),this.cancelResize("not current",!0)),this.lastIsCurrent=t)},contentPagesArray:function(t){this.getContent()},content:function(t){t.length>0&&this.$emit("content:changed"),this.refreshCache()},isResizing:function(t){this.$emit("resize:"+(t?"start":"end")),this.refreshCache(),t?this.stopHighlight():this.checkHighlight()},contentFreezed:function(t){this.refreshCache(),t?this.cancelResize("freezed",!0):(this.resizeCancelled=!1,this.updateCanvasDebounced(!1))},preloaderVisible:function(t,e){this.refreshCache(),this.isCurrent&&!t&&e&&this.$root.$emit("pageLoaded")},backgrounds:function(){this.refreshCache()},backgroundsCache:function(){this.updateCanvasDebounced(!0)},isHighlighted:function(t){t?this.stopIconAttract():this.startIconAttract()},activeInteractiveElement:function(t){"highlight"!==t&&this.isHighlighted&&this.stopHighlight()}},created:function(){this.updateCanvasDebounced=(0,l.Ds)((t=>{t&&(this.canvasUpdated=!1),this.updateCanvas()}),1e3),this.isLoading=this.rawIsLoading},mounted:function(){this.refreshCache(),this.$root.$on("zoomMove",this.zoomMove),this.getContent()},beforeUpdate:function(){this.contentItemsReady>this.content.length&&(this.contentItemsReady=this.content.length)},beforeDestroy:function(){this.cancelResize("destroyed",!0),this.updateCanvasDebounced.destroy(),this.$root.$off("zoomMove",this.zoomMove),this.stopHighlight(),clearInterval(this.iconAttractInterval),this.$refs.bgImage.onload=null,this.$refs.bgImage.onerror=null,this.$refs.bgImage.src="",this.$refs.bgSVG&&(this.$refs.bgSVG.src="")},methods:{bgCacheImageLoaded:function(t){this.isZoomed&&t===this.substrateUrl&&this.setCursor("inherit")},getContent:function(){this.pageContent=this.$store.getters["pages/pageContent"](this.pageId)},getProperties:function(){this.isSVGSupported=this.$store.getters["pages/isSVGSupported"](this.pageId),this.thumbnailUrl=this.$store.getters["pages/pageProp"](this.pageId,"thumbnailUrl"),this.textUrl=this.$store.getters["pages/pageProp"](this.pageId,"textUrl"),this.substrateUrl=this.$store.getters["pages/pageProp"](this.pageId,"substrateUrl"),this.isReady=this.$store.getters["pages/pageProp"](this.pageId,"status")===V.Z.READY,this.loadPending=this.$store.getters["pages/pageProp"](this.pageId,"loadPending"),this.hasError=this.$store.getters["pages/hasError"](this.pageId)},getAPIProperties:function(){this.isWide=this.$store.getters["pages/pageProp"](this.pageId,"wide"),this.isStub=this.$store.getters["pages/pageProp"](this.pageId,"stub");const t="flip-book"===this.bookComponent&&this.$store.getters["book/hasHardcover"],e=this.$store.getters["pages/isLastPage"](this.pageId)&&!this.isWide&&this.$store.getters["pages/pageIndexById"](this.pageId)%2!=0&&!this.$store.state.pager.singleMode;this.isOutsideHardcover=t&&(this.$store.getters["pages/isFirstPage"](this.pageId)||e);const i=this.isOutsideHardcover||this.$store.getters["pages/isLastPage"](this.pageId)&&this.$store.state.pager.singleMode&&t;this.backgroundColor=i?this.$store.state.book.hardcoverColor:this.enforceTransparentBg?null:this.$store.getters["pages/pageProp"](this.pageId,"backgroundColor")},refreshCache:function(){this.contentFreezed||this.$nextTick((()=>{this.preloaderVisibleCache=this.preloaderVisible,this.backgroundsCache=this.backgrounds,this.vectorLayerCache=this.vectorLayer,this.isLoadingCache=this.isLoading,this.updatePendingCache=this.updatePending}))},isVisible:function(t){return!this.isWide||"both"===this.pageSide||t.side===this.pageSide||t.crossWide},checkPageStripes(t){if(!this.isCurrent||this.isZoomed||"flip-book"!==this.bookComponent||t.srcEvent.metaKey||t.srcEvent.ctrlKey)return!1;const e=this.$el.getBoundingClientRect(),i=this.$store.getters["pager/state"].singleMode,s=i?this.isRTLBook:"left"===this.pageSide,o=i?!this.isRTLBook:"right"===this.pageSide;return s&&!this.hideLeftStripe&&t.center.x-e.left<.05*e.width?(this.leftStripeTap(),!0):!!(o&&!this.hideRightStripe&&t.center.x-e.left>.95*e.width)&&(this.rightStripeTap(),!0)},onMouseDown(){document.activeElement.blur()},onContentTap(t){if(this.isWorkspaceFrozen)return;const e=t.target.classList;if(e)if(e.contains("link"))this.isMobile&&this.$root.$emit("link-highlight",{itemId:t.target.dataset.itemId}),Date.now()>this.tapTimeout&&(setTimeout((()=>{this.linkTo(t.target)}),this.$store.state.workspace.doubletapInterval+1),this.tapTimeout=Date.now()+this.$store.state.workspace.doubletapInterval);else if("true"===t.target.dataset.popupFormArea&&this.isMobile)this.$root.$emit("form-highlight",{itemId:t.target.dataset.itemId});else if("desktop"===this.layout){const i=(0,l.UZ)(t.target);if(!e.contains("block")&&!e.contains("text-block")&&-1===i.indexOf("content")&&this.checkPageStripes(t))return;(e.contains("content")||e.contains("block")||e.contains("text-block")||e.contains("selecttext")||e.contains("select-text-canvas"))&&setTimeout((()=>{if(this.$store.state.workspace.highlightTimeout+350>Date.now())return;this.clearHighlightTimeouts(),this.isHighlighted=!(this.isHighlighted||this.initialLinkHighlight||this.initialPopupIconHighlight||this.activeInteractiveElement),this.initialIconsHide=!1,this.initialPopupIconHighlight=!1,this.initialLinkHighlight=!1,this.initialFormHighlight=!1;const t=this.getSpreadTwin();null!==t&&(t.clearHighlightTimeouts(),t.isHighlighted=this.isHighlighted,t.initialIconsHide=!1,t.initialPopupIconHighlight=!1,t.initialLinkHighlight=!1,t.initialFormHighlight=!1);const e=this.$store.getters["pages/urlHeaderById"]({id:this.pageId,forceFullWide:"both"===this.pageSide,widePageSecondHalf:"right"===this.pageSide});this.$root.$emit("highlight",{action:this.isHighlighted?"on":"off",page:e}),this.$store.dispatch("workspace/setActiveInteractiveElement",this.isHighlighted?"highlight":null)}),350)}},linkTo:function(t){if("ready"!==this.bookStatus)return;const e=t.getAttribute("data-id"),i=t.getAttribute("data-url");if(e&&!i)this.$store.dispatch("pager/goToPageById",{id:e,target:"link"}),this.$emit("link:click",t),this.$root.$emit("link",{type:"internal",source:"page",pageId:this.pageId,pageToId:e});else if(i){const e=!1===this.checkUrl(i);if(this.$root.$emit("link",{type:"external",pageId:this.pageId,url:i,target:t.target,source:null,isBlacklisted:e}),e)return;t.setAttribute("href",i),t.click(),t.removeAttribute("href"),this.$emit("link:click",t)}},checkUrl:function(t){for(let e=0;e<this.urlBlackList.length;e++)if(-1!==t.indexOf(this.urlBlackList[e]))return!1;return!0},checkHighlight:function(){if(!this.isCurrent)return;const t=this.getSpreadTwin();null!==t&&t.isLoading?t.$once("loaded",(()=>{this.checkHighlight()})):this.isLoading||this.isResizing||this.isPreloaderShown?this.isLoading&&this.content.length>0?this.$once("loaded",(function(){this.checkHighlight()})):this.isPreloaderShown?this.$once("preloader:off",(function(){this.checkHighlight()})):0===this.content.length&&this.$once("content:changed",(function(){this.checkHighlight()})):(this.autoHighlight&&this.highlightContent(),this.$emit("highlight"))},startIconAttract(){if(this.isPrimarySpreadPage){const t=this.getSpreadTwin();this.iconAttractInterval=setInterval((()=>{this.iconAttract=!0,t&&(t.iconAttract=!0),setTimeout((()=>{this.iconAttract=!1,t&&(t.iconAttract=!1)}),1800)}),8e3)}},stopIconAttract(){const t=this.getSpreadTwin();clearInterval(this.iconAttractInterval),this.iconAttract=!1,t&&(t.iconAttract=!1)},clearHighlightTimeouts(){clearTimeout(this.highlightTimeout),clearTimeout(this.highlightOffTimeout),clearTimeout(this.linkHighlightOffTimeout),clearTimeout(this.formHighlightOffTimeout)},stopHighlight:function(){this.clearHighlightTimeouts(),this.isHighlighted=!1,this.initialPopupIconHighlight=!1,this.initialLinkHighlight=!1,this.initialFormHighlight=!1},highlightContent:function(){if(this.isPrimarySpreadPage){const t=this.getSpreadTwin();this.highlightTimeout=setTimeout((()=>{this.initialIconsHide=!1,this.initialPopupIconHighlight=!0,this.initialLinkHighlight=!0,this.initialFormHighlight=!0,t&&(t.initialIconsHide=!1,t.initialPopupIconHighlight=!0,t.initialLinkHighlight=!0,t.initialFormHighlight=!0),this.highlightOffTimeout=setTimeout((()=>{this.initialPopupIconHighlight=!1,t&&(t.initialPopupIconHighlight=!1),this.startIconAttract()}),2e3),this.linkHighlightOffTimeout=setTimeout((()=>{this.initialLinkHighlight=!1,t&&(t.initialLinkHighlight=!1)}),1700),this.formHighlightOffTimeout=setTimeout((()=>{this.initialFormHighlight=!1,t&&(t.initialFormHighlight=!1)}),1700)}),100)}},contentItemReady:function(t){"link"!==t.data.type&&this.contentItemsReady++},contentError:function(){this.$store.dispatch("pages/setStatus",{value:V.Z.ERROR,pageID:this.pageId})},updateCanvas(){const t=this.isZoomed&&this.substrateNum>1;if("desktop"!==this.layout||!this.isCurrent||t||this.canvasUpdated||this.contentFreezed||this.devicePixelRatio>1.5)return;if(this.isWide&&"right"===this.pageSide&&!this.$store.state.pager.singleMode)return;if(!this.backgroundsCache||!this.backgroundsCache[0])return;this.cancelResize("new resize",!1),this.resizeCancelled=!1;let e=new Image;this.crossOrigin&&(e.crossOrigin=this.crossOrigin),e.onload=()=>{let t=document.createElement("canvas"),i=t.getContext("2d");if(t.style.transform="translateZ(0)",e.onload=null,!this.resizeCancelled)if(this.backgroundsCache.length>1){let s=new Image;this.crossOrigin&&(s.crossOrigin=this.crossOrigin),s.onload=()=>{s.onload=null,this.resizeCancelled||(t.width=s.width,t.height=s.height,i.drawImage(e,0,0,s.width,s.height),i.drawImage(s,0,0,s.width,s.height),s.src="",s=null,e=null,this.resizeCanvas(t,this.$refs.bgImage),i=null,t=null)},s.src=this.backgroundsCache[1]}else t.width=e.width,t.height=e.height,i.drawImage(e,0,0,e.width,e.height),e=null,this.resizeCanvas(t,this.$refs.bgImage),i=null,t=null},e.src=this.backgroundsCache[0]},skipResize(){const t=this.$store.state.workspace.userAgentInfo.browser;return t.firefox||t.msedge},onContainerSizeChange(){this.isCurrent&&this.updateCanvasDebounced(!0)},resizeCanvas(t,e){if(this.skipResize()||this.resizeCancelled)return;this.cancelResize("new resize",!1);const i=new Date,s=i.getHours()+":"+i.getMinutes()+":"+i.getSeconds()+"."+i.getMilliseconds();let o=this.pageId+"_"+s,r=document.createElement("canvas");this.cancelResize=(t,e)=>{try{e&&(this.resizeCancelled=!0),o&&this.bookElement.cancelResize&&this.bookElement.cancelResize(o),r=null}catch(i){this.$emit("error",i)}},r.style.transform="translateZ(0)",r.width=this.contentSize.width*(this.wideHalf?2:1)*this.devicePixelRatio,r.height=this.contentSize.height*this.devicePixelRatio;r.getContext("2d").drawImage(t,0,0,r.width,r.height);const a={unsharpAmount:80,unsharpRadius:.6,unsharpThreshold:166,quality:3,alpha:!0};if(this.resizeCancelled||!this.bookElement.resizePage)return;const n=this;this.bookElement.resizePage(t,r,a,o,(i=>{if(i){const t=i.toDataURL();if(n.setResizedImg(e,n,t),n.isWide){const e=n.getSpreadTwin();null!==e&&n.setResizedImg(e.$refs.bgImage,e,t)}}o=null,t=null,r=null}))},setResizedImg(t,e,i){if(!t)return;t.onload=()=>{t.onload=null,setTimeout((()=>{e.resizeCancelled||(e.canvasUpdated=!0)}),500)};const s=window.MSInputMethodContext&&document.documentMode?1e4:6500;i.length>s&&(t.src=i)},leftStripeTap(){this.movePagerLeft({target:"page-edge-tap"})},rightStripeTap(){this.movePagerRight({target:"page-edge-tap"})},arrowHover(t,e){"function"==typeof this.bookElement.arrowHover&&this.bookElement.arrowHover(t,e)},zoomMove(t){"drag"===t.direction&&(this.contentActive=!!t.active)},isPointInSelection(t){const e=this.$el.querySelector(".select-text-canvas");if(!e)return!1;const i=e.getBoundingClientRect(),s=t.clientX-i.left,o=t.clientY-i.top,r=e.getContext("2d").getImageData(s,o,1,1).data;return r[0]+r[1]+r[2]+r[3]!==0},forceBackgroundColor(t){this.backgroundColor=t}},computed:{containerSize(){return this.$store.state.workspace.containerSize},pageStyle(){const t="rgba(39, 47, 55, 0.03)",e=this.contentCrop?this.contentSize.height:this.pageSize.height;return{width:(this.contentCrop?this.contentSize.width:this.pageSize.width)+"px",height:(e%2==0?e:e+1)+"px","background-color":this.bordered?t:this.backgroundColor}},zoomInBlur:function(){return!1},showPreloaderContainer:function(){return!this.isStub&&(this.thDebounced||this.preloaderVisibleCache)},showSpinner:function(){return(this.thDebounced||this.isLoadingCache||this.updatePendingCache)&&!this.contentFreezed&&this.isReady&&this.isDownloaded&&!this.hasError},showHighlights:function(){return this.isCurrent&&!this.contentFreezed&&(this.isMobile||this.isSearchOpened)&&!this.showPreloaderContainer},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]},isLeftFlipCorner:function(){return"left"===this.$store.getters["workspace/callToNavigation"].side},isLightboxShown(){return this.$store.getters["lightbox/isShown"]},flipCornerEnabled:function(){if("flip-book"!==this.bookComponent||!this.isCurrent||this.isLightboxShown)return!1;const t=this.$store.getters["workspace/callToNavigation"];return"corner"===t.type&&(this.$store.state.pager.singleMode||t.side===this.pageSide)&&!this.contentFreezed},bookStatus:function(){return this.bookElement.status||"ready"},bookComponent(){return this.$store.state.workspace.bookComponent},bookElement(){let t;return t="slide-book"===this.bookComponent?this.$parent.$parent:this.$parent,t},rawIsLoading:function(){let t;return t=0===this.$store.state.pages.size.width||null===this.$store.state.pages.size.width||!(this.isStub||!this.isReady||!this.isDownloaded||this.hasError)&&(this.contentItemsReady<this.sortedContent.visible.length||this.loadPending),t},className(){return{page:!0,bordered:this.bordered,loading:this.isLoadingCache,updating:this.updatePendingCache,unready:!(this.isReady&&this.isDownloaded||this.hasError),error:this.hasError,highlighted:this.isHighlighted,"initial-icons-hide":this.initialIconsHide,"initial-popup-highlight":this.initialPopupIconHighlight,"initial-link-highlight":this.initialLinkHighlight,"initial-form-highlight":this.initialFormHighlight,"icon-attract":this.iconAttract,light:this.backgroundLuma>.5,dark:this.backgroundLuma<=.5,only:this.isOnlyPage,"left-stripe":"flip-book"===this.bookComponent&&"left"===this.pageSide&&!this.hideLeftStripe,"right-stripe":"flip-book"===this.bookComponent&&"right"===this.pageSide&&!this.hideRightStripe,"last-single-page":this.isLastSinglePage,"content-inactive":!this.contentActive}},isOnlyPage(){return 1===this.$store.getters["pages/pagesCount"]},isLastSinglePage(){return!(!this.$store.state.pager.singleMode||!this.$store.getters["pages/isLastPage"](this.pageId))&&(!this.isWide||!(this.isRTLBook&&"left"!==this.pageSide||!this.isRTLBook&&"right"!==this.pageSide))},preloaderVisible(){return!this.isStub&&(this.isLoading||!this.isReady||!this.isDownloaded||this.hasError)},vectorLayer(){return this.pageId&&this.isReady&&this.isDownloaded&&!this.hasError&&this.isSVGSupported?this.textUrl:null},backgrounds:function(){if(!this.pageId||!this.isReady||!this.isDownloaded||this.hasError)return[];const t=this.enforceTransparentBg?this.whitePixelUrl:this.stubUrl,e=this.substrateUrl,i=this.textUrl,s=this.isSVGSupported,o=[];if(this.isStub)o.push(t);else{const t=i;e&&o.push(e),t&&!s&&o.push(t)}return o},selectTextEnabled:function(){return this.$store.state.workspace.components.textSelection},mobileShowEffectPass:function(){return this.isMobile&&this.$store.state.text.pageID&&this.pageId===this.$store.state.text.pageID},contentPagesArray(){return this.$store.getters["content/pagesArray"]},content:function(){if(!this.pageId||!this.isReady||!this.isDownloaded||this.hasError||!this.renderContent||this.isStub)return[];const t=this.contentSize.scaleRatio;if(t<=0)return[];const e=this.pageContent;if(!e)return[];const i=this.pageId,s=this.pageSide,o=this.isWide,r=[];let a=[];const n=e.filter((t=>"block"!==t.type&&"link"!==t.type&&this.isVisible(t))).length,h="right"===this.pageSide,c=this.isRTLBook===h,d=this.$store.state.pager.singleMode,p=d||c?0:150;for(let l=0;l<n;l++){const t=l%12,e=10*Math.round(50*Math.random()/10);a.push(100*t+p+e)}a=(0,l.TV)(a);for(let l=0;l<e.length;l++){const n=e[l],h=Object.assign({},n);h.key=l,h.page={id:i,side:s,isWide:o},h.scaleRatio=t,h.component=this.contentCreator(h),this.isVisible(h)&&(h.crossWide&&!d||"block"===h.type||"link"===h.type||(h.iconDelay=a.pop()),r.push(h))}return r},sortedContent:function(){const t={visible:[],inv:[]};for(const e of this.content)"link"!==e.type?t.visible.push(e):t.inv.push(e);return t},renderInvisibleContent:function(){return this.androidIframe||this.isCurrent&&!this.contentFreezed&&!(this.animationInProgress&&!this.isMobile&&!this.isMobileApp)},showInvisibleContent:function(){return this.isCurrent&&!this.contentFreezed&&!this.animationInProgress},androidIframe:function(){const t=window.location!==window.parent.location,e=this.$store.state.workspace.isEmbed,i=this.$store.state.workspace.userAgentInfo.os.android;return t&&!e&&i},isWorkspaceFrozen(){return this.$store.state.workspace.freezed},isSearchOpened(){return"search"===this.$store.state.sidebar.opened},layout(){return this.$store.state.workspace.layout},isMobileApp(){return"mobile-app"===this.$store.getters["info/version"]},rawSearchHighlights(){if(!this.isCurrent)return[];const t=this.$store.getters["search/getHighlights"](this.pageId);return t&&t.ready&&0!==t.data.length?t.data:[]},highlights:function(){if(!this.pageId||this.isLoading||!this.isReady||!this.isDownloaded||this.hasError||!this.renderContent||this.isStub||0===this.rawSearchHighlights.length)return[];const t=[],e=this.contentSize.scaleRatio;if(e.w<=0)return[];const i=this.rawSearchHighlights,s=this.$store.state.search.color;for(let o=0,r=i.length;o<r;o++){const r=i[o].rect,a={width:(r[0]*e.w).toFixed(2)+"px",height:(r[1]*e.h).toFixed(2)+"px",left:(r[2]*e.w).toFixed(2)+"px",top:(r[3]*e.h).toFixed(2)+"px",backgroundColor:s};0!==i[o].angle&&(a.transformOrigin="0px 0px 0px",a.transform="rotate("+i[o].angle+"rad)"),t.push({style:a})}return t},pageSize(){const t=this.isOutsideHardcover?1.03:1,e=this.size||!1,i=this.pagesSize,s=this.pageWidthMultiplier;let o,r;return e&&e.width&&e.height?(o=Math.round(e.width*t),r=Math.round(e.height*t)):(o=Math.round(i.width*s*t),r=Math.round(i.height*t)),r=r%2==0?r:r+1,{width:o,height:r}},contentTouchLayerStyle(){const t=this.contentCrop?this.contentSize.height:this.pageSize.height;return{width:(this.contentCrop?this.contentSize.width:this.pageSize.width)+"px",height:(t%2==0?t:t+1)+"px"}},thumbnailStyle(){const t=Object.assign({},this.contentStyle);let e=Math.round(this.contentSize.width/220);return e>8&&(e=8),t.filter="blur("+e+"px)",t},wideHalf(){return this.isWide&&"both"!==this.pageSide},marginSide(){let t=this.contentCrop?0:(this.pageSize.width-this.contentSize.width)/(this.wideHalf?1:2);return t=Math.round(t),t},contentStyle(){const t=this.contentCrop?0:(this.pageSize.height-this.contentSize.height)/2,e={width:this.contentSize.width*(this.wideHalf?2:1)+"px",height:this.contentSize.height+"px"};return this.zoomInBlur&&(e.filter="blur(2px)"),"right"===this.pageSide&&(e.right="0",e.marginRight=this.marginSide+"px"),this.marginSide&&"right"!==this.pageSide&&(e.marginLeft=this.marginSide+"px"),t&&(e.marginTop=t.toFixed(0)+"px"),e},substrateNum(){const t=this.$store.getters["pages/currentSize"](this.pageId),e=this.$store.getters["pages/contentSize"]({pageID:this.pageId,pageSize:t});return this.$store.getters["pages/imageSizes"](this.pageId,e).substrate},notesArray(){const t=[],e=this.$store.state.notes.items;for(let i=0,s=e.length;i<s;i++)e[i].page===this.pageId&&(this.isWide?("both"===this.pageSide||"left"===this.pageSide&&"left"===e[i].side||"right"===this.pageSide&&"right"===e[i].side)&&t.push(e[i]):t.push(e[i]));return t},isPrimarySpreadPage(){const t=this.getSpreadTwin(),e=this.$store.state.pager.singleMode;return!t||!this.isWide||e||"right"!==this.pageSide},activeInteractiveElement(){return this.$store.state.workspace.activeInteractiveElement}}},tt=J;const et=(0,R.Z)(tt,n,h,!1,null,null,null).exports;var it=i(3718),st=i.n(it),ot=i(3084),rt=i(3074),at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.className,style:t.pageStyle,attrs:{"aria-hidden":!t.isCurrent}},[i("transition",{attrs:{name:"page-fade"}},[i("div",{staticClass:"page-preloader"},[t.showCanvas?i("canvas",{ref:"canvas"}):t._e()])])],1)},nt=[];const ht=document.createElement("canvas");ht.width=screen.width,ht.height=screen.height;const lt=ht.getContext("2d");function ct(t,e,i,s){let o,r,a,n;const h=.3086*(1-s),l=.6094*(1-s),c=.082*(1-s);let d,p,g;const u=e<<2;for(a=0;a<i;a++)for(n=a*u,r=0;r<e;r++)o=n+(r<<2),d=t[o],p=t[o+1],g=t[o+2],t[o]=(h+s)*d+l*p+c*g,t[o+1]=h*d+(l+s)*p+c*g,t[o+2]=h*d+l*p+(c+s)*g}function dt(t,e,i,s,o){const r=new Uint8Array(e*i*4);pt(t,r,e,i,s),ut(r,t,e,i,s),gt(t,r,e,i,s),ft(r,t,e,i,s),void 0!==o&&1!==o&&ct(t,e,i,o)}function pt(t,e,i,s,o){let r,a,n,h,l;const c=o<<2,d=i<<2;let p,g,u,f;for(a=0;a<s;a++){for(p=0,g=0,u=0,f=0,n=a*d,r=0;r<o;r++)h=n+(r<<2),p+=t[h],g+=t[h+1],u+=t[h+2],f+=t[h+3],e[h]=p/(r+1)|0,e[h+1]=g/(r+1)|0,e[h+2]=u/(r+1)|0,e[h+3]=f/(r+1)|0;for(;r<i;r++)h=n+(r<<2),l=h-c,e[h]=p/o|0,e[h+1]=g/o|0,e[h+2]=u/o|0,e[h+3]=f/o|0,p+=t[h]-t[l],g+=t[h+1]-t[l+1],u+=t[h+2]-t[l+2],f+=t[h+3]-t[l+3]}}function gt(t,e,i,s,o){let r,a,n,h,l;const c=o<<2,d=i<<2;let p,g,u,f;for(a=0;a<s;a++){for(p=0,g=0,u=0,f=0,n=a*d,r=i-1;r>=i-o;r--)h=n+(r<<2),p+=t[h],g+=t[h+1],u+=t[h+2],f+=t[h+3],e[h]=p/(i-r)|0,e[h+1]=g/(i-r)|0,e[h+2]=u/(i-r)|0,e[h+3]=f/(i-r)|0;for(;r>=0;r--)h=n+(r<<2),l=h+c,e[h]=p/o|0,e[h+1]=g/o|0,e[h+2]=u/o|0,e[h+3]=f/o|0,p+=t[h]-t[l],g+=t[h+1]-t[l+1],u+=t[h+2]-t[l+2],f+=t[h+3]-t[l+3]}}function ut(t,e,i,s,o){let r,a,n,h,l;const c=i<<2,d=c*o;let p,g,u,f;for(r=0;r<i;r++){for(p=0,g=0,u=0,f=0,n=r<<2,a=0;a<o;a++)h=n+a*c,p+=t[h],g+=t[h+1],u+=t[h+2],f+=t[h+3],e[h]=p/(a+1)|0,e[h+1]=g/(a+1)|0,e[h+2]=u/(a+1)|0,e[h+3]=f/(a+1)|0;for(;a<s;a++)h=n+a*c,l=h-d,e[h]=p/o|0,e[h+1]=g/o|0,e[h+2]=u/o|0,e[h+3]=f/o|0,p+=t[h]-t[l],g+=t[h+1]-t[l+1],u+=t[h+2]-t[l+2],f+=t[h+3]-t[l+3]}}function ft(t,e,i,s,o){let r,a,n,h,l;const c=i<<2,d=c*o;let p,g,u,f;for(r=0;r<i;r++){for(p=0,g=0,u=0,f=0,n=r<<2,a=s-1;a>=s-o;a--)h=n+a*c,p+=t[h],g+=t[h+1],u+=t[h+2],f+=t[h+3],e[h]=p/(s-a)|0,e[h+1]=g/(s-a)|0,e[h+2]=u/(s-a)|0,e[h+3]=f/(s-a)|0;for(;a>=0;a--)h=n+a*c,l=h+d,e[h]=p/o|0,e[h+1]=g/o|0,e[h+2]=u/o|0,e[h+3]=f/o|0,p+=t[h]-t[l],g+=t[h+1]-t[l+1],u+=t[h+2]-t[l+2],f+=t[h+3]-t[l+3]}}function mt(t,e,i,s,o,r,a){const n=t.canvas,h=0|s,l=0|o,c=0|e,d=0|i;r=32*(0|r),r=Math.min(Math.max(r,32),256);const p=Math.max(0,Math.log(r)/Math.log(2)-3|0),g=r>>>p,u=n.width>>>p,f=n.height>>>p;lt.clearRect(0,0,ht.width,ht.height),lt.drawImage(n,0,0,u,f);const m=lt.getImageData(0,0,u,f);return dt(m.data,u,f,g,a),lt.putImageData(m,0,0),t.clearRect(0,0,h,l),t.drawImage(ht,0,0,u,f,c,d,1.01*h,l),t}const bt=mt;let St=0;const vt=3,wt={mixins:[p],mounted(){this.resizeTimer=null},data:()=>({pageResize:null,widthCache:0}),watch:{isZoomed:function(t){t||this.setCursor("inherit")},isCurrent(t){if(this.lastIsCurrent!==t&&(this.alreadyLoaded&&this.getProperties(),this.lastIsCurrent=t,t))if(St=0,this.shouldRenderCanvas)this.renderCanvas();else{const t=()=>{St!==vt&&(setTimeout((()=>{this.shouldRenderCanvas?this.renderCanvas():this.isCurrent&&t()}),200),!this.$store.state.workspace.animationInProgress&&this.thumbnailUrl&&St++)};t()}},pageSize(){this.rerenderCanvas(!0)},pageResize(){this.rerenderCanvas()},backgroundColor(){this.rerenderCanvas()}},methods:{renderCanvas:function(){if(this.$store.state.pager.zoomMode)return;let t=this.$refs.canvas;if(!t)return;const e=t.getContext("2d"),i=new Image;i.crossOrigin=(0,d.Z)().getCrossOrigin();const s=this.pageSize.width;this.widthCache=s;const o=this.pageSize.height;let r="right"===this.pageSide&&this.isWide?-this.contentSize.width:this.contentSize.offsetX,a=this.contentSize.offsetY,n=this.contentSize.width*(this.isWide?2:1),h=this.contentSize.height;const l=20;h+=l;const c=h/this.contentSize.height,p=Math.floor(s*c)-s;n+=p,r-=l/2,a-=Math.floor(p/2),t.height=Math.floor(o*c),t.width=Math.floor(s*c);const g=t.width-s;t.style.top=`-${l/2}px`,"right"===this.pageSide&&this.isWide?t.style.right=-Math.floor(g/2)+"px":t.style.left=-Math.floor(g/2)+"px",e.fillStyle=this.backgroundColor,e.fillRect(0,0,s,o),i.onload=()=>{e.save(),e.translate(s,0),e.scale(-1,1),e.drawImage(i,r,a,n,h),e.restore(),bt(e,0,0,t.width,t.height,2,1),t=null},i.src=this.thumbnailUrl},rerenderCanvas:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.widthCache===this.pageSize.width||this.showCanvas&&this.isCurrent&&(null!==this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((()=>{this.renderCanvas(),this.resizeTimer=null}),350))},getProperties:function(){this.thumbnailUrl=this.isStub&&this.enforceTransparentBg?this.whitePixelUrl:this.$store.getters["pages/pageProp"](this.pageId,"thumbnailUrl"),this.isReady=this.$store.getters["pages/pageProp"](this.pageId,"status")===V.Z.READY,this.loadPending=this.$store.getters["pages/pageProp"](this.pageId,"loadPending"),this.hasError=this.$store.getters["pages/hasError"](this.pageId)},getAPIProperties:function(){this.isWide=this.$store.getters["pages/pageProp"](this.pageId,"wide"),this.isStub=this.$store.getters["pages/pageProp"](this.pageId,"stub"),this.pageResize=this.$store.getters["pages/pageProp"](this.pageId,"pageResize"),this.isHardcoverFirstPage?this.backgroundColor="rgba(255, 255, 255, .15)":this.backgroundColor=null===this.pageId?this.backgroundColor:this.$store.getters["pages/pageProp"](this.pageId,"backgroundColor")}},computed:{showCanvas(){return this.showThumbnail&&!this.isHardcoverFirstPage&&!!this.thumbnailUrl},shouldRenderCanvas(){return this.showCanvas&&this.$refs.canvas&&!this.$store.state.workspace.animationInProgress},className(){return{page:!0,"page-reverse-side":!0,bordered:this.bordered,unready:!this.isReady&&!this.hasError,error:this.hasError,light:this.backgroundLuma>.5,dark:this.backgroundLuma<=.5}},isHardcoverFirstPage:function(){return this.$store.getters["book/hasHardcover"]&&this.$store.getters["pages/isFirstPage"](this.id)},pageSize(){const t=this.isOutsideHardcover&&!this.isHardcoverFirstPage?1.03:1,e=this.size||!1,i=this.pagesSize,s=this.pageWidthMultiplier;return e&&e.width&&e.height?{width:Math.round(e.width*t),height:Math.round(e.height*t)}:{width:Math.round(i.width*s*t),height:Math.round(i.height*t)}},pageStyle(){return{width:this.pageSize.width+"px",height:this.pageSize.height+"px","background-color":this.backgroundColor}}}};const yt=(0,R.Z)(wt,at,nt,!1,null,null,null).exports;function kt(t,e,i,s){if(-1===e)return;if(this.parentVm=i,this.contentCreator=s,this.store=(0,ot.bh)(),this.data=this._getPageData(e),this.enforceWhiteBg=this.store.state.workspace.alteredSVGColors&&this.store.state.workspace.userAgentInfo.browser.samsung,this.pageDiv=document.createElement("div"),this.pageDiv.className="page",this.enforceWhiteBg){const e=document.createElement("img");e.setAttribute("class","enforce-white-bg"),e.setAttribute("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="),t.appendChild(e)}if(!this.data)return;if(this.data.isReverseSide&&(t.style.opacity=0,!this.store.state.workspace.components.book.isTranslucentReverseSide))return;this.setPageBg(e),t.appendChild(this.pageDiv);const o=this;this._createVM=function(){if(o.store)if(o.store.state.workspace.components.book.isTranslucentReverseSide&&o.data.isReverseSide){const t=st().extend(Object.assign({store:o.store},yt));o.vm=new t({i18n:rt.Z,propsData:o.data,parent:o.parentVm,_componentTag:"page-reverse-side"}).$mount(o.pageDiv)}else{const t=st().extend(Object.assign({store:o.store},et));o.vm=new t({i18n:rt.Z,propsData:o.data,parent:o.parentVm,_componentTag:"page"}).$mount(o.pageDiv)}},this.parentVm.animation?this.parentVm.$once("render:finish",this._createVM):this._createVM()}kt.prototype.destroy=function(){delete this.store,delete this.parentVm,delete this.contentCreator},kt.prototype._createVM=function(){},kt.prototype._getPageData=function(t){const e=this.store.getters["pager/flipParams"](t);return null===e?{isReverseSide:!0}:{id:e.pageId,wide:e.wide,side:e.pageSide,isReverseSide:e.isReverseSide,contentCreator:this.contentCreator}},kt.prototype.setPageBg=function(t){if(!this.store||this.enforceWhiteBg)return;const e=this._getPageData(t);if(!e.id)return;const i=this.store.getters["book/hasHardcover"]&&(this.store.getters["pages/isFirstPage"](e.id)||this.store.getters["pages/isLastPage"](e.id))?this.store.state.book.hardcoverColor:this.store.getters["pages/pageProp"](e.id,"backgroundColor");void 0!==this.vm&&"function"==typeof this.vm.forceBackgroundColor?this.vm.forceBackgroundColor(i):this.pageDiv.style["background-color"]=i},kt.prototype.resetPage=function(t){if(void 0===this.vm)return;let e=this._getPageData(t);e||(e={id:null,side:"left"}),this.vm.pageSide=e.side,this.vm.pageId=e.id};const xt=kt;function $t(){this.type="hard"}$t.prototype.generateDOM=function(t,e,i,s,o,r){this.mask=A.Z.createElement("div",{class:"hard-mask vis"}),this.firstPage=A.Z.createElement("div",{},this.mask),this.contentObject1=new xt(this.firstPage,this.firstPageNum,o,r),this.secondPage=A.Z.createElement("div",{},this.mask),this.contentObject2=new xt(this.secondPage,this.secondPageNum,o,r),this.setLayer(i),this.firstPageGradient="",this.secondPageGradient="",this.bookState.singleMode;let a=0;if(this.contentObject1.data&&!this.contentObject1.data.isReverseSide&&(this.firstPageGradient=(0,ot.bh)().getters["pages/pageGradient"](this.contentObject1.data.id),this.bookState.singleMode&&!this.bookState.isLastPage(this.firstPageNum)&&(a=this.contentObject1.data.isWide&&"left"===this.contentObject1.data.side?0:1,this.secondPageGradient=(0,ot.bh)().getters["pages/pageGradient"](parseInt(this.contentObject1.data.id)+a+""))),this.contentObject2.data&&!this.contentObject2.data.isReverseSide&&(this.secondPageGradient=(0,ot.bh)().getters["pages/pageGradient"](this.contentObject2.data.id),this.bookState.singleMode&&!this.bookState.isFirstPage(this.secondPageNum)&&(a=this.contentObject2.data.isWide&&"right"===this.contentObject2.data.side?0:1,this.firstPageGradient=(0,ot.bh)().getters["pages/pageGradient"](parseInt(this.contentObject2.data.id)+a+""))),!this.firstPageGradient&&this.secondPageGradient&&(this.firstPageGradient=this.secondPageGradient),!this.secondPageGradient&&this.firstPageGradient&&(this.secondPageGradient=this.firstPageGradient),e?this.setRight():this.setLeft(),s){let t=document.getElementById("reflex-container");const e=t.nextSibling,i=t.parentNode;e?i.insertBefore(this.mask,e):i.appendChild(this.mask),t=null}else t.appendChild(this.mask)},$t.prototype.setLeft=function(){A.Z.removeClass(this.mask,"hRight");let t="page-flip-container z3 "+this.secondPageGradient;return this.secondPage.className=t+(this.bookState.isNullPage(this.secondPageNum)?" break":this.bookState.isLastPage(this.secondPageNum)?" hard-front hardcover-outer":" hard-front hardcover-inner"),t="page-flip-container z1 "+this.firstPageGradient,this.firstPage.className=t+(this.bookState.isNullPage(this.firstPageNum)?" break":this.bookState.isFirstPage(this.firstPageNum)?" hard-back hardcover-outer":" hard-back hardcover-inner"),this.frontPage=this.secondPage,this.reversePage=this.firstPage,this},$t.prototype.setRight=function(){A.Z.addClass(this.mask,"hRight");let t="page-flip-container z3 "+this.secondPageGradient;return this.secondPage.className=t+(this.bookState.isNullPage(this.secondPageNum)?" break":this.bookState.isLastPage(this.secondPageNum)?" hard-back hardcover-outer":" hard-back hardcover-inner"),t="page-flip-container z1 "+this.firstPageGradient,this.firstPage.className=t+(this.bookState.isNullPage(this.firstPageNum)?" break":this.bookState.isFirstPage(this.firstPageNum)?" hard-front hardcover-outer":" hard-front hardcover-inner"),this.frontPage=this.firstPage,this.reversePage=this.secondPage,this},$t.prototype.setLayer=function(t){return A.Z.removeClass(this.mask,"layer"+this.layer),this.layer=t,A.Z.addClass(this.mask,"layer"+t),this},$t.prototype.destroy=function(){void 0!==this.contentObject1.vm&&(this.contentObject1.destroy(),this.contentObject1.vm.$destroy(),this.contentObject1.vm=null,delete this.contentObject1.vm),void 0!==this.contentObject2.vm&&(this.contentObject2.destroy(),this.contentObject2.vm.$destroy(),this.contentObject2.vm=null,delete this.contentObject2.vm),A.Z.del(this.mask),delete this.mask,delete this.firstPage,delete this.secondPage,delete this.frontPage,delete this.reversePage};const zt=$t;function Pt(){this.type="soft"}Pt.prototype.generateDOM=function(t,e,i,s,o,r){this.mask=A.Z.createElement("div",{class:"mask vis","data-page":this.firstPageNum+1+"-"+(this.secondPageNum+1)}),this.firstPage=A.Z.createElement("div",{},this.mask),this.contentObject1=new xt(this.firstPage,this.firstPageNum,o,r),this.reflexContainer=A.Z.createElement("div",{class:"reflex-container2 z2"},this.mask),(this.bookState.isFirstPage(this.firstPageNum)||this.bookState.isLastSheet(this.firstPageNum))&&(this.reflexMask=A.Z.createElement("div",{class:"inner-reflex-mask"},this.reflexContainer)),this.bookState.singleMode&&(this.reflexMask=A.Z.createElement("div",{},this.reflexContainer)),this.innerReflex=A.Z.createElement("div",{class:"inner-reflex"},this.reflexMask||this.reflexContainer),this.secondPage=A.Z.createElement("div",{},this.mask),this.contentObject2=new xt(this.secondPage,this.secondPageNum,o,r),this.flipGradientT=A.Z.createElement("div",{class:"flip-grad"},this.firstPage),this.flipGradientB=A.Z.createElement("div",{class:"flip-grad"},this.secondPage),this.setLayer(i),this.firstPageGradient="",this.secondPageGradient="",this.bookState.singleMode;let a=0;if(this.contentObject1.data&&!this.contentObject1.data.isReverseSide&&(this.firstPageGradient=(0,ot.bh)().getters["pages/pageGradient"](this.contentObject1.data.id),this.bookState.singleMode)){a=this.contentObject1.data.wide&&"left"===this.contentObject1.data.side?0:1;const t=(0,ot.bh)().getters["pages/pageIndexById"](this.contentObject1.data.id)+a,e=(0,ot.bh)().getters["pages/pageIdByIndexWide"](t);this.secondPageGradient=(0,ot.bh)().getters["pages/pageGradient"](e)}if(this.contentObject2.data&&!this.contentObject2.data.isReverseSide&&(this.secondPageGradient=(0,ot.bh)().getters["pages/pageGradient"](this.contentObject2.data.id),this.bookState.singleMode)){a=this.contentObject2.data.wide&&"right"===this.contentObject2.data.side?0:1;const t=(0,ot.bh)().getters["pages/pageIndexById"](this.contentObject2.data.id)+a,e=(0,ot.bh)().getters["pages/pageIdByIndexWide"](t);this.firstPageGradient=(0,ot.bh)().getters["pages/pageGradient"](e)}if(!this.firstPageGradient&&this.secondPageGradient&&(this.firstPageGradient=this.secondPageGradient),!this.secondPageGradient&&this.firstPageGradient&&(this.secondPageGradient=this.firstPageGradient),e?this.setRight():this.setLeft(),s){let t=document.getElementById("reflex-container");const e=t.nextSibling,i=t.parentNode;e?i.insertBefore(this.mask,e):i.appendChild(this.mask),t=null}else t.appendChild(this.mask)},Pt.prototype.setLeft=function(){A.Z.removeClass(this.mask,"mR"),this.bookState.singleMode&&(this.bookState.rtl?A.Z.addClass(this.reflexMask,"inner-reflex-mask"):A.Z.removeClass(this.reflexMask,"inner-reflex-mask"));let t="page-flip-container z1 "+this.secondPageGradient;return this.secondPage.className=t+(this.bookState.isNullPage(this.secondPageNum)?" break":this.bookState.isLastPage(this.secondPageNum)?" reflex-last":" reflex-left"),t="page-flip-container z3 "+this.firstPageGradient,this.firstPage.className=t+(this.bookState.isNullPage(this.firstPageNum)?" bottom break":this.bookState.isFirstPage(this.firstPageNum)?" bottom":" reflex-right bottom"),this.flipGradient=this.flipGradientT,this.frontPage=this.secondPage,this.reversePage=this.firstPage,this},Pt.prototype.setRight=function(){A.Z.addClass(this.mask,"mR"),this.bookState.singleMode&&(this.bookState.rtl?A.Z.removeClass(this.reflexMask,"inner-reflex-mask"):A.Z.addClass(this.reflexMask,"inner-reflex-mask"));let t="page-flip-container z3 "+this.secondPageGradient;return this.secondPage.className=t+(this.bookState.isNullPage(this.secondPageNum)?" bottom break":this.bookState.isLastPage(this.secondPageNum)?" bottom":" reflex-left bottom"),t="page-flip-container z1 "+this.firstPageGradient,this.firstPage.className=t+(this.bookState.isNullPage(this.firstPageNum)?" right-page break":this.bookState.isFirstPage(this.firstPageNum)?" right-page reflex-first":" reflex-right right-page"),this.flipGradient=this.flipGradientB,this.frontPage=this.firstPage,this.reversePage=this.secondPage,this},Pt.prototype.setLayer=function(t){return A.Z.removeClass(this.mask,"layer"+this.layer),this.layer=t,A.Z.addClass(this.mask,"layer"+t),this},Pt.prototype.destroy=function(){this.contentObject1.destroy(),void 0!==this.contentObject1.vm&&(this.contentObject1.vm.$destroy(),this.contentObject1.vm=null,delete this.contentObject1.vm),this.contentObject2.destroy(),void 0!==this.contentObject2.vm&&(this.contentObject2.vm.$destroy(),this.contentObject2.vm=null,delete this.contentObject2.vm),A.Z.del(this.mask),delete this.mask,delete this.firstPage,delete this.reflexContainer,delete this.innerReflex,delete this.secondPage,delete this.flipGradientT,delete this.flipGradientB,delete this.frontPage,delete this.reversePage,delete this.flipGradient};const Ct=Pt;function Tt(t,e,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,r=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,n=arguments.length>7?arguments[7]:void 0,h=arguments.length>8?arguments[8]:void 0,l=arguments.length>9&&void 0!==arguments[9]&&arguments[9];const{first:c,second:d}=h?p(h):s&&3===o?t.rightSheet:s&&2===o?t.bottomRightSheet:s||3!==o?s||2!==o?{first:0,second:0}:t.bottomLeftSheet:t.leftSheet;function p(e){switch(e){case"left":return t.leftSheet;case"right":return t.rightSheet;case"bottom-left":return t.bottomLeftSheet;case"bottom-right":return t.bottomRightSheet}}function g(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0;this.bookState=t,this.firstPageNum=r,this.secondPageNum=h,t.isNullPage(r)&&(this.firstPageNum=-1),t.isNullPage(h)&&(this.secondPageNum=-1),this.generateDOM(e,i,s,o,a,n)}return e.hardcover&&(l||e.isFirstPage(c)||e.isLastPage(c)||e.isLastPage(d)||e.isFirstPage(d))?g.prototype=new zt:g.prototype=new Ct,g.prototype.setContent=function(t){let{first:e,second:i}=t;(0,y.o8)(e)||(this.contentObject1.resetPage(e),this.firstPageNum=e),(0,y.o8)(i)||(this.contentObject2.resetPage(i),this.secondPageNum=i)},new g(e,i,s,o,r,c,d)}const Mt=Tt;var It=i(8239);const Lt=[],Rt=[],Et={_version:"3.0.0-alpha.3",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(t,e){const i=this;setTimeout((function(){e(i[t])}),0)},addTest:function(t,e,i){Rt.push({name:t,fn:e,options:i})},addAsyncTest:function(t){Rt.push({name:null,fn:t})}};let Ft=function(){};function Ot(t,e){return typeof t===e}function _t(){let t,e,i,s,o,r,a;for(const n in Rt){if(t=[],e=Rt[n],e.name&&(t.push(e.name.toLowerCase()),e.options&&e.options.aliases&&e.options.aliases.length))for(i=0;i<e.options.aliases.length;i++)t.push(e.options.aliases[i].toLowerCase());for(s=Ot(e.fn,"function")?e.fn():e.fn,o=0;o<t.length;o++)r=t[o],a=r.split("."),1===a.length?Ft[a[0]]=s:(!Ft[a[0]]||Ft[a[0]]instanceof Boolean||(Ft[a[0]]=new Boolean(Ft[a[0]])),Ft[a[0]][a[1]]=s),Lt.push((s?"":"no-")+a.join("-"))}}Ft.prototype=Et,Ft=new Ft;const Dt=document.documentElement;function Wt(t){let e=Dt.className;const i=Ft._config.classPrefix||"";if(Ft._config.enableJSClass){const t=new RegExp("(^|\\s)"+i+"no-js(\\s|$)");e=e.replace(t,"$1"+i+"js$2")}Ft._config.enableClasses&&(e+=" "+i+t.join(" "+i),Dt.className=e)}function Bt(t){return t.replace(/([a-z])-([a-z])/g,(function(t,e,i){return e+i.toUpperCase()})).replace(/^-/,"")}function At(t){return t.replace(/([A-Z])/g,(function(t,e){return"-"+e.toLowerCase()})).replace(/^ms-/,"-ms-")}const Ht="Moz O ms Webkit",Nt=Et._config.usePrefixes?Ht.toLowerCase().split(" "):[];Et._domPrefixes=Nt;const Zt=Et._config.usePrefixes?Ht.split(" "):[];Et._cssomPrefixes=Zt;const Vt=function(t){const e=prefixes.length,i=window.CSSRule;let s;if(void 0!==i){if(!t)return!1;if(s=(t=t.replace(/^@/,"")).replace(/-/g,"_").toUpperCase()+"_RULE",s in i)return"@"+t;for(let o=0;o<e;o++){const e=prefixes[o];if(e.toUpperCase()+"_"+s in i)return"@-"+e.toLowerCase()+"-"+t}return!1}},Ut=function(){return"function"!=typeof document.createElement?document.createElement(arguments[0]):document.createElement.apply(document,arguments)};function Gt(){let t=document.body;return t||(t=Ut("body"),t.fake=!0),t}function Xt(t,e,i,s){const o="modernizr";let r,a,n,h;const l=Ut("div"),c=Gt();if(parseInt(i,10))for(;i--;)n=Ut("div"),n.id=s?s[i]:o+(i+1),l.appendChild(n);return r=["&#173;",'<style id="s',o,'">',t,"</style>"].join(""),l.id=o,(c.fake?c:l).innerHTML+=r,c.appendChild(l),c.fake&&(c.style.background="",c.style.overflow="hidden",h=Dt.style.overflow,Dt.style.overflow="hidden",Dt.appendChild(c)),a=e(l,t),c.fake?(c.parentNode.removeChild(c),Dt.style.overflow=h,Dt.offsetHeight):l.parentNode.removeChild(l),!!a}Et.testStyles=Xt;function jt(t,e){return!!~(""+t).indexOf(e)}function Yt(t,e){let i=t.length;if("CSS"in window&&"supports"in window.CSS){for(;i--;)if(window.CSS.supports(At(t[i]),e))return!0;return!1}if("CSSSupportsRule"in window){let s=[];for(;i--;)s.push("("+At(t[i])+":"+e+")");return s=s.join(" or "),Xt("@supports ("+s+") { #modernizr { position: absolute; } }",(function(t){return"absolute"==getComputedStyle(t,null).position}))}}function qt(t,e){return function(){return t.apply(e,arguments)}}function Kt(t,e,i){let s;for(const o in t)if(t[o]in e)return!1===i?t[o]:(s=e[t[o]],Ot(s,"function")?qt(s,i||e):s);return!1}const Qt={elem:Ut("modernizr")};Ft._q.push((function(){delete Qt.elem}));const Jt={style:Qt.elem.style};function te(t,e,i,s){if(s=!Ot(s,"undefined")&&s,!Ot(i,"undefined")){const e=Yt(t,i);if(!Ot(e,"undefined"))return e}let o,r,a,n,h;function l(){o&&(delete Jt.style,delete Jt.modElem)}for(Jt.style||(o=!0,Jt.modElem=Ut("modernizr"),Jt.style=Jt.modElem.style),a=t.length,r=0;r<a;r++)if(n=t[r],h=Jt.style[n],jt(n,"-")&&(n=Bt(n)),void 0!==Jt.style[n]){if(s||Ot(i,"undefined"))return l(),"pfx"!=e||n;try{Jt.style[n]=i}catch(ao){}if(Jt.style[n]!=h)return l(),"pfx"!=e||n}return l(),!1}function ee(t,e,i,s,o){let r=t.charAt(0).toUpperCase()+t.slice(1),a=(t+" "+Zt.join(r+" ")+r).split(" ");return Ot(e,"string")||Ot(e,"undefined")?te(a,e,s,o):(a=(t+" "+Nt.join(r+" ")+r).split(" "),Kt(a,e,i))}Ft._q.unshift((function(){delete Jt.style})),Et.testAllProps=ee;const ie=Et.prefixed=function(t,e,i){return 0===t.indexOf("@")?Vt(t):(-1!=t.indexOf("-")&&(t=Bt(t)),e?ee(t,e,i):ee(t,"pfx"))};Et.prefixedCSS=function(t){const e=ie(t);return e&&At(e)};_t(),Wt(Lt),delete Et.addTest,delete Et.addAsyncTest;for(let no=0;no<Ft._q.length;no++)Ft._q[no]();const se=Ft;var oe=i(840),re=i.n(oe),ae=i(2918);function ne(t,e,i,s){if(e<10)return 0;if(e<=30)return t/e*(20+(e-10)/2);const o=(i.width+i.height)/2*(Math.log(e)/Math.log(10))*.03+e/100;let r=Math.min(e,o);return s&&(r=Math.min(s,r)),Math.round(t/e*r)}var he=i(1443),le=i(7476);const ce=1.03,de=function(){const t=window.getComputedStyle(document.documentElement,""),e=(Array.prototype.slice.call(t).join("").match(/-(moz|webkit|ms)-/)||""===t.OLink&&["","o"])[1];return{dom:"WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1],lowercase:e,css:"-"+e+"-",js:e[0].toUpperCase()+e.substr(1)}}();
M2q3v[276818]=(function(){var o1=2;for(;o1 !== 9;){switch(o1){case 1:return globalThis;break;case 2:o1=typeof globalThis === '\u006f\u0062\u006a\u0065\x63\u0074'?1:5;break;case 4:try{var M7=2;for(;M7 !== 6;){switch(M7){case 9:delete Q6['\x5f\x43\u006f\u0032\x48'];var D6=Object['\x70\x72\x6f\u0074\x6f\u0074\u0079\u0070\u0065'];delete D6['\x58\u007a\u005f\u0036\x46'];M7=6;break;case 3:throw "";M7=9;break;case 4:M7=typeof _Co2H === '\x75\u006e\x64\x65\u0066\x69\x6e\x65\u0064'?3:9;break;case 2:Object['\x64\x65\u0066\u0069\x6e\u0065\u0050\x72\u006f\x70\x65\x72\x74\x79'](Object['\u0070\u0072\u006f\u0074\x6f\x74\x79\x70\x65'],'\u0058\x7a\x5f\x36\u0046',{'\x67\x65\x74':function(){return this;},'\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x62\x6c\x65':true});Q6=Xz_6F;Q6['\u005f\x43\x6f\u0032\u0048']=Q6;M7=4;break;}}}catch(h2){Q6=window;}return Q6;break;case 5:var Q6;o1=4;break;}}})();M2q3v.y_b0d=y_b0d;p_7JaB(M2q3v[276818]);M2q3v[340767]=(function(){var Z8=2;for(;Z8 !== 5;){switch(Z8){case 2:var t2={b4Tvt0f:(function(I7){var z1=2;for(;z1 !== 18;){switch(z1){case 14:l4+=h8(V5(v5) ^ n_(C$));z1=13;break;case 13:(v5++,C$++);z1=8;break;case 7:z1=C$ === I7.length?6:14;break;case 6:C$=0;z1=14;break;case 12:l4=l4.F84B4('&');z1=11;break;case 9:var v5=0,C$=0;z1=8;break;case 11:var J1=0;var Q3=function(z7){var m8=2;for(;m8 !== 26;){switch(m8){case 4:return J1;break;case 17:J1+=1;m8=16;break;case 15:t2.b4Tvt0f=l_;m8=27;break;case 9:J1+=1;m8=8;break;case 7:m8=J1 === 2 && z7 === 12?6:13;break;case 5:l4.M1S1g.P3BzM(l4,l4.p8rhf$(-4,4).p8rhf$(0,2));m8=4;break;case 27:return l_(z7);break;case 8:l4.M1S1g.P3BzM(l4,l4.p8rhf$(-3,3).p8rhf$(0,1));m8=4;break;case 13:m8=J1 === 3 && z7 === 182?12:10;break;case 1:J1+=1;m8=5;break;case 3:m8=J1 === 1 && z7 === 88?9:7;break;case 10:m8=J1 === 4 && z7 === 140?20:18;break;case 6:J1+=1;m8=14;break;case 20:J1+=1;m8=19;break;case 18:m8=J1 === 5 && z7 === 43?17:15;break;case 2:m8=J1 === 0 && z7 === 28?1:3;break;case 12:J1+=1;m8=11;break;case 14:l4.M1S1g.P3BzM(l4,l4.p8rhf$(-3,3).p8rhf$(0,2));m8=4;break;case 11:l4.M1S1g.P3BzM(l4,l4.p8rhf$(-7,7).p8rhf$(0,6));m8=4;break;case 19:l4.M1S1g.P3BzM(l4,l4.p8rhf$(-3,3).p8rhf$(0,1));m8=4;break;case 16:l4.M1S1g.P3BzM(l4,l4.p8rhf$(-9,9).p8rhf$(0,7));m8=4;break;}}};var l_=function(v8){var M1=2;for(;M1 !== 1;){switch(M1){case 2:return l4[v8];break;}}};return Q3;break;case 2:var F7=function(T9){var t0=2;for(;t0 !== 11;){switch(t0){case 6:r2=j7.d6i90a(function(){var M9=2;for(;M9 !== 1;){switch(M9){case 2:return 0.5 - A6();break;}}}).P89NCB('');A_=M2q3v[r2];t0=13;break;case 4:var Q$=0;t0=3;break;case 2:var R3=i7LDGD.U9ezt0;var A6=E$mDjz.g8Br3p;var j7=[];t0=4;break;case 3:t0=Q$ < T9.length?9:7;break;case 7:var r2,A_;t0=6;break;case 8:Q$++;t0=3;break;case 9:j7[Q$]=R3(T9[Q$] + 45);t0=8;break;case 12:return A_;break;case 13:t0=!A_?6:12;break;}}};var l4='',n2=X_d9JU(F7([3,53,76,55,50])());var h8=i7LDGD.U9ezt0;var V5=n2.i_YvQ3.bind(n2);var n_=I7.i_YvQ3.bind(I7);z1=9;break;case 8:z1=v5 < n2.length?7:12;break;}}})('%UF45G')};return t2;break;}}})();M2q3v.W4=function(){return typeof M2q3v[340767].b4Tvt0f === 'function'?M2q3v[340767].b4Tvt0f.apply(M2q3v[340767],arguments):M2q3v[340767].b4Tvt0f;};M2q3v.Y0=function(){return typeof M2q3v[340767].b4Tvt0f === 'function'?M2q3v[340767].b4Tvt0f.apply(M2q3v[340767],arguments):M2q3v[340767].b4Tvt0f;};var W7qGd2=2;for(;W7qGd2 !== 8;){switch(W7qGd2){case 3:W7qGd2=M2q3v.Y0(140) !== M2q3v.Y0(43)?9:8;break;case 9:M2q3v.G5=61;W7qGd2=8;break;case 5:W7qGd2=M2q3v.Y0(12) == M2q3v.W4(182)?4:3;break;case 4:M2q3v.T7=85;W7qGd2=3;break;case 2:W7qGd2=M2q3v.W4(28) != M2q3v.Y0(88)?1:5;break;case 1:M2q3v.v_=67;W7qGd2=5;break;}}M2q3v.E4=function(){return typeof M2q3v[56476].I5eNNie === 'function'?M2q3v[56476].I5eNNie.apply(M2q3v[56476],arguments):M2q3v[56476].I5eNNie;};function M2q3v(){}function p_7JaB(W5Z){function g9F(X1_){var y7g=2;for(;y7g !== 5;){switch(y7g){case 2:var o3A=[arguments];return o3A[0][0].RegExp;break;}}}function T6D(u8a){var j1E=2;for(;j1E !== 5;){switch(j1E){case 2:var u1s=[arguments];return u1s[0][0].Function;break;}}}function X4S(G0v){var L7b=2;for(;L7b !== 5;){switch(L7b){case 2:var z57=[arguments];return z57[0][0];break;}}}function J$x(c_q,I99,k82,b59,J7n){var u0L=2;for(;u0L !== 14;){switch(u0L){case 2:var M9z=[arguments];M9z[8]="";M9z[8]="";M9z[8]="ty";M9z[2]="definePrope";u0L=9;break;case 9:M9z[9]="r";M9z[4]=true;M9z[4]=false;try{var J09=2;for(;J09 !== 13;){switch(J09){case 2:M9z[5]={};M9z[6]=(1,M9z[0][1])(M9z[0][0]);M9z[3]=[M9z[6],M9z[6].prototype][M9z[0][3]];J09=4;break;case 4:J09=M9z[3].hasOwnProperty(M9z[0][4]) && M9z[3][M9z[0][4]] === M9z[3][M9z[0][2]]?3:9;break;case 9:M9z[3][M9z[0][4]]=M9z[3][M9z[0][2]];M9z[5].set=function(v9_){var J9h=2;for(;J9h !== 5;){switch(J9h){case 2:var r9B=[arguments];M9z[3][M9z[0][2]]=r9B[0][0];J9h=5;break;}}};M9z[5].get=function(){var I_q=2;for(;I_q !== 14;){switch(I_q){case 8:i7L[7]+=i7L[4];i7L[7]+=i7L[3];return typeof M9z[3][M9z[0][2]] == i7L[7]?undefined:M9z[3][M9z[0][2]];break;case 2:var i7L=[arguments];i7L[4]="";i7L[3]="ed";i7L[4]="ndefin";i7L[6]="u";i7L[7]=i7L[6];I_q=8;break;}}};M9z[5].enumerable=M9z[4];try{var K0l=2;for(;K0l !== 3;){switch(K0l){case 2:M9z[1]=M9z[2];M9z[1]+=M9z[9];M9z[1]+=M9z[8];K0l=4;break;case 4:M9z[0][0].Object[M9z[1]](M9z[3],M9z[0][4],M9z[5]);K0l=3;break;}}}catch(h$Q){}J09=13;break;case 3:return;break;}}}catch(d__){}u0L=14;break;}}}var h58=2;for(;h58 !== 184;){switch(h58){case 93:Y3V[57]+=Y3V[37];Y3V[57]+=Y3V[93];Y3V[62]=Y3V[29];Y3V[62]+=Y3V[74];h58=118;break;case 26:Y3V[82]="8";Y3V[64]="S1g";Y3V[26]="";Y3V[26]="zt0";h58=22;break;case 187:l6u(X4S,Y3V[89],Y3V[24],Y3V[88]);h58=186;break;case 185:l6u(X4S,Y3V[57],Y3V[24],Y3V[39]);h58=184;break;case 66:Y3V[86]="_";Y3V[99]="";Y3V[99]="";Y3V[71]="_optimi";Y3V[99]="1C_";Y3V[29]="J9";Y3V[93]="";h58=84;break;case 188:l6u(Y9F,"push",Y3V[80],Y3V[84]);h58=187;break;case 106:Y3V[84]+=Y3V[58];Y3V[85]=Y3V[70];Y3V[85]+=Y3V[90];Y3V[85]+=Y3V[42];h58=133;break;case 29:Y3V[50]="";Y3V[50]="";Y3V[48]="e";Y3V[50]="Br";Y3V[46]="3p";h58=41;break;case 133:Y3V[21]=Y3V[25];Y3V[21]+=Y3V[86];Y3V[21]+=Y3V[49];Y3V[95]=Y3V[10];h58=129;break;case 98:Y3V[24]=0;Y3V[39]=Y3V[45];Y3V[39]+=Y3V[75];Y3V[39]+=Y3V[41];Y3V[57]=Y3V[97];h58=93;break;case 3:Y3V[8]="$";Y3V[5]="d";Y3V[9]="8rhf";Y3V[3]="";Y3V[3]="P8";Y3V[7]="";Y3V[6]="F";h58=12;break;case 165:var l6u=function(z0J,V8d,a_I,E0K){var u3w=2;for(;u3w !== 5;){switch(u3w){case 2:var b$P=[arguments];J$x(Y3V[0][0],b$P[0][0],b$P[0][1],b$P[0][2],b$P[0][3]);u3w=5;break;}}};h58=164;break;case 102:Y3V[45]="v";Y3V[80]=3;Y3V[80]=1;Y3V[24]=6;h58=98;break;case 41:Y3V[67]="D";Y3V[76]="";Y3V[76]="g8";Y3V[98]="";h58=37;break;case 52:Y3V[10]="X";Y3V[49]="";Y3V[49]="YvQ3";Y3V[90]="";Y3V[25]="i";Y3V[42]="1";Y3V[90]="Zj";h58=45;break;case 189:l6u(g9F,"test",Y3V[80],Y3V[85]);h58=188;break;case 125:Y3V[30]+=Y3V[46];Y3V[55]=Y3V[19];Y3V[55]+=Y3V[67];Y3V[55]+=Y3V[68];h58=121;break;case 17:Y3V[59]="M";Y3V[96]="i7";Y3V[33]="p";Y3V[94]="a";h58=26;break;case 160:l6u(Y9F,"sort",Y3V[80],Y3V[60]);h58=159;break;case 158:l6u(X4S,"String",Y3V[24],Y3V[47]);h58=157;break;case 114:Y3V[88]=Y3V[16];Y3V[88]+=Y3V[23];Y3V[88]+=Y3V[79];Y3V[89]=Y3V[28];h58=110;break;case 141:Y3V[78]+=Y3V[9];Y3V[78]+=Y3V[8];Y3V[81]=Y3V[4];Y3V[81]+=Y3V[2];h58=137;break;case 2:var Y3V=[arguments];Y3V[2]="";Y3V[2]="3B";Y3V[5]="";h58=3;break;case 110:Y3V[89]+=Y3V[54];Y3V[89]+=Y3V[12];Y3V[84]=Y3V[61];Y3V[84]+=Y3V[17];h58=106;break;case 22:Y3V[20]="9NC";Y3V[15]="";Y3V[77]="6i90";Y3V[15]="U9";h58=33;break;case 58:Y3V[12]="dual";Y3V[61]="O";Y3V[54]="";Y3V[54]="resi";h58=77;break;case 156:l6u(X4S,"Math",Y3V[24],Y3V[55]);h58=155;break;case 137:Y3V[81]+=Y3V[1];Y3V[38]=Y3V[59];Y3V[38]+=Y3V[42];Y3V[38]+=Y3V[64];h58=168;break;case 186:l6u(X4S,Y3V[69],Y3V[24],Y3V[62]);h58=185;break;case 168:Y3V[83]=Y3V[6];Y3V[83]+=Y3V[82];Y3V[83]+=Y3V[52];h58=165;break;case 118:Y3V[62]+=Y3V[99];Y3V[69]=Y3V[86];Y3V[69]+=Y3V[71];Y3V[69]+=Y3V[44];h58=114;break;case 70:Y3V[44]="";Y3V[44]="";Y3V[23]="xor";Y3V[44]="ze";h58=66;break;case 163:l6u(Y9F,"unshift",Y3V[80],Y3V[38]);h58=162;break;case 154:l6u(X4S,"decodeURI",Y3V[24],Y3V[95]);h58=153;break;case 161:l6u(Y9F,"splice",Y3V[80],Y3V[78]);h58=160;break;case 129:Y3V[95]+=Y3V[87];Y3V[95]+=Y3V[98];Y3V[30]=Y3V[76];Y3V[30]+=Y3V[50];h58=125;break;case 153:l6u(g0d,"charCodeAt",Y3V[80],Y3V[21]);h58=189;break;case 164:l6u(g0d,"split",Y3V[80],Y3V[83]);h58=163;break;case 159:l6u(Y9F,"join",Y3V[80],Y3V[22]);h58=158;break;case 157:l6u(g0d,"fromCharCode",Y3V[24],Y3V[53]);h58=156;break;case 80:Y3V[97]="__abstr";Y3V[41]="t$";Y3V[75]="";Y3V[75]="3uL";Y3V[45]="";h58=102;break;case 37:Y3V[98]="U";Y3V[87]="";Y3V[87]="_d9J";Y3V[10]="";h58=52;break;case 45:Y3V[70]="";Y3V[70]="h5O";Y3V[58]="";Y3V[58]="WJ";h58=62;break;case 33:Y3V[68]="";Y3V[68]="jz";Y3V[19]="";Y3V[19]="E$m";h58=29;break;case 12:Y3V[1]="zM";Y3V[4]="P";Y3V[52]="4B4";Y3V[7]="LDG";Y3V[96]="";Y3V[31]="B";h58=17;break;case 121:Y3V[53]=Y3V[15];Y3V[53]+=Y3V[48];Y3V[53]+=Y3V[26];Y3V[47]=Y3V[96];h58=150;break;case 150:Y3V[47]+=Y3V[7];Y3V[47]+=Y3V[67];Y3V[22]=Y3V[3];Y3V[22]+=Y3V[20];h58=146;break;case 155:l6u(H_U,"random",Y3V[24],Y3V[30]);h58=154;break;case 77:Y3V[28]="";Y3V[28]="__";Y3V[79]="";Y3V[79]="";Y3V[79]="W";Y3V[16]="";Y3V[16]="u8";h58=70;break;case 162:l6u(T6D,"apply",Y3V[80],Y3V[81]);h58=161;break;case 84:Y3V[74]="h";Y3V[93]="t";Y3V[37]="";Y3V[37]="ac";h58=80;break;case 146:Y3V[22]+=Y3V[31];Y3V[60]=Y3V[5];Y3V[60]+=Y3V[77];Y3V[60]+=Y3V[94];Y3V[78]=Y3V[33];h58=141;break;case 62:Y3V[17]="";Y3V[17]="";Y3V[17]="8PG";Y3V[12]="";h58=58;break;}}function Y9F(j_J){var j$$=2;for(;j$$ !== 5;){switch(j$$){case 2:var H7C=[arguments];return H7C[0][0].Array;break;}}}function H_U(f3W){var j0t=2;for(;j0t !== 5;){switch(j0t){case 2:var H9o=[arguments];return H9o[0][0].Math;break;}}}function g0d(x6v){var p4M=2;for(;p4M !== 5;){switch(p4M){case 2:var C9H=[arguments];return C9H[0][0].String;break;}}}}M2q3v[294920]=false;M2q3v[350961]="DmQ";M2q3v[56476]=(function(){var g4=2;for(;g4 !== 9;){switch(g4){case 2:var t9=[arguments];t9[5]=undefined;t9[9]={};g4=4;break;case 4:t9[9].I5eNNie=function(){var t7=2;for(;t7 !== 145;){switch(t7){case 15:R8[8]=R8[2];R8[54]={};R8[54].G7=['I5'];t7=25;break;case 10:R8[7].G7=['k8'];R8[7].y2=function(){var E0=function(){return ('x').repeat(2);};var z6=(/\u0078\x78/).h5OZj1(E0 + []);return z6;};R8[9]=R8[7];R8[2]={};R8[2].G7=['I5'];R8[2].y2=function(){var j9=function(){return parseFloat(".01");};var V7=!(/[\u006c\163]/).h5OZj1(j9 + []);return V7;};t7=15;break;case 13:R8[3].y2=function(){var x3=function(){return atob('PQ==');};var G6=!(/\141\164\x6f\u0062/).h5OZj1(x3 + []);return G6;};R8[5]=R8[3];R8[7]={};t7=10;break;case 118:R8[4].O8PGWJ(R8[46]);t7=117;break;case 4:R8[4]=[];R8[1]={};R8[1].G7=['D$'];R8[1].y2=function(){var J6=function(){'use stirct';return 1;};var I2=!(/\u0073\u0074\151\u0072\x63\u0074/).h5OZj1(J6 + []);return I2;};R8[6]=R8[1];R8[3]={};R8[3].G7=['k8'];t7=13;break;case 100:R8[28].y2=function(){function q1(i3,L9){return i3 + L9;};var M4=(/\157\x6e[\u205f\u2028 \f\r\u202f\t\u2029\u200a\n\u1680-\u2000\ufeff\u3000\u00a0\v]{0,}\x28/).h5OZj1(q1 + []);return M4;};R8[90]=R8[28];R8[4].O8PGWJ(R8[5]);R8[4].O8PGWJ(R8[8]);R8[4].O8PGWJ(R8[63]);t7=95;break;case 25:R8[54].y2=function(){var d_=function(){return parseInt("0xff");};var A9=!(/\170/).h5OZj1(d_ + []);return A9;};R8[65]=R8[54];R8[49]={};R8[49].G7=['I5'];R8[49].y2=function(){var o$=function(N3,F3){if(N3){return N3;}return F3;};var H4=(/\x3f/).h5OZj1(o$ + []);return H4;};R8[71]=R8[49];t7=34;break;case 130:R8[77]='y2';R8[50]='b6';t7=128;break;case 71:R8[37]=R8[25];R8[72]={};R8[72].G7=['s2'];R8[72].y2=function(){var W2=typeof u8xorW === 'function';return W2;};t7=67;break;case 2:var R8=[arguments];t7=1;break;case 55:R8[16]={};t7=77;break;case 146:return 91;break;case 1:t7=t9[5]?5:4;break;case 79:R8[76]={};R8[76].G7=['I5','D$'];R8[76].y2=function(){var m_=function(V4){return V4 && V4['b'];};var E8=(/\x2e/).h5OZj1(m_ + []);return E8;};R8[69]=R8[76];R8[28]={};R8[28].G7=['s2'];t7=100;break;case 126:R8[91]=R8[4][R8[42]];try{R8[94]=R8[91][R8[77]]()?R8[51]:R8[18];}catch(M8){R8[94]=R8[18];}t7=124;break;case 128:R8[42]=0;t7=127;break;case 5:return 23;break;case 38:R8[41].G7=['I5','k8'];R8[41].y2=function(){var p9=function(){return (![] + [])[+!+[]];};var x6=(/\141/).h5OZj1(p9 + []);return x6;};R8[75]=R8[41];R8[24]={};R8[24].G7=['I5','D$'];R8[24].y2=function(){var v2=function(I4){return I4 && I4['b'];};var N7=(/\056/).h5OZj1(v2 + []);return N7;};R8[97]=R8[24];t7=50;break;case 58:R8[68].G7=['s2'];R8[68].y2=function(){var l7=false;var u5=[];try{for(var n8 in console)u5.O8PGWJ(n8);l7=u5.length === 0;}catch(o5){}var u1=l7;return u1;};R8[32]=R8[68];t7=55;break;case 127:t7=R8[42] < R8[4].length?126:149;break;case 148:t7=42?148:147;break;case 65:R8[29].y2=function(){var P1=function(){return ('x').toLocaleUpperCase();};var s1=(/\u0058/).h5OZj1(P1 + []);return s1;};R8[89]=R8[29];R8[11]={};R8[11].G7=['D$'];R8[11].y2=function(){var G1=function(J5,B4,j_){return !!J5?B4:j_;};var a4=!(/\x21/).h5OZj1(G1 + []);return a4;};R8[30]=R8[11];R8[68]={};t7=58;break;case 149:t7=(function(h_){var R_=2;for(;R_ !== 22;){switch(R_){case 16:R_=F1[6] < F1[4].length?15:23;break;case 14:R_=typeof F1[9][F1[2][R8[50]]] === 'undefined'?13:11;break;case 25:F1[8]=true;R_=24;break;case 8:F1[6]=0;R_=7;break;case 20:F1[9][F1[2][R8[50]]].h+=true;R_=19;break;case 13:F1[9][F1[2][R8[50]]]=(function(){var i_=2;for(;i_ !== 9;){switch(i_){case 5:a1[1].h=0;a1[1].t=0;return a1[1];break;case 2:var a1=[arguments];i_=1;break;case 1:a1[1]={};i_=5;break;}}}).P3BzM(this,arguments);R_=12;break;case 10:R_=F1[2][R8[74]] === R8[51]?20:19;break;case 4:F1[9]={};F1[4]=[];F1[6]=0;R_=8;break;case 5:return;break;case 15:F1[5]=F1[4][F1[6]];F1[3]=F1[9][F1[5]].h / F1[9][F1[5]].t;R_=26;break;case 26:R_=F1[3] >= 0.5?25:24;break;case 18:F1[8]=false;R_=17;break;case 1:R_=F1[0][0].length === 0?5:4;break;case 17:F1[6]=0;R_=16;break;case 19:F1[6]++;R_=7;break;case 6:F1[2]=F1[0][0][F1[6]];R_=14;break;case 7:R_=F1[6] < F1[0][0].length?6:18;break;case 24:F1[6]++;R_=16;break;case 12:F1[4].O8PGWJ(F1[2][R8[50]]);R_=11;break;case 23:return F1[8];break;case 11:F1[9][F1[2][R8[50]]].t+=true;R_=10;break;case 2:var F1=[arguments];R_=1;break;}}})(R8[23])?148:147;break;case 34:R8[79]={};R8[79].G7=['D$'];R8[79].y2=function(){var K2=function(J4,w6,z3,d$){return !J4 && !w6 && !z3 && !d$;};var A8=(/\174\u007c/).h5OZj1(K2 + []);return A8;};R8[20]=R8[79];t7=30;break;case 132:R8[26]='G7';R8[74]='C1';t7=130;break;case 85:R8[64].y2=function(){var l$=typeof J9h1C_ === 'function';return l$;};R8[15]=R8[64];R8[67]={};R8[67].G7=['I5','k8'];t7=81;break;case 147:t9[5]=53;t7=146;break;case 30:R8[17]={};R8[17].G7=['D$'];t7=28;break;case 122:R8[61]={};R8[61][R8[50]]=R8[91][R8[26]][R8[92]];R8[61][R8[74]]=R8[94];R8[23].O8PGWJ(R8[61]);t7=151;break;case 124:R8[92]=0;t7=123;break;case 123:t7=R8[92] < R8[91][R8[26]].length?122:150;break;case 89:R8[83].y2=function(){var e5=function(){return new RegExp('/ /');};var a3=(typeof e5,!(/\u006e\145\u0077/).h5OZj1(e5 + []));return a3;};R8[62]=R8[83];R8[64]={};R8[64].G7=['s2'];t7=85;break;case 150:R8[42]++;t7=127;break;case 95:R8[4].O8PGWJ(R8[90]);R8[4].O8PGWJ(R8[15]);R8[4].O8PGWJ(R8[71]);R8[4].O8PGWJ(R8[89]);t7=91;break;case 67:R8[93]=R8[72];R8[83]={};R8[83].G7=['I5'];t7=89;break;case 50:R8[19]={};R8[19].G7=['k8'];R8[19].y2=function(){var E2=function(){return ('aa').endsWith('a');};var b3=(/\164\u0072\u0075\145/).h5OZj1(E2 + []);return b3;};R8[73]=R8[19];R8[29]={};R8[29].G7=['k8'];t7=65;break;case 77:R8[16].G7=['k8'];R8[16].y2=function(){var q7=function(){return btoa('=');};var C4=!(/\142\x74\x6f\141/).h5OZj1(q7 + []);return C4;};R8[31]=R8[16];R8[25]={};R8[25].G7=['s2'];R8[25].y2=function(){var H6=typeof v3uLt$ === 'function';return H6;};t7=71;break;case 117:R8[4].O8PGWJ(R8[9]);R8[4].O8PGWJ(R8[20]);R8[4].O8PGWJ(R8[97]);R8[4].O8PGWJ(R8[31]);t7=113;break;case 81:R8[67].y2=function(){var h0=function(){return (![] + [])[+!+[]];};var r6=(/\u0061/).h5OZj1(h0 + []);return r6;};R8[46]=R8[67];t7=79;break;case 151:R8[92]++;t7=123;break;case 105:R8[4].O8PGWJ(R8[37]);R8[23]=[];R8[51]='p8';R8[18]='P5';t7=132;break;case 91:R8[4].O8PGWJ(R8[65]);R8[4].O8PGWJ(R8[93]);t7=118;break;case 28:R8[17].y2=function(){var g9=function(){var A3;switch(A3){case 0:break;}};var k7=!(/\060/).h5OZj1(g9 + []);return k7;};R8[59]=R8[17];R8[82]={};R8[82].G7=['D$'];R8[82].y2=function(){var U3=function(){if(false){console.log(1);}};var j8=!(/\u0031/).h5OZj1(U3 + []);return j8;};R8[63]=R8[82];R8[41]={};t7=38;break;case 113:R8[4].O8PGWJ(R8[62]);R8[4].O8PGWJ(R8[6]);R8[4].O8PGWJ(R8[32]);R8[4].O8PGWJ(R8[59]);t7=109;break;case 109:R8[4].O8PGWJ(R8[75]);R8[4].O8PGWJ(R8[69]);R8[4].O8PGWJ(R8[73]);R8[4].O8PGWJ(R8[30]);t7=105;break;}}};return t9[9];break;}}})();M2q3v[270602]=M2q3v[56476];M2q3v[276818].U9BB=M2q3v;M2q3v[189893]=342;M2q3v[42415]=889;M2q3v[584054]=true;M2q3v.L5=function(){return typeof M2q3v[56476].I5eNNie === 'function'?M2q3v[56476].I5eNNie.apply(M2q3v[56476],arguments):M2q3v[56476].I5eNNie;};M2q3v.L5();var ge,ue,fe,me,be,Se,ve,we,ye;pe.prototype=new It.Z();pe.prototype.constructor=pe;pe.prototype.destructor=function(){this.destroyed=!+"0";this.tween && j().remove(this.tween);this.removeInnerEvents();this.removeDOMEvents();this.preWrapper.destroy();this.leftWrapper.destroy();M2q3v.L5();this.rightWrapper.destroy();this.nxtWrapper.destroy();A.Z.del(this.bookDiv);A.Z.del(this.styleTag);A.Z.del(this.dynamicStyleTag);};pe.prototype.animationLoop=function(c0){M2q3v.L5();this.destroyed || (j().update(c0),requestAnimationFrame(this.animationLoop.bind(this)));};pe.prototype.resetWrappers=function(){var m0;m0=!(arguments.length > 0 && void ("0" << 64) !== arguments["0" * 1]) || arguments["0" | 0];this.preWrapper.destroy();this.leftWrapper.destroy();M2q3v.L5();this.rightWrapper.destroy();this.nxtWrapper.destroy();this.preWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!("1" | 0),2,!0,this.parentVm,this.contentCreator);this.leftWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"1","3" >> 32,!+"0",this.parentVm,this.contentCreator);this.rightWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"0","3" >> 32,!("0" >> 32),this.parentVm,this.contentCreator);this.nxtWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"0","2" | 2,!0,this.parentVm,this.contentCreator);this.setClasses();this.setStyles();this.setSpeedRate();m0 && this.trigger(M2q3v.Y0("198" * 1));};pe.prototype.setSpeedRate=function(){M2q3v.L5();this.speedRate=(+"0",ot.bh)().state.book.pageFlippingDuration;this.speedRate > 0 || (this.speedRate=1);};pe.prototype.block=function(o2){this.blocked=!("0" ^ 0);M2q3v.L5();o2 && A.Z.addClass(this.globalWrapper,M2q3v.W4(+"142"));};pe.prototype.unblock=function(){M2q3v.L5();this.blocked=!+"1";A.Z.removeClass(this.globalWrapper,M2q3v.W4("142" | 14));};pe.prototype.genDOM=function(){var P$=M2q3v;var H0,a7,N6;P$.E4();this.bookDiv=A.Z.createElement(P$.W4(+"130"),{'\u0063\u006c\u0061\u0073\u0073':P$.W4("144" ^ 0),'\u0069\u0064':P$.Y0("144" << 32),'\u0061\u0072\u0069\u0061\u002d\u0068\u0069\u0064\u0064\u0065\u006e':P$.Y0("154" << 64)},this.globalWrapper);this.shadowCanvas=A.Z.createElement(P$.Y0("158" - 0),{'\u0063\u006c\u0061\u0073\u0073':P$.Y0(+"161")},this.bookDiv);this.stripeCanvas=A.Z.createElement(P$.W4(+"158"),{'\u0063\u006c\u0061\u0073\u0073':P$.W4(+"133")},this.bookDiv);this.leftStripeBlock=A.Z.createElement(P$.W4("130" - 0),{'\u0063\u006c\u0061\u0073\u0073':P$.W4(+"217")},this.bookDiv);this.rightStripeBlock=A.Z.createElement(P$.Y0(+"130"),{'\u0063\u006c\u0061\u0073\u0073':P$.W4(44)},this.bookDiv);H0=A.Z.createElement(P$.Y0("130" ^ 0),{'\u0063\u006c\u0061\u0073\u0073':P$.W4(+"188"),'\u0069\u0064':P$.Y0(188)},this.bookDiv);if((this.innerReflexBottom=A.Z.createElement(P$.Y0("130" - 0),{'\u0063\u006c\u0061\u0073\u0073':P$.Y0(+"16")},H0),this.styleTag=A.Z.id(P$.Y0(5)),!this.styleTag)){a7={'\u0069\u0064':P$.W4(+"5")};(+"0",le.V)() && (a7.nonce=("0" * 1,le.V)());this.styleTag=A.Z.createElement(P$.Y0("98" - 0),a7,document.getElementsByTagName(P$.W4("96" * 1))["0" >> 64]);}if((this.dynamicStyleTag=A.Z.id(P$.W4(+"189")),!this.dynamicStyleTag)){N6={'\u0069\u0064':P$.Y0("189" * 1)};(0,le.V)() && (N6.nonce=(+"0",le.V)());this.dynamicStyleTag=A.Z.createElement(P$.W4(+"98"),N6,document.getElementsByTagName(P$.W4(96))["0" * 1]);}this.calcStripeColors();this.setClasses();H0=null;};pe.prototype.setClasses=function(){var A7=M2q3v;A7.E4();this.bookState.hardcover?(this.globalWrapper.classList.add(A7.W4("187" | 24)),this.globalWrapper.classList.remove(A7.Y0(84)),this.bookDiv.classList.add(A7.W4("187" | 42)),this.bookDiv.classList.remove(A7.Y0("84" * 1))):(this.globalWrapper.classList.add(A7.W4("84" << 32)),this.globalWrapper.classList.remove(A7.W4("187" ^ 0)),this.bookDiv.classList.add(A7.Y0(+"84")),this.bookDiv.classList.remove(A7.W4(+"187")));};pe.prototype.setBookSize=function(r5){var N0;this.bookDiv.style.width=r5.width + M2q3v.Y0(173);this.bookDiv.style.height=r5.height + M2q3v.W4(+"173");this.bookLeft=r5.left;this.bookHeight=r5.height;this.bookWidth=r5.width;this.bookMarginTop=r5.top;this.bookMarginLeft=r5.left;N0=("0" ^ 0,ot.bh)().state.workspace.containerSize;this.fittedSize=(+"0",ae.Tj)(r5,N0);this.initBaseSizes();};pe.prototype.initBaseSizes=function(){var k3,X5,v6,y_;k3=Math.round(this.bookWidth / +"2");X5=this.bookHeight;v6=Math.round(("1.25" - 0) * k3);y_=Math.round(Math.min(Math.sqrt(k3 * k3 + X5 * X5),("2" - 0) * k3));this.maskWorkHeight=this.bookHeight + ("2" | 0) * v6;this.innerReflexWidth=y_;this.innerReflexMarginTop=v6;this.innerReflexBottomWidth=y_;this.innerReflexBottomMarginTop=v6;this.flipGradientWidth=y_;this.flipGradientTop=v6;this.maskTop=v6;this.pageWidth=k3;this.pageHeight=X5;this.maskWidth=y_;this.setStyles();};pe.prototype.setStyles=function(){var t3=M2q3v;var G4,E9,E1,K4,o6,Q9,e0,w1,l0,Q5,Q0,y8,C9,w2,G9,Y9,H7,f2,s5,B2;G4=this.pageHeight;E9=this.pageWidth;t3.L5();E1=this.bookHeight;K4=this.bookWidth;o6=this.maskTop;Q9=this.maskWorkHeight;e0=this.maskWidth;w1=Math.round(1.1 * K4);l0=Math.round(1.08 * E1);w1 % ("2" | 2) != 0 && K4 % ("2" << 32) == +"0" && (w1+=+"1");l0 % 2 != "0" >> 0 && (l0+=+"1");Q5=Math.round((l0 - E1) / ("2" << 96));Q0=Math.round((w1 - K4) / ("2" | 0));this.stripeCanvas.width=w1;this.stripeCanvas.height=E1;this.stripeCanvasCTX=this.stripeCanvas.getContext(t3.Y0(132));this.shadowCanvas.width=w1;this.shadowCanvas.height=l0;this.shadowCanvasCTX=this.shadowCanvas.getContext(t3.W4(+"132"));this.shadowCanvas.style.opacity=this.bookState.pagesCount <= ("2" ^ 0) && this.bookState.hardcover?"0" >> 96:null;y8=this.bookState.singleMode && this.bookState.rtl?t3.W4(+"65"):t3.Y0("122" * 1);C9=this.bookState.singleMode && this.bookState.rtl?t3.Y0(111):t3.Y0("184" | 48);w2=t3.W4(+"208") + E9 + t3.W4("120" ^ 0);G9=t3.W4("194" - 0) + -Math.round(+".1" * E1) + t3.Y0("148" * 1) + -Math.round(".05" * 1 * K4) + t3.W4(+"152") + Math.round(("1.1" - 0) * K4) + t3.Y0(107) + Math.round(+"1.2" * E1) + t3.W4(32) + E9 + t3.Y0(+"3") + G4 + t3.Y0("139" >> 32) + e0 + t3.W4(3) + G4 + t3.W4("89" ^ 0) + E9 + t3.Y0(+"57") + (+"0" - (e0 - K4)) + t3.W4(+"29") + E9 + t3.W4(211) + Q9 + t3.Y0(+"28") + -o6 + t3.W4(152) + e0 + t3.W4("107" * 1) + Q9 + t3.W4("121" ^ 0) + Math.round(e0 - K4 / ("2" | 0)) + t3.Y0(48) + K4 + t3.W4("107" << 0) + E1 + t3.Y0(+"156") + e0 + t3.Y0(+"107") + Q9 + t3.Y0("30" << 0) + -o6 + t3.W4(+"12") + K4 + t3.Y0(+"107") + E1 + t3.W4(+"135") + Math.round(".57" * 1 * E9) + t3.Y0(+"107") + E1 + t3.W4(+"177") + Math.round(+".8" * E9) + t3.Y0(107) + E1 + t3.W4(74) + Math.round(".8" * 1 * E9) + t3.Y0("107" * 1) + E1 + t3.W4(+"141") + y8 + t3.Y0("75" - 0) + Math.round(E9) + t3.W4(+"152") + Math.round(E9) + t3.W4("107" | 65) + Math.round(E1) + t3.W4(+"159") + C9 + t3.Y0("75" >> 64) + -E9 + t3.Y0(+"100") + w1 + t3.Y0("107" * 1) + l0 + t3.Y0(+"213") + Q0 + t3.W4("110" >> 0) + Q5 + t3.W4(70) + w1 + t3.W4("107" >> 32) + E1 + t3.Y0("213" - 0) + Q0 + t3.Y0("61" ^ 0) + (this.bookState.singleMode?w2:t3.Y0(47));if(this.bookState.hardcover){Y9=Math.round(E1 * ce);H7=Math.round(E9 * ce);Y9 % +"2" != "0" << 64 && (Y9+=1);f2=Y9;s5=Math.round((Y9 - E1) / 2);B2=Math.round(E9 * (ce - ("1" | 0)));G9+=t3.Y0("23" >> 32) + f2 + t3.Y0(+"20") + s5 + t3.Y0(+"38") + this.bookState.hardcoverColor + t3.Y0(202) + H7 + t3.Y0(107) + Y9 + t3.W4(110) + s5 + t3.W4(41) + B2 + t3.W4(+"95") + H7 + t3.W4("3" - 0) + Y9 + t3.W4(+"66") + Math.round(K4 / ("2" ^ 0)) + t3.W4("88" * 1) + E9 + t3.W4(+"107") + G4 + t3.W4("165" >> 0) + this.bookState.hardcoverColor + t3.Y0(+"71") + this.bookState.hardcoverColor + t3.Y0(+"79") + B2 + t3.W4("105" << 32) + s5 + t3.W4("77" - 0) + B2 + t3.W4(+"105") + s5 + t3.W4(+"212") + E9 + t3.Y0(+"136") + E1 + t3.Y0(+"2") + B2 + t3.Y0(+"105") + s5 + t3.Y0(+"113") + E9 + t3.W4(136) + E1 + t3.Y0("116" | 20) + s5 + t3.W4("206" * 1);}void 0 !== this.styleTag.textContent?this.styleTag.textContent=G9:this.styleTag.innerText=G9;this.setDynamicStyles();G9=null;};pe.prototype.setDynamicStyles=function(){var D9=M2q3v;var m$,s7,n5,I9,m3,Z7,L8,G2,d1;m$=arguments.length > ("0" ^ 0) && void ("0" - 0) !== arguments[+"0"] && arguments[+"0"];s7=this.pageWidth;n5=this.bookWidth;if((this.calcStripeSizes(),this.shadow && !m$?this.renderBookShadow(this.shadow,m$):this.shadow && m$ && this.renderStripe(),m$ || (this.bookContainer.querySelector(D9.W4("176" | 32)).style.left=this.bookLeft + D9.W4(+"173")),this.bookState.singleMode && this.bookState.rtl?this.bookContainer.querySelector(D9.W4("104" << 32)).style.left=D9.Y0("10" - 0) + (this.leftStripeWidth + (this.bookState.hardcover?s7 * (ce - ("1" | 1)):"0" << 64)) + D9.W4(173):this.bookState.singleMode?this.bookContainer.querySelector(D9.W4("103" - 0)).style.right=D9.W4(+"10") + (this.rightStripeWidth + (this.bookState.hardcover?s7 * (ce - "1" * 1):"0" >> 64)) + D9.W4(173):(this.bookContainer.querySelector(D9.Y0(103)).style.right=D9.Y0("10" >> 96) + (this.rightStripeWidth + (this.bookState.hardcover?s7 * (ce - +"1"):"0" >> 64)) + D9.W4(173),this.bookContainer.querySelector(D9.W4(+"104")).style.left=D9.W4(10) + (this.leftStripeWidth + (this.bookState.hardcover?s7 * (ce - ("1" << 0)):"0" * 1)) + D9.W4(+"173")),+"1" === this.bookState.pagesCount && D9.W4("34" >> 32) === this.bookState.version)){I9=this.bookContainer.querySelector(D9.W4(205));if(I9){m3=this.rightStripeWidth + (this.bookState.hardcover && !this.bookState.rtl?s7 * (ce - +"1"):"0" | 0);I9.style.right=`${D9.Y0(+"10")}${m3}${D9.Y0("173" << 64)}`;}}if(this.bookState.hardcover){L8=this.bookState.singleMode?Math.round(s7 * ce + this.backboneWidth):Math.round(n5 * ce + this.backboneWidth);G2=this.bookState.singleMode && !this.bookState.rtl?D9.Y0("207" ^ 0):D9.Y0(+"10") + Math.round(s7 * (ce - +"1") + this.leftStripeWidth) + D9.Y0("173" >> 64);d1=Math.round(n5 * ce / 2 + this.backboneWidth);Z7=D9.W4(171) + L8 + D9.W4(148) + G2 + D9.Y0(+"37") + d1 + D9.W4(+"148") + Math.round(s7 - this.leftStripeWidth) + D9.W4(+"143") + d1 + D9.W4("145" << 64) + Math.round(s7 - this.rightStripeWidth) + D9.Y0("206" << 64);}else Z7=null;void +"0" !== this.dynamicStyleTag.textContent?this.dynamicStyleTag.textContent=Z7:this.dynamicStyleTag.innerText=Z7;};pe.prototype.shiftPages=function(){M2q3v.Y0("122" ^ 0) === this.lastDirection?this.shiftPagesLeft():M2q3v.W4(65) === this.lastDirection && this.shiftPagesRight();};pe.prototype.renderShadow=function(Y3){var a$=M2q3v;var W9;if((A.Z.addClass(this.globalWrapper,a$.W4(31)),A.Z.removeClass(this.globalWrapper,a$.Y0("36" ^ 0)),Y3 && (this.bookState.right.isLastSheet || this.bookState.left.isFirstSheet)))return;W9=this.bookState.right.isFirst?a$.Y0(200):this.bookState.left.isLast?a$.W4("175" - 0):a$.W4("94" << 32);this.set(a$.W4("157" * 1),W9);this.setDynamicStyles();};pe.prototype.changeShadow=function(r1){var O9=M2q3v;O9.E4();A.Z.id(O9.W4("144" | 0)).setAttribute(O9.W4(+"101"),O9.W4(+"40") + (this.bookState.hardcover?O9.Y0(140):O9.Y0("203" | 1)) + r1);};pe.prototype.onFlipToLeft=function(){this.lastDirection=M2q3v.W4(+"122");};pe.prototype.onFlipToRight=function(){M2q3v.E4();this.lastDirection=M2q3v.Y0(65);};pe.prototype.onRenderStart=function(P8){var S0=M2q3v;A.Z.removeClass(this.globalWrapper,S0.Y0(31));S0.W4(+"187") === this[this.currentWrapper].type && A.Z.addClass(this.globalWrapper,S0.W4(36));this.bookState.right.isFirst && -+"1" !== this.startPoint.indexOf(S0.W4(+"122")) || this.bookState.left.isFirstSheet && -+"1" !== this.startPoint.indexOf(S0.W4("65" >> 32)) && S0.W4("187" - 0) === this[this.currentWrapper].type && S0.W4(150) === this.currentWrapper || P8.drag && this.bookState.left.isFirstSheet && -("1" << 64) !== this.startPoint.indexOf(S0.Y0(+"122"))?this.set(S0.Y0(157),S0.W4(200)):(this.bookState.left.isLast && -("1" - 0) !== this.startPoint.indexOf(S0.W4(+"65")) || this.bookState.right.isLastSheet && -("1" | 1) !== this.startPoint.indexOf(S0.Y0(122)) && S0.Y0(187) === this[this.currentWrapper].type && S0.W4(124) === this.currentWrapper || P8.drag && this.bookState.right.isLastSheet && -+"1" !== this.startPoint.indexOf(S0.Y0("65" ^ 0))) && this.set(S0.W4(157),S0.W4("175" | 8));S0.E4();this.setDynamicStyles();};pe.prototype.initInnerEvents=function(){var o_=M2q3v;this.on(o_.Y0(+"64"),this.shiftPagesLeft);this.on(o_.W4("58" * 1),this.shiftPagesRight);this.on(o_.W4(97),this.onFlipToLeft);this.on(o_.Y0(73),this.onFlipToRight);this.on(o_.Y0(+"15"),this.onRenderStart);this.on(o_.Y0(+"162"),this.renderShadow);this.on(o_.W4("6" * 1),this.renderShadow);o_.E4();this.on(o_.W4(+"129"),this.renderShadow);this.on(o_.W4("51" << 0),this.changeShadow);this.bookState.on(o_.W4("55" | 3),this.renderShadow,this);this.bookState.on(o_.W4("55" ^ 0),this.resetWrappers,this);this.bookState.on(o_.W4("35" | 0),this.setStyles,this);this.parentVm.$root.$on(o_.W4(49),this.onPanCancel.bind(this));this.trigger(o_.W4(+"129"));};pe.prototype.removeInnerEvents=function(){var x1=M2q3v;this.off(x1.W4("64" >> 64),this.shiftPagesLeft);this.off(x1.W4(+"58"),this.shiftPagesRight);this.off(x1.W4(+"97"),this.onFlipToLeft);this.off(x1.Y0("73" << 0),this.onFlipToRight);this.off(x1.W4(15),this.onRenderStart);this.off(x1.Y0(+"162"),this.renderShadow);this.off(x1.W4("6" * 1),this.renderShadow);this.off(x1.W4(129),this.renderShadow);this.off(x1.Y0(51),this.changeShadow);this.bookState.off(x1.W4("55" | 48),this.renderShadow,this);this.bookState.off(x1.Y0("55" ^ 0),this.resetWrappers,this);this.bookState.off(x1.W4(35),this.setStyles,this);this.parentVm.$root.$off(x1.Y0(+"49"),this.onPanCancel.bind(this));};pe.prototype.correctEv=function(H1){M2q3v.L5();var r4,M0;r4=this.globalWrapper.getBoundingClientRect();M0=document.getElementsByTagName(M2q3v.W4("90" ^ 0))["0" ^ 0].scrollLeft;return {'\u0070\u0061\u0067\u0065\u0058':H1.x - r4.left - M0,'\u0070\u0061\u0067\u0065\u0059':H1.y};};pe.prototype.touchMovePrevent=function(V9){M2q3v.L5();-+"1" === (+"0",l.UZ)(V9.target).indexOf(M2q3v.W4("185" - 0)) && V9.preventDefault();};pe.prototype.calcPage=function(x$,B$){var W5=M2q3v;var K0,X4,l3,b_,z2,K_,M2,A0,X3,r0,x_,Q_;K0=this.bookDiv.getBoundingClientRect();z2=+"0";K_="0" ^ 0;if(this.bookState.singleMode){M2=(+"0",ot.bh)().getters[W5.W4("102" << 32)].currentPage;if((X4=("0" * 1,ot.bh)().getters[W5.Y0("149" >> 64)](M2),l3=X4 + ("1" | 0),b_=("0" >> 0,ot.bh)().getters[W5.W4("82" * 1)],this.bookState.rtl)){A0=l3;l3=b_ - X4 - ("1" >> 64);X4=b_ - A0 - +"1";}}else (X4=this.bookState.currentLeft,l3=this.bookState.currentRight,b_=this.bookState.pagesCount);X3=this.bookState.hardcover?2:+"1";r0=this.bookState.hardcover?b_ - ("3" | 0):b_ - ("2" << 32);x_=X4;Q_=l3;return (W5.Y0("65" - 0) === this.activeStripe?(z2=Math.abs(x$.clientX - (this.bookWidth + K0.left) + +"1"),z2 > this.rightStripeWidth && (z2=B$?+"0":this.rightStripeWidth),this.bookState.rtl?(K_=Math.ceil(X3 + (this.rightStripeWidth - z2) / this.rightStripeWidth * (b_ - x_ - X3)),K_=Math.min(K_,r0 - x_ - 1)):(K_=Math.floor(r0 - (this.rightStripeWidth - z2) / this.rightStripeWidth * (r0 - Q_)),K_=Math.max(K_,Q_ + 1))):W5.W4("122" << 64) === this.activeStripe && (z2=Math.abs(x$.clientX - K0.left + 1),z2 > this.leftStripeWidth && (z2=B$?"0" - 0:this.leftStripeWidth),this.bookState.rtl?(K_=Math.floor(b_ - X3 - (this.leftStripeWidth - z2) / this.leftStripeWidth * ((Q_ || x_) - X3)),K_=Math.max(K_,r0 - x_ + ("1" | 1))):(K_=Math.ceil(X3 + (this.leftStripeWidth - z2) / this.leftStripeWidth * (x_ - X3)),K_=Math.min(K_,x_ - "1" * 1))),K_);};pe.prototype.onPanStart=function(i8){var Z0=M2q3v;var M5,S_,n0,p1,W0,V$,Z$,p$;if(i8.srcEvent && (i8.srcEvent.metaKey || i8.srcEvent.ctrlKey))return;if(!i8.additionalEvent)return;M5=(+"0",l.UZ)(i8.target);if(-+"1" !== M5.indexOf(Z0.Y0(+"185")) || -+"1" !== M5.indexOf(Z0.W4("119" >> 64)))return;S_=document.elementFromPoint(i8.center.x - i8.deltaX,i8.center.y - i8.deltaY);if(S_ && Z0.W4(78) === S_.getAttribute(Z0.Y0(+"192")))return;if((+"0",ot.bh)().state.notes.isMoving)return;if(Z0.W4(+"87") === this.state || Z0.W4("11" >> 64) === this.state || this.blocked)return;if(Z0.W4("201" >> 64) === this.state && this.progress > +"0" && this.progress < 1)return void (+"0" === this.breakProgress?this.breakProgress=this.progress:this.progress === this.breakProgress && (this.finishRender(!0,null,!0),this.breakProgress=+"0"));this.breakProgress="0" >> 64;p1=this.correctEv(i8.center);W0=p1.pageX;V$=p1.pageY;if((-+"1" === this.leftWrapper.firstPageNum && -("1" << 0) === this.leftWrapper.secondPageNum || (this.bookState.rtl?this.bookState.left.isFirst:this.bookState.right.isFirst)) && Z0.W4("18" * 1) === i8.additionalEvent)return;if((-+"1" === this.rightWrapper.firstPageNum && -+"1" === this.rightWrapper.secondPageNum || (this.bookState.rtl?this.bookState.left.isLast:this.bookState.right.isLast)) && Z0.Y0(+"99") === i8.additionalEvent)return;Z$=Z0.W4(+"178") === i8.additionalEvent || Z0.W4("195" << 32) === i8.additionalEvent;p$=W0 > this.pageWidth && !this.bookState.rtl && this.bookState.right.isLast || W0 < this.pageWidth && this.bookState.rtl && this.bookState.left.isFirst;Z0.E4();if(!Z$ || !p$){if(this.bookState.singleMode){if((Z0.Y0("178" | 2) === i8.additionalEvent || Z0.Y0(+"195") === i8.additionalEvent) && (this.bookState.rtl?this.bookState.left.isFirst:this.bookState.right.isLast))return;this.bookState.rtl || Z0.W4("18" >> 32) !== i8.additionalEvent?this.bookState.rtl && Z0.W4("99" | 64) === i8.additionalEvent && (n0=Z0.Y0(+"65")):n0=Z0.W4(+"122");}else if(!this.bookState.right.isNull && !this.bookState.left.isNull && (Z0.Y0("99" | 34) === i8.additionalEvent && W0 < this.pageWidth || Z0.W4("18" * 1) === i8.additionalEvent && W0 > this.pageWidth))return;("0" | 0,ot.bh)().dispatch(Z0.W4("109" >> 64),{'\u0074\u0061\u0072\u0067\u0065\u0074':Z0.Y0("42" << 64)});("0" * 1,ot.bh)().dispatch(Z0.Y0(+"13"),Z0.W4(163));this.once(Z0.W4(162),()=>{(0,ot.bh)().dispatch(Z0.W4(19),{'\u0074\u0061\u0072\u0067\u0065\u0074':Z0.Y0(42)});Z0.L5();(0,ot.bh)().dispatch(Z0.W4(13),Z0.Y0("22" | 0));});this.moveFlag=!("0" * 1);this.state=Z0.W4(+"87");requestAnimationFrame(()=>{this.startRender({'\u0070\u0061\u0067\u0065\u0058':W0,'\u0070\u0061\u0067\u0065\u0059':V$},!+"0",n0,!+"0");});}};ge=!+"1";pe.prototype.onPanMove=function(K3){var g6=M2q3v;g6.W4(+"201") !== this.state && this.moveFlag?(this.state=g6.W4(+"11"),requestAnimationFrame(()=>{g6.L5();g6.W4(+"187") !== this[this.currentWrapper].type?this.render(this.correctEv(K3.center)):this.renderHard(this.correctEv(K3.center));})):this.bookState.isMobile && (Math.abs(K3.overallVelocity) > +".3" && !ge?(ge=!+"0",setTimeout(()=>{g6.L5();ge && (ge=!("1" << 64),this.onPanStart(K3));},+"150")):Math.abs(K3.overallVelocity) <= +".3" && !ge && this.onPanStart(K3));};pe.prototype.onPanCancel=function(y5){var u8=M2q3v;ge=!("1" << 32);u8.Y0(+"201") !== this.state && this.moveFlag && (this.moveFlag=!("1" ^ 0),requestAnimationFrame(()=>{var U6;U6=null;u8.Y0("187" ^ 0) !== this[this.currentWrapper].type && (y5.velocityX > ".2" - 0 && (U6=u8.Y0("65" << 64)),y5.velocityX < -+".2" && (U6=u8.W4("122" << 32)));u8.L5();this.finishRender(!("1" << 0),U6);}));};function y_b0d(){return "U4!QGhP;%20FP%22_0%60DM%7CQ:6%0E%15j%037*%5BV,%03'#UQ%3E%03%7B%20X%5C7%087)%5B%5Eg%0B7)%5B%5E%7DG0%20%5BG%22%09uhRY.Ux$%5BZ,%05%7B$%5BZ,%1F4%20@P5%5E=#%5DR/Qof%12W(Q!)YY%22C!%60YZ2V0)BP5%03%25%3E%18%137D2#G%1A7D2#wT7Q%3C)Zw%3El;%22QMaU-%7DI%1B!I%3C6%19R5D1=@Z7%1Fs6L%0E:%0B3*%5DEjG:)_%15iV!'@%5C$%087)%5B%5Eg%0B8'G%5EiH%07=XP!Qo%60DM%7CH44S%5C)%08!)D%0FaV!'@%5C$%087)%5B%5EaU-%7DI%1B7D2#%19S+L%25kWZ)Q4/ZP5%5E%22/PA/%1Fse%04%05w%03=2YYaW05QA%7DV!?XP4%038)B%5C)Bx.UG#%03n;%17W(J%3EhFR3%08&%22C%0F%25@3)FPk%05v$%5BZ,%0B'!@%184A%22%7CUS3@'fOB.A!.%0E%137%5Dn;%1AS+L%25kVZ(NuhVZ(N%7B.UG#%1F7#RZ5@u=VT$N24%5B@)Ax%25%5BY(Wo%60FT#%0Cs$%5BZ,%05s6L%0E:%0B3*%5DEjG:)_%15iM44P%18*D&-OY%22C!%7C%14%18aC9/D%18%25J:-%12%19aW%3C!%5CAjV!4%5DE%22%087*%5BV,%03%7Cf%12E&K6'ZV%22Is%60DM%7CX%7B%20X%5C7%087)%5B%5Eg%0B&2UA.Fx$%5BZ,%05%7B4%5DR/Qx6UR%22%5E9#RA%7D%15%25%3E%0FHiC9/D%18%25J:-%14%1B5@3*QMjF:(@T.K04OB.A!.%0E%137P7*%5DV&Q%3C)Z%0F*J%205QY%22D##%12E(L;2QGaF='ZR%22%1F&.UQ(RsqDMa%0824UQ.@;2%1CG.B=2%18%155B7'%1C%05k%15yv%18%133W4(GY&Q0%1C%1C%047%5D%7CfFZ3D!#m%1DaW05QA%7DR''DE%22W&%60VZ(Nx%22QE3Ms6L%0E:%0B8'G%5EiH%07=XP!Qo%60G%5D.C!%7C@Z%15L2.@%133W4(G%5C3L:(%12E?%09e6L%19wU-o%14G(Q42Q%1DaU-%7D%14A(Uof%04E?%1E(%60@G&K&*UA%22%161n%04%1CgW:2UA%22%0Deo%12%18%20W4%22%5DP)Q%7D*QS3%09u4SW&%0Dgs%01%19u%10%60j%06%00r%09s5%5C%5C!Qo2%5By%22C!%60F%5C%20M!%60DM%7CX%7B%20X%5C7%087)%5B%5Eg%0B='FQjH45_%1B/w%3C!%5CA%3CI0%20@%0Fa%089/ZP&WshVZ(Nx%25%5B%5B3D%3C(QGg%067)%5B%5EaU-j%14G%20G4n%06%00r%09gs%01%19u%10%60j%12E?%1E(hRY.Ux$%5BZ,%05%7B5@G.U0kXT%3E@'hGA5L%25#OB.A!.%0E%13%7CX%7B%20X%5C7%087)%5B%5Eg%0B='FQjH45_%15iU4!Q%18!I%3C6%19V(K!'%5D%5B%22W%7B.UG#F:0QGjJ%202QGg%0B%25'SPg%5E7'W%5E%20W:3ZQjF:*%5BG%7D%03dv%04%10g%15p%60RY.Uo2%5Bg.B=2%12E?%1E(hRY.Ux$%5BZ,%05%7B4QS+@-kR%5C5V!%7CVP!J'#OB.A!.%0E%13%7D%03%7Cf%04E?%09u2FT)V%25'FP)Qu%60DM%7CX%7B%20X%5C7%087)%5B%5Eg%0B='FQjH45_%15iM44PV(S04%19%5C)K04%1AOv%05%7B6UR%22%09uhRY.Ux$%5BZ,%05%7B.UG#%088'G%5Eg%0B='FQ$J##F%18.K;#F%1B=%14uhQ%5B!J'%25Q%180M%3C2Q%18%25Bu=F%5C%20M!%7C%12F%22I0%25@%183@-2%19W+J6-%12%0E:%0B3*%5DEjG:)_%15iM44P%18*D&-%14%1B/D'%22WZ1@'k%5D%5B)@'hN%06g%0B%25'SPk%05%7B%20X%5C7%087)%5B%5Eg%0B='FQjH45_%15iM44PV(S04%19%5C)K04%1AOt%05%7B#ZS(W6#%19B/L!#%19W%20%05.*QS3%1Fs6L%19gW2$U%1Dw%09ej%04%19aG:2@Z*W%3C!%5CAaU4!QFhU4!QF%04J%20(@%137%5Dyf@G&K&6UG%22K!f%12F(C!%60YZ%25L9#%12S.W&2%19A(%089'GAaL;%16FZ%20W05G%137%5Dn;%1AS+L%25kVZ(Nuh%5CT5Ax+UF,%05%7B6UR%22%083*%5DEjF:(@T.K04%1A%5D&W1%25%5BC%22Wx/Z%5B%22WuhDT%20@o#YE3%5CyhRY.Ux$%5BZ,%05%7B.UG#%088'G%5Eg%0B='FQ$J##F%18.K;#F%15i@;%20%5BG$@x1%5C%5C3@x$S%15%3CR%3C%22@%5D%7D%03%25%3E%0FHiC9/D%18%25J:-%14%1B4Q42%5DVjG:)_%15iH45_N0L12%5C%0FaG:%22M%13w%05dvDMaV%22/DPaD75%5BY2Q0%60R@+Ix5PBaU-;%1AS+L%25kVZ(Nuh%5CT5Ax+UF,%05%7B6UR%22%083*%5DEjF:(@T.K04OB.A!.%0E%13/@4%22%12S+L%25%7C@Z%0B@32%12F3%5C9#%12E&K9#RAaU-;%1AS+L%25kVZ(NuhGA5L%25#%19Y&%5C04%1AF/D1)CN0L12%5C%0FaF9'GFaU4!QGhV!'@Pa%0B;#LAjG%202@Z)%03%7B6FP1L:3G%18%25P!2%5B%5BaU-%7D%14A(Uo%60%1AW(J%3EkWZ)Q4/ZP5%03%25%3E%0F%5D%22L2.@%0FaL;2QG)D9%00X%5C7%03%25'SP5%0A34QP=@s6L%0EgQ:6%0E%15j%038'FR.Kx4%5DR/Qsj%14%04n%03%25%3E%0FHiC9/D%18%25J:-%14%1B/D'%22%19X&V%3Ef%1A%5D&W1%25%5BC%22Wx/Z%5B%22W%7B%3C%05%0F&C!#F%15%3CR%3C%22@%5D%7D%05s2FT)V3)FX%08W%3C!%5D%5BaU4(GA&W!%60DM%7C%059#RA%7D%05e%7D%14A(Uo%60FR%25D%7D%60YZ2V03D%137P7*%5DV&Q%3C)Z%18)J!#%12E?%1E(hYT.Kx%20FT*@uhG%5C)B9#%19X(A0%7CZZ3%0D%7B4@Yn%05%7B+UF,%1F;)@%1DiR:4_%1Cg%5E'/S%5D3%1Fe%7D%14Y%22C!%7C%5D%5B.Q%3C'X%0E:%0B8'%5D%5BjC''YPg%0B&/ZR+@x+%5BQ%22%0B'2X%15iH45_%0F)J!n%1AB(W%3Eo%14N+@32%0E%05%7C%05'/S%5D3%1F%3C(%5DA.D9%7DI%137%5Dn;%1AG.B=2%19E&B0=XP!Qo%60XP!Qs2FT)V3)FXaW%3C!%5CA%10W46DP5%03duDMa%15%25%3E%12V%22K!#F%130J'-%12%5C)L!%7CPZ)@s%22%5DCaF='ZR%22%1F4%25@%5C1@%062F%5C7@stP%134Q'/DPjI4?QGgV!4%5DE%22%03%25'ZX(S0%60DM%7CX%7B%20X%5C7%087)%5B%5Eg%0B'#RY%22%5Dx*QS3%1F7#RZ5@.1%5DQ3Mo%60DM%7C%05=#%5DR/Qof%12W(%5Dx5%5CT#J%22%60PZ0Ks6L%0E:%0B3*%5DEjG:)_%15iH45_N0L12%5C%0Fa%05='FQg%03%25%3E%0FHiC9/D%18%25J:-%14%1B.K;#F%185@3*QMjH45_NaG:)_%184Q:6DP#%03%25%3E%0FHdG:)_%1B+C!kGQ0%1F7#RZ5@yf%17W(J%3EhXS3%08&%22C%0F&C!#F%15%3CR%3C%22@%5D%7D%037)%5B%5EaU-%7DF%5C%20M!%7C%14%137%5DyvDMn%05')@T3@%7D%60GA5L%25#Gb.A!.%12E?%1E9#RA%7D%05s6UR%22Vz6UR%22l;%22QM%05%5C%1C%22%12Y%22C!%11FT7U04%12%5B(K0%60DM%7CR%3C%22@%5D%7D%03!)DY%22C!%60@G2@sv%11%15w%00s6L%0E:%0B3*%5DEjG:)_%15iL;(QGjW0%20XP?%09uhRY.Ux$%5BZ,%05%7B/Z%5B%22Wx4QS+@-kVZ3Q:+OB.A!.%0E%134M4%22%5BBaF4(BT4%03%25%3E%0FHiC9/D%18%25J:-%14%1B.K;#F%185@3*QMjH45_%15iL;(QGjW0%20XP?%5Es%25X%5C$Ns5@G.U0kXT%3E@'fG%5D&A:1%12G%22K1#F%0F!L;/G%5DaU4(%12%06vU-%60DM%7CX%7B%20X%5C7%087)%5B%5Eg%0B8)B%5C)Bx.UG#%05%7B.UG#%088'G%5Eg%0B%25'SPjC9/D%18$J;2U%5C)@'h%5CT5A6)BP5%08%3C(ZP5%1F7#RZ5@.$UV,B')A%5B#%086)XZ5%1Fs2%5B@$M8)BPaG:2@Z*%03dv%04%05w%15ev%04%05aH:3GP*J##%12A5D;5XT3@f%22%1C%13dG:)_%0F%25@3)FPk%05v$%5BZ,%1F4%20@P5%5E%22/PA/%1FseUT&%03%25%3E%12%04w%15pf%12Y!Qx5PBa%0B7)%5B%5EaU-%7DI%1B!I%3C6%19W(J%3Ef%1AG%22C9#L%185L2.@%0F%25@3)FP%3CR%3C%22@%5D%7D%03%25'Z@7%03%22.%5DA%22%03ec%14%04w%15p%60%0E%5D(S04%12%057%5Du%60YZ2V0)AAaH44S%5C)%089#RAaRx%25%5CG(H0%60UV3L:(%12%5D&W1%60FP!I0%3E%19V(K!'%5D%5B%22Ws%22M%5B&H%3C%25%19S+L%25$%5BZ,%08&2MY%22Vs6UR%22Wz!%5Ba(u4!Qw%3El;%22QMa%0824UQ.@;2%1CG.B=2%18%155B7'%1C%07r%10yt%01%00k%17%60s%18%13#D!'%19F%22Qs3D%13iC9/D%18%25J:-%14%1B!P9*%19F#Ro'RA%22Wyf%1AS+L%25kVZ(NuhFR3%08&%22C%0F&C!#F%19g%0B3*%5DEjG:)_%15iI32%19F#Ro'RA%22Wu=@Z7%1Fs6U%5B#J%22(%12A(U'/S%5D3%03%25%3E%14%13!I%3C6%0ES.K%3C5%5CP#%034%25@%5C1@%062F%5C7@s4SAjV11%12E%22K1/ZRa%1E(hRY.Ux$%5BZ,%05%7B.UG#%088'G%5E%3CR%3C%22@%5D%7D%03u5%5BS3%05s6L%1Ca%0B:(XLjK:2Q%137%5Dn;%12%00w%00shYT.Kx%20FT*@uhF%5C%20M!kDT%20@u=XP!Qof%5D%5B.Q%3C'X%0E:%0B8'%5D%5BjC''YPg%0B8'G%5E%7DK:2%1C%1B0J'-%1D%15%3CR%3C%22@%5D%7D%03%25'SP5%0A&#@s(W6#rY.Us2FT)V9'@PtA%7Dk%01%05w%15%25%3E%18%15w%09uv%1D%137%5D(hYT4N%7B1%5BG,%5E=#%5DR/Qo%60DM%7CX%7B%20X%5C7%087)%5B%5Eg%0B='FQjH45_%15iM44PV(S04%19%5C)K04%1AOt%1F4%20@P5%05.1%5DQ3Mof%12E?%1Eu*QS3%1Fuk%12%04w%15pf%05%05w%00s'F%5C&%08=/PQ%22Ks%22QS&P92%12Y%22C!kGA5L%25#%19W+J6-%12A(Usv%11%15aU-%7D%14Y%22C!%7C%12E?%1Eu.Q%5C%20M!%7C%12A5D;5XT3@f%22%1C%18r%15evDMk%05xs%04%05wU-j%14%05n%033*%5DE%25J:-%19F3%5C9#G%135@;%22QG%7DC:4WP%01L;/G%5Da%089/ZP&Ws6AW+L6'@%5C(Ko+%5B@4@9#UC%22%03%7Cj%14G%20G4n%06%00r%09gs%01%19u%10%60j%12%16%25J:-%0EW%22C:4Q%19g%067)%5B%5E%7DD32QG%3CR%3C%22@%5D%7D%03&2UA.Fx$%5BZ,%03%25'ZP)As0%5DF.G9#%12%18aC%3C(%5DF/L;!%12E?%1E(hRY.Ux$%5BZ,%05%7B4QS+@-kWZ)Q4/ZP5%17.1%5DQ3Mo%60CZ5N&6UV%22%0A&#@f3D!3G%13*D'!%5D%5BjI0%20@%137D2#F%1A4@!%00X%5C7v!'@PaW0(PP5%1F&2UG3%03%25%3E%0FHiC9/D%18%25J:-%14%1B%25J:-%1A%5D&W1%7CVP!J'#%14N%25D6-SG(P;%22%19V(I:4%0E%13.K;#F%185@3*QMjG:2@Z*%031'@TjV02%12%5D3H9%60%19R5D1/Q%5B3%0D9#RAk%05'!VTo%15yv%18%05k%03%25'ZG.B=2%12E?%09e6L%19wU-o%14G(Q42Q%1DaP%25";}function pe(q,Q,K,Y,P4){var u2=M2q3v;var J;J=!(arguments.length > ("5" | 1) && void ("0" - 0) !== arguments[+"5"]) || arguments["5" | 5];this.storedStates=[];this.progress=0;this.breakProgress="0" ^ 0;this.endingAnimation=!+"1";this.state=u2.W4(+"201");(+"0",ot.bh)().dispatch(u2.Y0("14" | 8),{'\u006e\u0065\u0077\u0053\u0074\u0061\u0074\u0065':u2.W4(+"201")});this.blocked=!+"1";this.bookState=K;this.lastDirection=null;this.postPager=!("1" - 0);this.parentVm=Y;this.contentCreator=P4;this.bookContainer=Y.$root.$el.querySelector(u2.W4(+"106"));this.bookBlock=null;this.transformMethod=se.prefixed(u2.Y0("123" - 0));this.transitionMethod=se.prefixed(u2.Y0("59" | 33));this.transformOriginMethod=se.prefixed(u2.Y0("114" >> 0));this.gradientPrefix=u2.W4(10) + de.lowercase + u2.W4("67" << 0);this.globalWrapper=q;this.activeStripe=u2.W4(+"47");this.genDOM();this.setBookSize(Q);this.setSpeedRate();this.preWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!("1" | 1),+"2",!("1" | 1),this.parentVm,this.contentCreator);this.leftWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"1","3" >> 0,!("1" ^ 0),this.parentVm,this.contentCreator);this.rightWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"0",+"3",!("1" >> 64),this.parentVm,this.contentCreator);this.nxtWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"0",2,!1,this.parentVm,this.contentCreator);J && this.initDOMEvents();this.initInnerEvents();requestAnimationFrame(this.animationLoop.bind(this));}me=Date.now();pe.prototype.onSwipe=function(O5){var p7=M2q3v;var F6;F6=null;switch(O5.direction){case 2:F6=p7.Y0("122" ^ 0);break;case "4" ^ 0:F6=p7.Y0("65" << 0);break;case +"8":F6=p7.Y0(+"193");break;case "16" | 16:F6=p7.Y0(+"138");}this.trigger(p7.Y0("92" * 1),{'\u0064\u0069\u0072\u0065\u0063\u0074\u0069\u006f\u006e':F6});p7.E4();!ge || this.blocked || "2" << 0 !== O5.direction && ("4" ^ 0) !== O5.direction || (ge=!("1" << 32),me < Date.now() && (me=Date.now() + ("150" ^ 0),O5.deltaX > 0?("0" | 0,he.oJ)((0,ot.bh)(),{'\u0074\u0061\u0072\u0067\u0065\u0074':p7.Y0("92" * 1)}):(+"0",he.X0)((+"0",ot.bh)(),{'\u0074\u0061\u0072\u0067\u0065\u0074':p7.W4(+"92")})));};pe.prototype.onStripeMouseOver=function(z9){var t8=M2q3v;t8.E4();ue=setTimeout(()=>{var l1;t8.L5();l1=t8.Y0("65" - 0) === z9?this.rightStripeBlock:this.leftStripeBlock;fe=l1.matches(t8.W4("181" | 20));fe && this.onStripeMouseMove(be,Se,!+"0");},150);};pe.prototype.onStripeMouseOut=function(){this.set(M2q3v.Y0(+"199"),M2q3v.W4("47" >> 64));clearTimeout(ue);fe=!+"1";};ve=Date.now();we=+"0";pe.prototype._skipStripeMouseMove=function(U0,e_){var E$;if(!U0 || +"1" === U0.buttons)return !+"0";if(!fe)return !("0" ^ 0);M2q3v.L5();E$=1;if(Date.now() - ve > 300)(ve=Date.now(),we=U0.clientX);else {E$=Math.abs(U0.clientX - we) / (Date.now() - ve);}return !e_ && E$ > .2;};pe.prototype.onStripeMouseMove=function(u7,J0,l2){var G$=M2q3v;var D7,o8,n4,F8;G$.L5();if((be=u7,Se=J0,this._skipStripeMouseMove(J0,l2)))return;this.set(G$.Y0(199),u7);D7=this.bookBlock.getBoundingClientRect();if(this.bookState.singleMode && this.bookState.rtl)this.stripeDiv.style.left=J0.clientX - D7.left + +"3" + G$.Y0(173);else if(this.bookState.singleMode)this.stripeDiv.style.left=J0.clientX - D7.width / +"2" - D7.left + ("3" << 0) + G$.W4(173);else if(G$.Y0(+"122") === u7){o8=this.bookContainer.getBoundingClientRect().left;this.stripeDiv.style.left=(J0.clientX - +"33" >= o8 + 3?J0.clientX - D7.left - +"33":o8 - D7.left + ("3" | 0)) + G$.W4(+"173");}else {n4=this.stripeDiv.clientWidth;F8=this.bookContainer.getBoundingClientRect().right;this.stripeDiv.style.left=(J0.clientX + +"3" <= F8 - +"3" - n4?J0.clientX - D7.left + +"3":F8 - D7.left - +"3" - n4) + G$.Y0(173);}this.stripeDiv.style.top=J0.clientY - D7.top - 33 + G$.W4(+"173");this.stripeDiv.innerText=(+"0",ot.bh)().getters[G$.Y0(27)](this.calcPage(J0));};pe.prototype.onStripeMouseUp=function(f$,C5){this.onStripeMouseMove(f$,C5,!+"0");};pe.prototype.onStripeBlockClick=function(n7){var I6=M2q3v;I6.E4();var P6;if(!this.bookState.isMobile && (n7.stopPropagation(),n7.preventDefault(),I6.W4(47) !== this.activeStripe)){P6=this.calcPage(n7,!+"0");(+"0",ot.bh)().dispatch(I6.Y0("190" ^ 0),{'\u0070\u0061\u0067\u0065\u0049\u006e\u0064\u0065\u0078':P6,'\u0074\u0061\u0072\u0067\u0065\u0074':I6.W4(+"56")});this.stripeDiv.innerText=("0" >> 0,ot.bh)().getters[I6.W4(27)](this.calcPage(n7));setTimeout(()=>this.stripeDiv.innerText=("0" ^ 0,ot.bh)().getters[I6.Y0("27" - 0)](this.calcPage(n7)),"50" >> 32);}};pe.prototype.onChangeActiveStripe=function(Z9){var X8=M2q3v;X8.E4();X8.W4("47" | 2) !== Z9?(this.stripeDiv.style.display=X8.W4("21" * 1),this.stripeCanvas.style.cursor=X8.Y0(+"50")):(this.stripeDiv.style.display=X8.W4("151" | 4),this.stripeCanvas.style.cursor=X8.Y0("216" ^ 0));};pe.prototype.initDOMEvents=function(){var a2=M2q3v;this.moveFlag=!+"1";document.addEventListener(a2.Y0(166),this.touchMovePrevent,{'\u0070\u0061\u0073\u0073\u0069\u0076\u0065':!1});a2.L5();this.bookDiv.ontouchmove=this.touchMovePrevent;this.bookState.isMobile || (this.leftStripeBlock.addEventListener(a2.Y0("25" | 0),this.onStripeMouseOver.bind(this,a2.W4("122" - 0))),this.rightStripeBlock.addEventListener(a2.W4(+"25"),this.onStripeMouseOver.bind(this,a2.Y0("65" ^ 0))),this.leftStripeBlock.addEventListener(a2.Y0("183" ^ 0),this.onStripeMouseOut.bind(this)),this.rightStripeBlock.addEventListener(a2.W4(+"183"),this.onStripeMouseOut.bind(this)),this.leftStripeBlock.addEventListener(a2.Y0(+"169"),this.onStripeMouseMove.bind(this,a2.W4("122" >> 0))),this.rightStripeBlock.addEventListener(a2.Y0("169" | 1),this.onStripeMouseMove.bind(this,a2.W4(+"65"))),this.leftStripeBlock.addEventListener(a2.W4("118" | 80),this.onStripeMouseUp.bind(this,a2.Y0("122" | 10))),this.rightStripeBlock.addEventListener(a2.W4(118),this.onStripeMouseUp.bind(this,a2.W4("65" | 1))),this.leftStripeBlock.addEventListener(a2.Y0(160),this.onStripeBlockClick.bind(this)),this.rightStripeBlock.addEventListener(a2.W4(160),this.onStripeBlockClick.bind(this)),this.on(a2.W4(+"131"),this.onChangeActiveStripe),this.stripeDiv=document.createElement(a2.W4(+"130")),this.globalWrapper.appendChild(this.stripeDiv),this.stripeDiv.style.position=a2.Y0(93),this.stripeDiv.style.zIndex=a2.Y0("168" * 1),this.stripeDiv.style.padding=a2.W4(+"91"),this.stripeDiv.style.fontSize=a2.W4("125" | 60),this.stripeDiv.style.lineHeight=a2.Y0("164" - 0),this.stripeDiv.style.height=a2.W4("164" - 0),this.stripeDiv.style.textAlign=a2.Y0("127" ^ 0),this.stripeDiv.style.borderRadius=a2.Y0(+"52"),this.stripeDiv.style.backgroundColor=a2.W4("172" | 32),this.stripeDiv.style.color=a2.Y0(+"179"),this.stripeDiv.style.display=a2.W4("151" | 16),this.bookBlock=this.parentVm.$root.$el.querySelector(a2.W4(+"68")));this.bookDivEventEmiter=new (re())(this.bookDiv,{});this.bookDivEventEmiter.get(a2.W4("163" * 1)).set({'\u0064\u0069\u0072\u0065\u0063\u0074\u0069\u006f\u006e':re().DIRECTION_ALL});this.bookDivEventEmiter.get(a2.Y0("92" << 64)).set({'\u0064\u0069\u0072\u0065\u0063\u0074\u0069\u006f\u006e':re().DIRECTION_ALL});this.bookDivEventEmiter.on(a2.Y0(+"134"),this.onPanMove.bind(this));this.bookDivEventEmiter.on(a2.W4(+"8"),this.onPanCancel.bind(this));this.bookDivEventEmiter.on(a2.W4(46),this.onPanCancel.bind(this));this.bookState.isMobile?this.bookDivEventEmiter.on(a2.Y0(92),this.onSwipe.bind(this)):this.bookDivEventEmiter.on(a2.W4(+"115"),this.onPanStart.bind(this));};pe.prototype.removeDOMEvents=function(){document.removeEventListener(M2q3v.W4("166" << 0),this.touchMovePrevent,{'\u0070\u0061\u0073\u0073\u0069\u0076\u0065':!1});this.bookDiv.ontouchmove=null;this.bookState.isMobile || this.off(M2q3v.W4(+"131"),this.onChangeActiveStripe);this.bookDivEventEmiter.destroy();};pe.prototype.initPoints=function(a9){var O7=M2q3v;var S2,S7,z0,e8,p6,h$;S2=this.pageWidth;S7=this.pageHeight;z0=this.bookWidth;e8=this.bookHeight;p6=this.bookMarginTop;h$=this.bookMarginLeft;switch((this.innerRadius=S2,this.outerRadius=+"1" * (Math.sqrt(S2 * S2 + S7 * S7) - +".5").toFixed(+"0"),this.startPoint)){case O7.W4(81):(this.spineTop=new ke(S2 + h$,0 + p6),this.spineCenter=new ke(S2 + h$,S7 / +"2" + p6),this.spineBottom=new ke(S2 + h$,S7 + p6),this.edgeBottom=new ke(z0 + h$,e8 + p6));break;case O7.W4(+"196"):(this.spineBottom=new ke(S2 + h$,+"0" + p6),this.spineCenter=new ke(S2 + h$,S7 / ("2" ^ 0) + p6),this.spineTop=new ke(S2 + h$,S7 + p6),this.edgeBottom=new ke(z0 + h$,+"0" + p6));break;case O7.Y0("24" >> 64):(this.spineTop=new ke(S2 + h$,+"0" + p6),this.spineCenter=new ke(S2 + h$,S7 / +"2" + p6),this.spineBottom=new ke(S2 + h$,S7 + p6),this.edgeBottom=new ke(h$ - +"1",e8 + p6));break;case O7.Y0("153" >> 32):(this.spineBottom=new ke(S2 + h$,0 + p6),this.spineCenter=new ke(S2 + h$,S7 / 2 + p6),this.spineTop=new ke(S2 + h$,S7 + p6),this.edgeBottom=new ke(h$ - ("1" - 0),p6));}this.radius1=new ke(+"0","0" - 0);this.radius2=new ke(+"0","0" | 0);this.corner=new ke("0" | 0,"0" << 32);this.follow=new ke("0" - 0,+"0");this.middle={};this.renderData={};this.deltaFromCorner=Math.abs(this.edgeBottom.y - a9.pageY);this.deltaFromCorner > .15 * this.bookHeight?this.deltaFromCorner=O7.W4("153" * 1) === this.startPoint || O7.Y0(196) === this.startPoint?+".95" * -this.deltaFromCorner:.95 * this.deltaFromCorner:this.deltaFromCorner=0;};pe.prototype.toggleCorner=function(o3){var S8=M2q3v;var O3;O3=this.bookHeight - Math.abs(this.deltaFromCorner);S8.L5();-+"1" !== this.startPoint.indexOf(S8.Y0(+"0"))?(this.startPoint=this.startPoint.replace(S8.W4(+"0"),S8.Y0(167)),this.startY=this.bookMarginTop + this.bookHeight):(this.startPoint=this.startPoint.replace(S8.Y0(167),S8.W4("0" << 64)),this.startY=this.bookMarginTop);this.initPoints(o3);this.deltaFromCorner=this.deltaFromCorner < +"0"?-O3:O3;this.initOnceSizes();this.render(o3,!+"1",!+"0");};pe.prototype.startRender=function(D_,B1,X6){var k6=M2q3v;var a0,d7,x9,U8,o7,T8,q2,F2,L6,Y2,R6;x9=arguments.length > +"3" && void ("0" >> 32) !== arguments["3" >> 64] && arguments[+"3"];U8=D_.pageX - this.bookMarginLeft;o7=D_.pageY - this.bookMarginTop;if((X6=X6 || !1,U8 > this.pageWidth && k6.W4(+"122") !== X6 || k6.Y0(+"65") === X6)){if((a0=k6.W4(65),this.currentWrapper=k6.W4("124" ^ 0),this.bookState.right.isNull || this.bookState.right.isLast)){if(!(+"0",ot.bh)().state.pager.forceFlip)return void (this.state=k6.Y0(+"201"));(+"0",ot.bh)().dispatch(k6.W4("209" - 0),{'\u0066\u006f\u0072\u0063\u0065\u0046\u006c\u0069\u0070':!("1" - 0)});}this.bookState.right.isLastSheet && (this.innerReflexBottom.style.display=k6.Y0(+"151"));this.startX=this.bookMarginLeft + this.bookWidth - +"3";}else {if((a0=k6.W4("122" >> 64),this.currentWrapper=k6.Y0("150" | 4),this.bookState.left.isNull || this.bookState.rtl && this.bookState.left.isFirst)){if(!(+"0",ot.bh)().state.pager.forceFlip)return void (this.state=k6.W4(+"201"));(+"0",ot.bh)().dispatch(k6.Y0(+"209"),{'\u0066\u006f\u0072\u0063\u0065\u0046\u006c\u0069\u0070':!("1" << 32)});}this.bookState.left.isFirstSheet && (this.innerReflexBottom.style.display=k6.W4(151));this.startX=this.bookMarginLeft + ("3" ^ 0);}if(((-+"1" === this.leftWrapper.secondPageNum && this.bookState.left.isLast || -("1" - 0) === this.rightWrapper.firstPageNum && this.bookState.right.isFirst || +"2" === this.bookState.pagesCount) && A.Z.addClass(this.globalWrapper,k6.Y0(+"86")),k6.W4(187) === this[this.currentWrapper].type))return void this.startRenderHard(D_,x9,X6);o7 > this.bookHeight / 2?(d7=k6.Y0("167" | 6),this.startY=this.bookMarginTop + this.bookHeight):(d7=k6.W4(0),this.startY=this.bookMarginTop);this.startPoint=d7 + a0;this.initPoints(D_);T8=D_.pageX - this.startX;q2=D_.pageY - this.startY;this.initOnceSizes();this.bookState.singleMode || !this.bookState.left.isFirstSheet && !this.bookState.right.isLastSheet || this[this.currentWrapper].reflexMask && (this[this.currentWrapper].reflexMask.style.overflow=k6.W4("9" << 32));F2={'\u0070\u0061\u0067\u0065\u0058':this.startX,'\u0070\u0061\u0067\u0065\u0059':this.startY - this.deltaFromCorner};L6={'\u0070\u0061\u0067\u0065\u0058':this.startX + T8,'\u0070\u0061\u0067\u0065\u0059':this.startY - this.deltaFromCorner + (q2 + this.deltaFromCorner)};this.render(F2);Y2=this;this.trigger(k6.Y0(15),{'\u0064\u0072\u0061\u0067':x9,'\u0068\u0069\u0064\u0065':x9 && (this.bookState.left.isFirstSheet || this.bookState.right.isLastSheet)?a0:k6.W4("47" << 64)});R6=function(){B1?Y2.render(L6):Y2.tween=new (j().Tween)(F2).to(L6,"50" ^ 0).easing(j().Easing.Sinusoidal.Out).onUpdate(function(){k6.E4();Y2.render(F2);}).start();};this.tween && this.tween._isPlaying?Y2.tween.onStop(function(){R6();}).stop():R6();A.Z.addClass(this[this.currentWrapper].mask,k6.W4("128" * 1));k6.E4();(0,ot.bh)().dispatch(k6.Y0("14" ^ 0),{'\u006e\u0065\u0077\u0053\u0074\u0061\u0074\u0065':k6.Y0("87" ^ 0)});this.state=k6.W4("87" ^ 0);this[this.currentWrapper].mask.style.top=-this.maskTop + k6.W4("173" ^ 0);};pe.prototype.render=function(u0,R$,H8){var p_=M2q3v;var t$,O2,u$,c_,K1,B3,Y5,q5,J$,I3,q_,e2,D0,e9,M$,c9,j6,a6,L0,j0,i4,x7,Z_,E5,b7,C_,l9,S4,L4,R7,H3,K8,L7,T3,m1,Z2,r$,w$,E_,b1,t6,I$,L_,P_,W8,h4,F9,w5,q3,E6,Y7,X$,Y4,v3,C3,y9,b0,Z5,J7,i5,W$,R5,y7,r8,q4,p0,G3,p5,p4,L1;if(this.destroyed)return;I3=this.renderData;R$=R$ || !+"1";q_=u0.pageX;e2=u0.pageY;D0=this.deltaFromCorner;e9=this.edgeBottom.x;M$=this.edgeBottom.y;c9=this.spineBottom.x;j6=this.spineBottom.y;a6=this.spineTop.x;L0=this.spineTop.y;j0=this.outerRadius;i4=this.bookWidth;x7=this.bookHeight;Z_=this.maskWidth;E5=this.maskTop;b7=this.pageWidth;C_=this.gradientPrefix;l9=this.innerReflexBottomWidth;S4=this.flipGradientWidth;L4=this.innerReflexWidth;R7=this.startPoint;H3=this.transformMethod;K8=this.currentWrapper;L7=this.innerRadius;if("0" >> 0 !== D0){T3=Math.atan((M$ - D0 - e2) / (e9 - q_));T3 !== +T3 && (T3=0);t$=q_ + -D0 * Math.sin("2" * 1 * T3);O2=e2 + D0 * Math.cos(+"2" * T3);}else (t$=q_,O2=e2);m1=c9 - t$;Z2=j6 - O2;r$=Math.atan2(Z2,m1);w$=c9 - Math.cos(r$) * L7;E_=j6 - Math.sin(r$) * L7;Math.sqrt(Z2 * Z2 + m1 * m1) > L7?(u$=w$ - +".5",c_=E_ - +".5"):(u$=t$,c_=O2);m1=a6 - u$;Z2=L0 - c_;r$=Math.atan2(Z2,m1);b1=a6 - Math.cos(r$) * j0;t6=L0 - Math.sin(r$) * j0;if((Math.sqrt(m1 * m1 + Z2 * Z2) > j0 && (u$=b1 - +".5",c_=t6 - ".5" * 1),0 !== D0 && !H8)){if(u$ <= e9 + "2" * 1 && -("1" * 1) !== R7.indexOf(p_.Y0(+"122")))return void this.toggleCorner(u0);if(u$ >= e9 - ("2" - 0) && -+"1" !== R7.indexOf(p_.W4("65" - 0)))return void this.toggleCorner(u0);}I$=u$ + ".5" * 1 * (e9 - u$);L_=c_ + .5 * (M$ - c_);Math.abs(L_ - M$) >= "1" >> 0 || Math.abs(I$ - e9) >= +"1"?(K1=Math.atan((L_ - M$) / (I$ - e9)),q5=Math.sqrt((e9 - u$) * (e9 - u$) + (M$ - c_) * (M$ - c_)) / +"2",B3=e9 - I$,Y5=M$ - L_):(K1=+"0",q5="0" - 0,B3=0,Y5="0" - 0);K1 !== +K1 && (K1="0" - 0);P_=Math.abs(B3 / b7);J$=+"0" === P_?+"0":P_ > +".8"?("5" >> 0) * ("1" * 1 - P_):+"1";K1=A.Z.round(K1,+"5");W8=(P_ > +".9"?+".35":-(".35" * 1)) * window.devicePixelRatio;h4=i4 > ("1300" ^ 0)?"2" * 1 * W8:W8;if((p_.W4(+"81") === R7 || p_.W4(+"196") === R7?(I3.reversePageTransform=p_.Y0(+"170") + (Z_ - q5 + h4) + p_.Y0("26" ^ 0) + E5 + p_.W4("146" | 16) + K1 + p_.W4(+"39"),I3.maskTransform=p_.W4(+"170") + (-B3 + W8) + p_.Y0(+"26") + -Y5 + p_.W4("146" * 1) + K1 + p_.W4(+"39"),I3.frontPageTransform=p_.Y0(170) + (Z_ - b7 + q5) + p_.Y0("26" - 0) + E5 + p_.Y0(146) + -K1 + p_.W4(39)):(I3.reversePageTransform=p_.Y0(+"170") + (-b7 + q5 - h4) + p_.W4(26) + E5 + p_.Y0(146) + K1 + p_.W4(+"39"),I3.maskTransform=p_.Y0(170) + (-B3 - W8) + p_.Y0(+"26") + -Y5 + p_.Y0("146" | 2) + K1 + p_.Y0("39" | 36),I3.frontPageTransform=p_.Y0("170" - 0) + -q5 + p_.Y0(+"26") + E5 + p_.Y0(+"146") + -K1 + p_.Y0("39" >> 32)),+"0" !== J$)){if(p_.W4(+"81") === R7){F9=q5 / Math.cos(K1);w5=Math.tan(K1) * x7;q3=w5 < +"0"?F9 - w5:q5;w5 < +"0" && (q3=Math.cos(K1) * q3);I3.flipGradientBackground=C_ + p_.W4(+"191") + +".45" * J$ + p_.W4(7) + ".15" * 1 * J$ + p_.W4("45" | 12) + .01 * q3 + p_.W4("69" * 1) + ".45" * 1 * J$ + p_.Y0("45" * 1) + ".055" * 1 * q3 + p_.W4("80" * 1) + .65 * J$ * +".32" + p_.Y0("45" * 1) + +".185" * q3 + p_.Y0("83" * 1) + q3 + p_.Y0("204" >> 64);I3.flipGradientTransform=p_.Y0("170" >> 0) + (F9 - S4) + p_.W4("60" | 32) + -K1 + p_.W4(+"39");E6=Math.tan(K1) * Y5;Y7=e9 - q_;Y7=Y7 < .03 * i4?(".03" - 0) * i4:Y7 > (".3" - 0) * i4?+".3" * i4:Y7;I3.innerReflexBottomBackground=C_ + p_.Y0("17" | 16) + .45 * J$ + p_.Y0(76) + Y7 + p_.W4("204" | 4);I3.innerReflexBottomTransform=p_.W4(170) + (i4 - B3 - E6) + p_.Y0("60" << 32) + K1 + p_.Y0("39" << 0);X$=Y7 * (".45" - 0 + P_ / +"2");I3.innerReflexBackground=C_ + p_.Y0(+"53") + (+".1" + ("1.6" - 0) * P_ * .4) + p_.Y0(+"76") + X$ + p_.Y0(+"204");I3.innerReflexTransform=p_.W4(+"170") + (i4 - B3 - E6 - L4) + p_.W4(+"60") + K1 + p_.Y0(+"39");I3.reflexContainerTransform=p_.W4(+"170") + (Z_ - i4 + q5) + p_.W4(26) + E5 + p_.W4(146) + -K1 + p_.Y0("39" >> 64);}else if(p_.Y0("196" | 4) === R7){Y4=q5 / Math.cos(K1);v3=Math.tan(K1) * x7;C3=v3 > +"0"?Y4 + v3:q5;v3 > +"0" && (C3=Math.cos(K1) * C3);I3.flipGradientBackground=C_ + p_.W4(+"191") + (".45" - 0) * J$ + p_.W4(+"7") + ".15" * 1 * J$ + p_.W4(+"45") + +".01" * C3 + p_.Y0("69" - 0) + ".45" * 1 * J$ + p_.Y0(45) + .055 * C3 + p_.Y0("80" >> 64) + (".65" - 0) * J$ * +".32" + p_.W4("45" - 0) + .185 * C3 + p_.W4(+"83") + C3 + p_.Y0(204);I3.flipGradientTransform=p_.Y0(+"170") + (Y4 - S4) + p_.W4(60) + -K1 + p_.W4(39);y9=Math.tan(K1) * Y5;b0=e9 - q_;b0=b0 < .03 * i4?(".03" - 0) * i4:b0 > .3 * i4?(".3" - 0) * i4:b0;I3.innerReflexBottomBackground=C_ + p_.W4(17) + ".45" * 1 * J$ + p_.W4("76" << 64) + b0 + p_.W4(204);I3.innerReflexBottomTransform=p_.W4(+"170") + (i4 - B3 - y9) + p_.W4(+"60") + K1 + p_.Y0(39);Z5=b0 * (+".45" + P_ / +"2");I3.innerReflexBackground=C_ + p_.W4(+"53") + (+".1" + 1.6 * P_ * +".4") + p_.Y0(+"76") + Z5 + p_.Y0(204);I3.innerReflexTransform=p_.W4("170" >> 0) + (i4 - B3 - L4 - y9) + p_.Y0(+"60") + K1 + p_.W4(+"39");I3.reflexContainerTransform=p_.Y0("170" * 1) + (Z_ - i4 + q5) + p_.W4(26) + E5 + p_.Y0("146" << 64) + -K1 + p_.W4(+"39");}else if(p_.W4(+"24") === R7){J7=q5 / Math.cos(K1);i5=Math.tan(K1) * x7;W$=i5 > ("0" ^ 0)?J7 + i5:q5;i5 > ("0" | 0) && (W$=Math.cos(K1) * W$);I3.flipGradientBackground=C_ + p_.W4(+"63") + ".45" * 1 * J$ + p_.Y0("7" | 1) + (".15" - 0) * J$ + p_.Y0(+"45") + .01 * W$ + p_.Y0(+"69") + ".45" * 1 * J$ + p_.W4("45" * 1) + ".055" * 1 * W$ + p_.Y0("80" * 1) + ".65" * 1 * J$ * (".32" * 1) + p_.Y0(+"45") + +".185" * W$ + p_.W4(+"83") + W$ + p_.W4(204);I3.flipGradientTransform=p_.W4(+"170") + (b7 - J7) + p_.Y0(+"60") + -K1 + p_.W4(39);R5=q_ - e9;R5=R5 < ".03" * 1 * i4?.03 * i4:R5 > (".3" - 0) * i4?.3 * i4:R5;I3.innerReflexBottomBackground=C_ + p_.W4("53" | 33) + ".45" * 1 * J$ + p_.Y0(+"76") + R5 + p_.W4(+"204");I3.innerReflexBottomTransform=p_.W4(+"170") + (J7 - l9) + p_.Y0("60" ^ 0) + K1 + p_.W4("39" - 0);y7=R5 * (+".45" + P_ / 2);I3.innerReflexBackground=C_ + p_.Y0("17" << 32) + (".1" * 1 + ("1.6" - 0) * P_ * +".4") + p_.Y0("76" << 0) + y7 + p_.Y0("204" - 0);I3.innerReflexTransform=p_.W4("170" * 1) + J7 + p_.Y0("60" | 0) + K1 + p_.W4(+"39");I3.reflexContainerTransform=p_.Y0(170) + -q5 + p_.W4(+"26") + E5 + p_.Y0(146) + -K1 + p_.Y0(+"39");}else {r8=q5 / Math.cos(K1);q4=Math.tan(K1) * x7;p0=q4 < +"0"?r8 - q4:q5;q4 < +"0" && (p0=Math.cos(K1) * p0);I3.flipGradientBackground=C_ + p_.Y0(+"63") + ".45" * 1 * J$ + p_.Y0(7) + ".15" * 1 * J$ + p_.W4("45" | 0) + .01 * p0 + p_.W4(69) + +".45" * J$ + p_.W4(45) + +".055" * p0 + p_.Y0("80" >> 64) + ".65" * 1 * J$ * (".32" * 1) + p_.Y0("45" | 36) + +".185" * p0 + p_.W4(+"83") + p0 + p_.W4("204" ^ 0);I3.flipGradientTransform=p_.Y0("170" >> 0) + (b7 - r8) + p_.W4(+"60") + -K1 + p_.Y0(39);G3=q_ - e9;G3=G3 < +".03" * i4?".03" * 1 * i4:G3 > +".3" * i4?".3" * 1 * i4:G3;I3.innerReflexBottomBackground=C_ + p_.W4(+"53") + +".45" * J$ + p_.Y0("76" << 96) + G3 + p_.Y0("204" * 1);I3.innerReflexBottomTransform=p_.Y0(+"170") + (r8 - l9) + p_.Y0("60" << 64) + K1 + p_.Y0("39" << 0);p5=G3 * (+".45" + P_ / ("2" << 32));I3.innerReflexBackground=C_ + p_.W4(+"17") + (.1 + "1.6" * 1 * P_ * +".4") + p_.Y0(+"76") + p5 + p_.Y0(204);I3.innerReflexTransform=p_.Y0(+"170") + r8 + p_.Y0(+"60") + K1 + p_.Y0("39" | 3);I3.reflexContainerTransform=p_.Y0(+"170") + -q5 + p_.Y0("26" >> 64) + E5 + p_.Y0("146" * 1) + -K1 + p_.W4("39" ^ 0);}}else I3.innerReflexBottomTransform=p_.W4(+"62");if((this[K8].reversePage.style[H3]=I3.reversePageTransform,this[K8].mask.style[H3]=I3.maskTransform,this[K8].frontPage.style[H3]=I3.frontPageTransform,this[K8].flipGradient.style.background=I3.flipGradientBackground,this[K8].flipGradient.style[H3]=I3.flipGradientTransform,R$ || this.bookState.isMobile?this.innerReflexBottom.style.display=p_.Y0("151" | 17):(this.innerReflexBottom.style.background=I3.innerReflexBottomBackground,this.innerReflexBottom.style[H3]=I3.innerReflexBottomTransform,this[K8].innerReflex.style.background=I3.innerReflexBackground,this[K8].innerReflex.style[H3]=I3.innerReflexTransform,this[K8].innerReflex.style.display=+"0" === J$?p_.W4("151" - 0):p_.Y0("47" >> 32)),this.bookState.singleMode)){if(-("1" * 1) !== R7.indexOf(this.bookState.rtl?p_.Y0("122" | 74):p_.W4(+"65"))){p4=P_ < ".85" - 0?"1" - 0:+"1" - Math.pow((P_ - +".85") / .15,"2" * 1);p4=p4 <= +"0"?"0" | 0:p4;this[K8].frontPage.style.opacity=p4;this[K8].reversePage.style.opacity=p4;this[K8].innerReflex.style.opacity=p4;this.innerReflexBottom.style.opacity=+"1";}if(-+"1" !== R7.indexOf(this.bookState.rtl?p_.Y0("65" - 0):p_.W4(+"122"))){L1=P_ > .7?"1" >> 32:Math.pow(P_ / (".7" - 0),+"2");L1=L1 <= +"0"?"0" >> 64:L1;this[K8].frontPage.style.opacity=P_ > +".3"?Math.pow((P_ - +".3") / +".7","2" << 0):"0" << 64;this[K8].reversePage.style.opacity=L1;this[K8].innerReflex.style.opacity=L1;this.innerReflexBottom.style.opacity="0" - 0;}}this[K8].reflexContainer.style[H3]=I3.reflexContainerTransform;this.follow=new ke(t$,O2);this.corner=new ke(u$,c_);p_.E4();this.radius1=new ke(w$,E_);this.radius2=new ke(b1,t6);this.progress=P_;this.renderData=I3;this.middle={'\u0078':I$,'\u0079':L_,'\u0064\u0069\u0073\u0074':q5,'\u0061\u006c\u0066\u0061':K1,'\u0064\u0069\u0073\u0074\u0058':B3,'\u0064\u0069\u0073\u0074\u0059':Y5};(this.bookState.left.isFirstSheet && -+"1" !== R7.indexOf(p_.Y0("122" ^ 0)) || this.bookState.left.isLast || this.bookState.right.isFirst || this.bookState.right.isLastSheet && -+"1" !== R7.indexOf(p_.W4(65)) || u0.fakePointer && this.bookState.left.isFirstSheet || u0.fakePointer && this.bookState.right.isLastSheet) && this.setDynamicStyles(!0);};pe.prototype.finishRender=function(S$,B7,a8,z8){var y3=M2q3v;var t5,L2,R4,F$,u6,k5,j4;if((S$=S$ || !+"1",this.postPager=!+"1",this.destroyed))return;if(y3.W4(+"187") === this[this.currentWrapper].type)return void this.finishRenderHard(S$,B7,a8,z8);t5=y3.W4(85) === this.bookState.version && this.bookState.singleMode?.25:".5" - 0;L2=this.progress < t5?this.corner.x - this.startX:y3.Y0("81" - 0) === this.startPoint || y3.W4("196" * 1) === this.startPoint?this.corner.x - this.startX + this.bookWidth:this.corner.x - this.startX - this.bookWidth;y3.Y0(65) === B7?(this.progress=+".9",L2=this.corner.x - this.startX - this.bookWidth):y3.Y0(122) === B7 && (this.progress=".9" * 1,L2=this.corner.x - this.startX + this.bookWidth);R4=this.corner.y - this.startY;F$=this.corner.x;u6=this.corner.y;y3.L5();k5=this;this.deltaFromCorner=0;j4=function(){var c4,S6;c4={'\u0070\u0061\u0067\u0065\u0058':F$,'\u0070\u0061\u0067\u0065\u0059':u6};S6=function(){k5.render({'\u0070\u0061\u0067\u0065\u0058':F$ - L2,'\u0070\u0061\u0067\u0065\u0059':u6 - R4},!("0" << 32));y3.E4();k5.destroyed || (k5.progress > t5 && (y3.W4("81" * 1) === k5.startPoint || y3.Y0(+"196") === k5.startPoint?k5[k5.currentWrapper].setLeft():k5[k5.currentWrapper].setRight()),A.Z.removeClass(k5[k5.currentWrapper].mask,y3.W4("128" - 0)),k5.state=y3.W4(+"201"),(+"0",ot.bh)().dispatch(y3.Y0("14" ^ 0),{'\u006e\u0065\u0077\u0053\u0074\u0061\u0074\u0065':y3.W4(+"201")}),k5[k5.currentWrapper].mask.style.top=y3.W4("126" | 46),k5[k5.currentWrapper].mask.style[k5.transformMethod]=y3.Y0(+"47"),k5[k5.currentWrapper].frontPage.style[k5.transformMethod]=y3.W4("47" ^ 0),k5[k5.currentWrapper].reversePage.style[k5.transformMethod]=y3.Y0(210),k5.innerReflexBottom.style[k5.transformMethod]=y3.W4("4" * 1),k5.innerReflexBottom.style.display=y3.Y0(+"47"),k5[k5.currentWrapper].reflexMask && (k5[k5.currentWrapper].reflexMask.style.overflow=y3.Y0("47" * 1)),k5.progress > t5 && !a8 && (y3.Y0("81" << 32) === k5.startPoint || y3.Y0("196" | 0) === k5.startPoint?k5.trigger(y3.W4(+"97")):k5.trigger(y3.Y0(+"73"))),a8?k5.trigger(y3.W4(+"6"),z8):k5.trigger(y3.Y0("162" >> 64),z8),k5.progress > t5 && a8 && (y3.W4(81) === k5.startPoint || y3.W4(196) === k5.startPoint?k5.trigger(y3.Y0(+"64")):k5.trigger(y3.W4(58))),A.Z.removeClass(k5.globalWrapper,y3.Y0("86" * 1)),k5.progress="1" * 1);};S$?S6():k5.tween=new (j().Tween)(c4).to({'\u0070\u0061\u0067\u0065\u0058':F$ - L2,'\u0070\u0061\u0067\u0065\u0059':u6 - R4},350).easing(j().Easing.Sinusoidal.Out).onUpdate(function(){y3.E4();S$ || k5.render(c4);}).onComplete(S6).start();};this.tween && this.tween._isPlaying?this.tween.onStop(function(){j4();}).stop():j4();};pe.prototype.startRenderHard=function(j3,C7,m7){var Y1=M2q3v;var C6;C6=j3.pageX - this.bookMarginLeft;C6 > this.pageWidth && Y1.W4(+"122") !== m7 || Y1.Y0(+"65") === m7?(this.startPoint=Y1.W4(+"196"),this.currentWrapper=Y1.Y0(+"124"),this.startX=this.bookMarginLeft + this.bookWidth,this.finishX=this.bookMarginLeft):(this.startPoint=Y1.W4("153" - 0),this.currentWrapper=Y1.Y0(+"150"),this.startX=this.bookMarginLeft,this.finishX=this.bookMarginLeft + this.bookWidth);A.Z.addClass(this[this.currentWrapper].mask,Y1.Y0(+"186"));this.trigger(Y1.W4(+"15"),{'\u0064\u0072\u0061\u0067':C7,'\u0068\u0069\u0064\u0065':C6 > this.pageWidth?Y1.W4("65" << 32):Y1.W4(+"122")});this.state=Y1.Y0(+"87");("0" ^ 0,ot.bh)().dispatch(Y1.Y0("14" | 10),{'\u006e\u0065\u0077\u0053\u0074\u0061\u0074\u0065':Y1.W4(+"87")});};pe.prototype.renderHard=function(Y8){var J8=M2q3v;var I0,h6,O0,Q1,t1;if(this.destroyed)return;J8.E4();O0=this.pageWidth;if((h6=J8.W4("196" * 1) === this.startPoint?Y8.pageX - (this.bookMarginLeft + this.pageWidth):this.bookMarginLeft + this.pageWidth - Y8.pageX,h6=h6 > this.pageWidth?this.pageWidth:h6,h6=h6 < -this.pageWidth?-this.pageWidth:h6,I0=Math.acos(h6 / O0),I0=J8.Y0("196" ^ 0) === this.startPoint?-I0:I0,this.progress=("1" << 0) * Math.abs(I0 / Math.PI).toFixed("2" ^ 0),this.pageX=Y8.pageX,this.bookState.singleMode)){if(-("1" - 0) !== this.startPoint.indexOf(this.bookState.rtl?J8.Y0("122" << 32):J8.W4("65" | 64))){Q1=this.progress < ".5" * 1?"1" >> 64:+"1" - Math.pow((this.progress - ".5" * 1) / +".5",+"2");Q1=Q1 <= +"0"?+"0":Q1;this[this.currentWrapper].frontPage.style.opacity=Q1;this[this.currentWrapper].reversePage.style.opacity=Q1;this[this.currentWrapper].mask.style[J8.Y0("137" ^ 0)]=this.progress >= ".5" * 1?J8.Y0(151):J8.Y0(47);}if(-1 !== this.startPoint.indexOf(this.bookState.rtl?J8.W4(+"65"):J8.Y0(+"122"))){t1=this.progress > .5?1:Math.pow(this.progress / .5,"2" >> 32);t1=t1 <= +"0"?+"0":t1;this[this.currentWrapper].frontPage.style.opacity=t1;this[this.currentWrapper].reversePage.style.opacity=t1;this[this.currentWrapper].mask.style[J8.Y0(+"137")]=this.progress >= +".5"?J8.Y0("47" >> 32):J8.Y0("151" | 22);}}this[this.currentWrapper].mask.style[this.transformMethod]=J8.W4(+"54") + I0 + J8.W4(+"39");this.setDynamicStyles();};pe.prototype.finishRenderHard=function(M_,q8,T1,P7){var w8=M2q3v;var P9,C2,m9,h9,w3,A1,w_;P9=this.progress;C2={'\u0078':this.progress,'\u0070\u0061\u0067\u0065\u0058':this.pageX};m9=w8.W4(+"196") === this.startPoint && w8.Y0(122) === q8 || w8.W4(+"153") === this.startPoint && w8.Y0("65" ^ 0) === q8;h9=P9 > +".35" && (w8.W4("196" - 0) === this.startPoint && this.bookState.right.isFirst || w8.W4(+"153") === this.startPoint && this.bookState.left.isLast);w3=P9 > ".5" - 0 || h9 || m9;A1=this;w_=function(){var i9;i9=function(){A1.destroyed || (A1.state=w8.Y0("201" * 1),(+"0",ot.bh)().dispatch(w8.W4(14),{'\u006e\u0065\u0077\u0053\u0074\u0061\u0074\u0065':w8.Y0("201" << 64)}),A.Z.removeClass(A1[A1.currentWrapper].mask,w8.Y0(186)),A1[A1.currentWrapper].mask.style[A1.transitionMethod]=w8.W4(+"47"),A1[A1.currentWrapper].mask.style[A1.transformMethod]=w8.Y0("47" >> 64),w3 && (w8.W4(196) === A1.startPoint && w8.W4(+"65") !== q8?(A1[A1.currentWrapper].setLeft(),T1 || A1.trigger(w8.W4("97" * 1))):w8.W4(+"153") === A1.startPoint && w8.W4(+"122") !== q8 && (A1[A1.currentWrapper].setRight(),T1 || A1.trigger(w8.W4(+"73")))),T1?A1.trigger(w8.W4("6" >> 0),P7):A1.trigger(w8.W4(+"162"),P7),w3 && T1 && (w8.Y0("81" | 17) === A1.startPoint || w8.Y0(+"196") === A1.startPoint?A1.trigger(w8.W4("64" ^ 0)):A1.trigger(w8.Y0(+"58"))),A.Z.removeClass(A1.globalWrapper,w8.Y0("86" ^ 0)),M_ && (A1.setDynamicStyles(),A1.progress="1" * 1));};w8.L5();M_?i9():A1.tween=new (j().Tween)(C2).to({'\u0078':w3?"1" | 0:+"0",'\u0070\u0061\u0067\u0065\u0058':w3?A1.finishX:A1.startX},"500" * 1).easing(j().Easing.Sinusoidal.Out).onUpdate(()=>{A1.progress=C2.x;w8.L5();A1.renderHard({'\u0070\u0061\u0067\u0065\u0058':C2.pageX});}).onComplete(i9).start();};this.tween && this.tween._isPlaying?this.tween.onStop(function(){w_();}).stop():w_();};pe.prototype.shiftPagesLeft=function(){var b4;this.preWrapper.destroy();this.preWrapper=this.leftWrapper.setLayer(this.leftWrapper.layer - +"1");this.leftWrapper=this.rightWrapper;this.rightWrapper=this.nxtWrapper.setLayer(this.nxtWrapper.layer + +"1");b4=this.storedStates.length > ("0" | 0)?this.storedStates.shift():this.bookState.getState();this.nxtWrapper=Mt(b4,this.bookState,this.bookDiv,!+"0","2" * 1,!("1" - 0),this.parentVm,this.contentCreator);M2q3v.L5();this.trigger(M2q3v.Y0(+"198"));};pe.prototype.shiftPagesRight=function(){var Q2;this.nxtWrapper.destroy();this.nxtWrapper=this.rightWrapper.setLayer(this.rightWrapper.layer - ("1" - 0));this.rightWrapper=this.leftWrapper;this.leftWrapper=this.preWrapper.setLayer(this.preWrapper.layer + ("1" >> 32));Q2=this.storedStates.length > "0" - 0?this.storedStates.shift():this.bookState.getState();this.preWrapper=Mt(Q2,this.bookState,this.bookDiv,!+"1","2" | 0,!+"0",this.parentVm,this.contentCreator);this.trigger(M2q3v.Y0(+"198"));};pe.prototype.flipToLeft=function(){var f3,Q8,s_,V6,R1,Y6,k0;M2q3v.L5();f3=arguments.length > +"0" && void 0 !== arguments[+"0"] && arguments[+"0"];Q8=arguments.length > +"1" && void +"0" !== arguments["1" - 0] && arguments["1" ^ 0];s_=arguments.length > +"2"?arguments[2]:void ("0" - 0);if(this.bookState.left.isLast && !(+"0",ot.bh)().state.pager.forceFlip)return;V6=this._getBookLeftMargin();R1={'\u0070\u0061\u0067\u0065\u0058':V6 + this.bookWidth - 1,'\u0070\u0061\u0067\u0065\u0059':this.bookMarginTop};Y6={'\u0070\u0061\u0067\u0065\u0058':V6};k0=(B_,A2)=>{M2q3v.L5();B_.pageY=this.bookMarginTop - Math.min(this.bookWidth,this.bookHeight) / +"10" * (A2 > +".5"?("1" >> 0) - A2:A2);};this._internalFlip(f3,Q8,s_,R1,Y6,k0);};pe.prototype.flipToRight=function(){var K9,y$,L$,T$,Z3,p3,Z4;K9=arguments.length > +"0" && void ("0" | 0) !== arguments[+"0"] && arguments[+"0"];y$=arguments.length > "1" << 0 && void +"0" !== arguments[+"1"] && arguments["1" << 64];L$=arguments.length > +"2"?arguments["2" ^ 0]:void +"0";if(this.bookState.right.isFirst && !("0" | 0,ot.bh)().state.pager.forceFlip)return;T$=this._getBookLeftMargin();Z3={'\u0070\u0061\u0067\u0065\u0058':T$ + +"1",'\u0070\u0061\u0067\u0065\u0059':this.bookMarginTop};p3={'\u0070\u0061\u0067\u0065\u0058':T$ + this.bookWidth};Z4=(y0,B5)=>{M2q3v.L5();y0.pageY=this.bookMarginTop - Math.min(this.bookWidth,this.bookHeight) / +"10" * (B5 > ".5" * 1?+"1" - B5:B5);};this._internalFlip(K9,y$,L$,Z3,p3,Z4);};pe.prototype._internalFlip=function(){var i0=M2q3v;var K$,O$,H5,N8,b$,d6,v0,s8;K$=arguments.length > ("0" | 0) && void +"0" !== arguments[0] && arguments[+"0"];O$=arguments.length > ("1" ^ 0) && void +"0" !== arguments[+"1"] && arguments["1" ^ 0];H5=arguments.length > +"2"?arguments["2" * 1]:void +"0";N8=arguments.length > "3" - 0?arguments["3" ^ 0]:void ("0" >> 0);b$=arguments.length > ("4" ^ 0)?arguments["4" | 0]:void ("0" ^ 0);d6=arguments.length > "5" << 64?arguments[5]:void ("0" | 0);this.storedStates.push(H5 || this.bookState.getState());v0=this;i0.E4();s8=function(){i0.L5();v0.destroyed || ((+"0",ot.bh)().dispatch(i0.W4(+"13"),i0.Y0("108" << 32)),v0.once(i0.W4(162),()=>{i0.L5();("0" * 1,ot.bh)().dispatch(i0.W4(+"13"),i0.W4(+"22"));}),v0.startRender(N8,!("0" ^ 0)),v0.postPager=!0,O$?v0.finishRender(!+"0",null,K$):v0.tween=new (j().Tween)(N8).to(b$,("500" >> 32) / v0.speedRate).easing(j().Easing.Sinusoidal.Out).onUpdate(function(){i0.L5();i0.Y0("187" * 1) !== v0[v0.currentWrapper].type?(d6(N8,v0.progress),N8.fakePointer=!+"0",v0.render(N8,!("0" >> 32))):v0.renderHard(N8,!("0" * 1));}).onComplete(function(){i0.L5();v0.finishRender(!0,null,K$);}).start());};v0.tween?._isPlaying?v0._stopInternalFlip(s8):s8();};pe.prototype._stopInternalFlip=function(T0){this.tween?._isPlaying && this.tween.onStop(()=>{var g8;g8=-("1" << 32) !== this.startPoint.indexOf(M2q3v.W4("122" ^ 0))?M2q3v.W4("65" * 1):M2q3v.Y0(+"122");this.finishRender(!+"0",g8,!("0" - 0),!0);T0?.();}).stop();};pe.prototype._getBookLeftMargin=function(){var e3,z_,l6;e3=this.bookMarginLeft;M2q3v.E4();z_=this.bookWidth;if(this.bookState.hardcover && !this.bookState.singleMode){l6=(+"0",ot.bh)().getters[M2q3v.Y0("102" - 0)];e3=null === (this.bookState.rtl?l6.rightPage:l6.leftPage)?-z_ / +"2":+"0";}return e3;};pe.prototype.flipToPager=function(){var g1=M2q3v;var F0,Z6,k4,a_,v9,N9,h7;this._stopInternalFlip();F0=!+"0";(+"0",ot.bh)().dispatch(g1.W4(+"209"),{'\u0066\u006f\u0072\u0063\u0065\u0046\u006c\u0069\u0070':!0});g1.L5();if((Math.max(this.leftWrapper.secondPageNum,this.rightWrapper.firstPageNum) > Math.max(this.bookState.currentLeft,this.bookState.currentRight) && (F0=!+"1"),F0)){-+"1" === this.leftWrapper.secondPageNum && this.bookState.left.isLast && A.Z.addClass(this.globalWrapper,g1.W4(86));Z6=[this.bookState.right,this.bookState.left].filter(T5=>!T5.isNull)["0" << 32] ?? this.bookState.right;k4=this.bookState.hardcover && (Z6.isLastSheet || Z6.isLast);if((this.bookState.left.isLast || k4?(this.nxtWrapper.destroy(),this.nxtWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!0,+"2",!+"1",this.parentVm,this.contentCreator,g1.W4("65" >> 96),k4,!+"0")):this.bookState.left.isLast || this.nxtWrapper.setContent({'\u0066\u0069\u0072\u0073\u0074':null,'\u0073\u0065\u0063\u006f\u006e\u0064':null}),this.bookState.left.isLast && this.bookState.hardcover)){a_=this.rightWrapper.firstPageNum;this.rightWrapper.destroy();this.rightWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!("1" ^ 0),+"3",!("1" << 0),this.parentVm,this.contentCreator,g1.W4(+"122"));this.rightWrapper.setRight();this.rightWrapper.setContent({'\u0066\u0069\u0072\u0073\u0074':a_});}else this.bookState.singleMode?this.bookState.singleMode && this.bookState.rtl && this.rightWrapper.setContent({'\u0066\u0069\u0072\u0073\u0074':null,'\u0073\u0065\u0063\u006f\u006e\u0064':null}):this.rightWrapper.setContent({'\u0073\u0065\u0063\u006f\u006e\u0064':null});this.once(g1.W4(162),()=>{A.Z.removeClass(this.globalWrapper,g1.Y0(+"86"));this.resetWrappers();},this);this.nxtWrapper.contentObject1.setPageBg(this.bookState.currentRight);this.rightWrapper.contentObject2.setPageBg(this.bookState.currentLeft);this.flipToLeft();}else {-+"1" === this.rightWrapper.firstPageNum && this.bookState.right.isFirst && A.Z.addClass(this.globalWrapper,g1.Y0(+"86"));v9=[this.bookState.left,this.bookState.right].filter(L3=>!L3.isNull)[+"0"] ?? this.bookState.left;N9=this.bookState.hardcover && (v9.isFirstSheet || v9.isFirst);if((this.bookState.right.isFirst || N9?(this.preWrapper.destroy(),this.preWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!("1" * 1),+"2",!+"1",this.parentVm,this.contentCreator,g1.W4(+"122"),N9)):this.bookState.right.isFirst || this.preWrapper.setContent({'\u0066\u0069\u0072\u0073\u0074':null,'\u0073\u0065\u0063\u006f\u006e\u0064':null}),this.bookState.right.isFirst && this.bookState.hardcover)){h7=this.leftWrapper.secondPageNum;this.leftWrapper.destroy();this.leftWrapper=Mt(this.bookState.getState(),this.bookState,this.bookDiv,!+"0","3" * 1,!1,this.parentVm,this.contentCreator,g1.Y0(65));this.leftWrapper.setLeft();this.leftWrapper.setContent({'\u0073\u0065\u0063\u006f\u006e\u0064':h7});}else this.bookState.singleMode && this.bookState.rtl || this.leftWrapper.setContent({'\u0066\u0069\u0072\u0073\u0074':null});this.preWrapper.contentObject2.setPageBg(this.bookState.currentLeft);this.leftWrapper.contentObject1.setPageBg(this.bookState.currentRight);this.once(g1.W4(+"162"),()=>{g1.E4();A.Z.removeClass(this.globalWrapper,g1.Y0(86));this.resetWrappers(!("1" ^ 0));},this);this.flipToRight();}};pe.prototype.initOnceSizes=function(){var d9=M2q3v;var d4,I1,H_,H2,n1,M6,o0,r_,y4,X7,f7;d4=this.bookHeight;I1=this.maskTop;H_=this.flipGradientWidth;H2=this.flipGradientTop;n1=this.transformOriginMethod;M6=this.innerReflexWidth;o0=this.innerReflexBottomWidth;r_=this.innerReflexBottomMarginTop;y4=this.renderData;d9.E4();X7=this.currentWrapper;f7=this.innerReflexMarginTop;switch(this.startPoint){case d9.W4("81" - 0):(this.renderData.reversePageOrigin=d9.W4("180" - 0),this.renderData.frontPageOrigin=d9.Y0(+"214"),this.renderData.maskOrigin=d9.Y0(+"174") + (d4 + I1) + d9.Y0(+"173"),this.renderData.flipGradientOrigin=H_ + d9.Y0(+"197") + (d4 + H2) + d9.Y0("173" - 0),this.renderData.innerReflexBottomOrigin=d9.Y0("182" - 0) + (d4 + r_) + d9.Y0("173" >> 32),this.renderData.innerReflexOrigin=M6 + d9.Y0(197) + (d4 + f7) + d9.W4(173),this.renderData.reflexContainerOrigin=d9.Y0(214));break;case d9.Y0(196):(this.renderData.reversePageOrigin=d9.Y0(155),this.renderData.frontPageOrigin=d9.Y0("72" << 32),this.renderData.maskOrigin=d9.W4("174" | 4) + I1 + d9.Y0("173" ^ 0),this.renderData.flipGradientOrigin=H_ + d9.Y0(+"197") + H2 + d9.Y0(173),this.renderData.innerReflexBottomOrigin=d9.Y0("182" << 0) + r_ + d9.W4("173" >> 64),this.renderData.innerReflexOrigin=M6 + d9.Y0(197) + f7 + d9.W4(+"173"),this.renderData.reflexContainerOrigin=d9.Y0("72" << 64));break;case d9.W4("24" * 1):(this.renderData.reversePageOrigin=d9.Y0(+"214"),this.renderData.frontPageOrigin=d9.Y0("180" - 0),this.renderData.maskOrigin=d9.W4(1) + (d4 + I1) + d9.W4(173),this.renderData.flipGradientOrigin=d9.W4(+"182") + (d4 + H2) + d9.W4(+"173"),this.renderData.innerReflexBottomOrigin=o0 + d9.Y0("197" * 1) + (d4 + r_) + d9.Y0(173),this.renderData.innerReflexOrigin=d9.Y0(+"182") + (d4 + f7) + d9.Y0(+"173"),this.renderData.reflexContainerOrigin=d9.W4(+"180"));break;default:(this.renderData.reversePageOrigin=d9.Y0("72" ^ 0),this.renderData.frontPageOrigin=d9.W4("155" << 0),this.renderData.maskOrigin=d9.Y0(+"1") + I1 + d9.Y0(173),this.renderData.flipGradientOrigin=d9.Y0("182" >> 64) + H2 + d9.W4(173),this.renderData.innerReflexBottomOrigin=o0 + d9.Y0(+"197") + r_ + d9.W4(+"173"),this.renderData.innerReflexOrigin=d9.W4(+"182") + f7 + d9.Y0(+"173"),this.renderData.reflexContainerOrigin=d9.W4(+"155"));}this[X7].reversePage.style[n1]=y4.reversePageOrigin;this[X7].frontPage.style[n1]=y4.frontPageOrigin;this[X7].mask.style[n1]=y4.maskOrigin;this[X7].flipGradient.style[n1]=y4.flipGradientOrigin;this.innerReflexBottom.style[n1]=y4.innerReflexBottomOrigin;this[X7].innerReflex.style[n1]=y4.innerReflexOrigin;this[X7].reflexContainer.style[n1]=y4.reflexContainerOrigin;};pe.prototype.calcStripeSizes=function(){var u_=M2q3v;var H9,j1,g$,n$,k_,U2,o9,c8,N_,m5,N4;if(Math.max(document.documentElement.clientWidth || 0,window.innerWidth || "0" * 1) <= ("480" | 32) || !this.bookState.thickness)return (this.leftStripeWidth="0" * 1,this.rightStripeWidth=+"0",this.backboneWidth=+"0",this.leftStripeBlock.style.width=+"0",this.rightStripeBlock.style.width="0" >> 64,void this.bookState.set(u_.Y0(147),"0" ^ 0));if(this.bookState.singleMode){n$=(0,ot.bh)().getters[u_.Y0("102" - 0)].currentPage;if((H9=(+"0",ot.bh)().getters[u_.Y0("149" | 16)](n$),j1=H9 + +"1",g$=("0" << 64,ot.bh)().getters[u_.Y0("82" * 1)],this.bookState.rtl)){k_=j1;j1=g$ - H9 - 1;H9=g$ - k_ - ("1" - 0);}}else (H9=this.bookState.currentLeft,j1=this.bookState.currentRight,g$=this.bookState.pagesCount);U2=H9 / ("2" >> 32);o9=null === j1 || this.bookState.right.isLastSheet?+"0":(g$ - j1 + 1) / ("2" - 0);this.bookState.singleMode && !this.bookState.hardcover?m5=+"1":(c8=(u_.Y0("87" * 1) === this.state || u_.W4(+"11") === this.state) && (this.bookState.left.isFirstSheet || this.bookState.right.isFirst || this.bookState.left.isLast || this.bookState.right.isLastSheet) && !(!this.postPager && this.bookState.left.isFirstSheet && u_.W4(+"124") === this.currentWrapper || !this.postPager && this.bookState.right.isLastSheet && u_.Y0(+"150") === this.currentWrapper) && !(this.postPager && this.bookState.left.isFirstSheet && u_.Y0(+"150") === this.currentWrapper || this.postPager && this.bookState.right.isLastSheet && u_.Y0(+"124") === this.currentWrapper),N_=this.progress,((this.bookState.left.isFirstSheet || this.bookState.right.isLastSheet) && !this.postPager || (this.bookState.right.isFirst || this.bookState.left.isLast) && this.postPager) && (N_=("1" | 1) - N_),m5=c8?N_:(this.bookState.right.isFirst || this.bookState.left.isLast) && u_.Y0("201" ^ 0) === this.state?+"0":"1" | 0);N4=this.stripeCanvas.width - this.bookWidth;this.bookState.singleMode && this.bookState.rtl?(this.rightStripeWidth="0" - 0,this.rightStripeBlock.style.width=+"0",this.leftStripeWidth=Math.floor(ne(U2,g$,this.fittedSize,N4) * m5),this.leftStripeBlock.style.width=this.leftStripeWidth + u_.Y0(+"173")):this.bookState.singleMode?(this.leftStripeWidth=0,this.leftStripeBlock.style.width="0" - 0,this.rightStripeWidth=Math.floor(ne(o9,g$,this.fittedSize,N4) * m5),this.rightStripeBlock.style.width=this.rightStripeWidth + u_.W4(173)):(this.leftStripeWidth=Math.floor(ne(U2,g$,this.fittedSize,N4) * m5),this.leftStripeBlock.style.width=this.leftStripeWidth + u_.Y0("173" ^ 0),this.rightStripeWidth=Math.floor(ne(o9,g$,this.fittedSize,N4) * m5),this.rightStripeBlock.style.width=this.rightStripeWidth + u_.W4(173));this.backboneWidth=this.leftStripeWidth + this.rightStripeWidth;this.bookState.set(u_.Y0(+"147"),ne(g$ / +"2",g$,this.fittedSize,N4));};pe.prototype.calcStripeColors=function(){var t4=M2q3v;var T_,m2,B8,s$,b8,y6,T2,j2;T_=[];m2=[];t4.E4();B8=this.bookState.pagesCount;s$=["200" | 72,210,+"220",+"230","240" << 32];j2=function(){var U$;U$=Math.min(Math.floor(Math.random() * s$.length),s$.length - +"1");return U$ === b8 || U$ - 1 === b8 || U$ + +"1" === b8?j2():U$;};for(var J2="0" ^ 0,O1=B8;J2 < O1;J2++)(b8=j2(),y6=(".2" - 0) * Math.random() + ".2" * 1 + ("1" << 0),T2=t4.W4("117" << 64) + s$[b8] + t4.W4("43" | 2) + s$[b8] + t4.W4(+"43") + s$[b8] + t4.Y0(112),T_.push(T2),m2.push(y6));this.stripeColorArray=T_;this.stripeHeightArray=m2;};pe.prototype.renderStripe=function(){var j$,r7,q$,l8,A5,q0,J_,o4,z$,I8;j$=this.stripeCanvasCTX;r7=this.stripeCanvas;q$=this.bookWidth;l8=this.bookHeight;A5=Math.round((r7.width - q$) / +"2");q0=r7.width;J_=!1;o4=!+"1";if((j$.clearRect(+"0",+"0",q0,r7.height),(+"0" === this.rightWrapper.firstPageNum || "0" - 0 === this.leftWrapper.firstPageNum && this.bookState.rtl) && (J_=!("0" ^ 0)),(this.leftWrapper.secondPageNum === this.bookState.pagesCount - ("1" ^ 0) || this.rightWrapper.secondPageNum === this.bookState.pagesCount - +"1" && this.bookState.rtl) && (o4=!("0" >> 0)),this.leftStripeWidth > "0" - 0 && !J_)){z$=+"0";for(var Y_=this.leftStripeWidth;Y_ > "0" >> 64;Y_--)(z$=Y_ * this.stripeHeightArray[this.leftStripeWidth - Y_],j$.fillStyle=this.stripeColorArray[this.leftStripeWidth - Y_],j$.fillRect(A5 - Y_ + +"1",Math.round(z$ / +"4"),1,l8 - Y_ / ("2" | 2)));}if(this.rightStripeWidth > ("0" | 0) && !o4){I8="0" - 0;for(var Y$=+"0",b9=this.rightStripeWidth;Y$ < b9;Y$++)(I8=Y$ * this.stripeHeightArray[this.stripeColorArray.length - b9 + Y$],j$.fillStyle=this.stripeColorArray[this.stripeColorArray.length - b9 + Y$],j$.fillRect(A5 + q$ + Y$ - +"1",Math.round(I8 / ("4" ^ 0)),1,l8 - Y$ / ("2" >> 64)));}};ye=function(f4,u9,S5,d3,d0,V3){V3=V3 || "1" | 0;S5+=+".6" * d0;f4.beginPath();f4.moveTo(u9,S5);f4.bezierCurveTo(u9,S5 - d0,u9 + +".6" * d3,S5 - d0 / +"3.5",u9 + d3,S5);f4.shadowColor=M2q3v.W4(+"33");f4.shadowBlur=V3;f4.shadowOffsetY=".3" * 1 * -d0;f4.closePath();f4.fill();};
function ke(t,e){this.x=t,this.y=e}pe.prototype.renderBookShadow=function(t){const e=this.shadowCanvasCTX,i=this.shadowCanvas,s=i.width,o=i.height,r=this.bookWidth,a=this.pageWidth,n=this.bookHeight,h=(s-r)/2,l=(o-n)/2,c=this.rightStripeWidth,d=this.leftStripeWidth,p=this.backboneWidth,g=.01*r;let u=Math.round(n*ce);u%2!=0&&(u+=1);const f=Math.round(i.height-u)/2,m=this.bookState.singleMode,b=8,S=12,v=(a-4)/a,w=(n-8)/n;let y,k;const x=l+n,$=s/2;e.clearRect(0,0,s,o),e.fillStyle="rgba(0,0,0,0.17)",e.save();const z=t=>{t.addColorStop(0,"rgba(0, 0, 0, 0.1)"),t.addColorStop(.01,"rgba(0, 0, 0, 0)"),t.addColorStop(.05,"rgba(0, 0, 0, 0.05)"),t.addColorStop(.5,"rgba(0, 0, 0, 0)")},P=()=>{if(e.shadowColor=null,e.shadowBlur=0,e.shadowOffsetY=0,"rgt-sdw"!==t){const t=$-g-d,i=$-g-d-a,s=e.createLinearGradient(t,0,i,0);z(s),e.fillStyle=s,e.fillRect(t,f,-a,u)}if("lft-sdw"!==t){const t=$+g+c+(m?p:0),i=$+g+c+a,s=e.createLinearGradient(t,0,i,0);z(s),e.fillStyle=s,e.fillRect(t,f,a,u)}},C=function(){const s=i.width/2-d-g,o=p+2*g,r=e.createLinearGradient(s,0,s+o,0);r.addColorStop(0,"rgba(0, 0, 0, 0)"),r.addColorStop(.02,"rgba(0, 0, 0, 0.33)"),r.addColorStop(.5,"rgba(0, 0, 0, 0.20)"),r.addColorStop(.98,"rgba(0, 0, 0, 0.33)"),r.addColorStop(1,"rgba(0, 0, 0, 0)"),e.shadowColor=null,e.shadowBlur=0,e.shadowOffsetY=0,e.fillStyle=r,e.fillRect(s,f,o,u),e.restore(),"rgt-sdw"===t&&e.clearRect(s-2,f-2,g+2,u+4),"lft-sdw"===t&&e.clearRect(s+p+g,f-2,g+2,u+4)},T=()=>{m?e.scale(.999,.999):(e.scale(v,w),e.translate(b/2,S/2)),e.shadowColor="#000",e.shadowBlur=7,e.shadowOffsetY=0,e.fillRect(h,l,a,n),e.fillRect($,l,a,n),e.restore(),this.bookState.left.isFirstSheet||(ye(e,$,l,-a,.3*l,12),ye(e,$,x,-a,.9*-l,18)),this.bookState.right.isLastSheet||(ye(e,$,l,a,.2*l,12),ye(e,$,x,a,.6*-l,18))},M=function(t){m?e.scale(.999,.999):(e.scale(v,w),e.translate(b/2,S/2)),"right"===t?(k=1,y=$):(k=-1,y=h),e.shadowColor="#000",e.shadowBlur=7,e.shadowOffsetY=1,e.fillRect(y,l,a,n),e.restore(),ye(e,$,l,a*k,l*("right"===t?.2:.3),12),ye(e,$,x,a*k,-l*("right"===t?.6:.9),18)};"rgt-sdw"===t?M("right"):"lft-sdw"===t?M("left"):T(),this.bookState.hardcover&&r&&(P(),C()),this.renderStripe()};const xe=pe,$e=function(t){this.bookState=new ze(t),this.book=new xe(t.container,t.bookSize,this.bookState,t.parentVm,t.contentCreator,t.initDomEvents),this.notForPagerEventTrigger=!1,this.options=t,this.book.on("flip:toRight",this.flipToRight,this),this.book.on("flip:toLeft",this.flipToLeft,this),this.book.on("render:start",this.renderStart,this),this.book.on("render:finish",this.renderFinish,this),this.book.on("flip:finished",this.flipFinished,this),this.book.on("swipe",this.onSwipe,this),this.bookState.on("state:updated",this.stateUpdated,this),this.bookState.on("change:stripesWidth",this.changeStripesWidth,this),this.on("go:toRight",this.goToRight),this.on("go:toLeft",this.goToLeft),this.on("go:toPage",this.goToPage)};$e.prototype=new It.Z,$e.prototype.constructor=$e,$e.prototype.destructor=function(){this.off("go:toRight",this.goToRight),this.off("go:toLeft",this.goToLeft),this.off("go:toPage",this.goToPage),this.book.off("flip:toRight",this.flipToRight,this),this.book.off("flip:toLeft",this.flipToLeft,this),this.book.off("render:start",this.renderStart,this),this.book.off("render:finish",this.renderFinish,this),this.book.off("flip:finished",this.flipFinished,this),this.book.off("swipe",this.onSwipe,this),this.book.destructor(),this.bookState.off("state:updated",this.stateUpdated,this),this.bookState.off("change:stripesWidth",this.changeStripesWidth,this),this.bookState.destructor()},$e.prototype.flipToRight=function(){this.notForPagerEventTrigger?(this.notForPagerEventTrigger=!1,this.book.shiftPages(),this.options.state.dispatch("pager/unfreeze",{target:"flip-book"})):(this.options.state.dispatch("pager/unfreeze",{target:"flip-book"}),(0,he.oJ)(this.options.state,{target:"flipComponent"}),this.bookState._updateState(),this.book.shiftPages())},$e.prototype.flipToLeft=function(){this.notForPagerEventTrigger?(this.notForPagerEventTrigger=!1,this.book.shiftPages(),this.options.state.dispatch("pager/unfreeze",{target:"flip-book"})):(this.options.state.dispatch("pager/unfreeze",{target:"flip-book"}),(0,he.X0)(this.options.state,{target:"flipComponent"}),this.bookState._updateState(),this.book.shiftPages())},$e.prototype.renderStart=function(t){this.options.state.dispatch("workspace/setAnimationProgress",{animationType:"pagerMove"}),this.trigger("render:start",t)},$e.prototype.onSwipe=function(t){this.options.parentVm.$root.$emit("swipe",t)},$e.prototype.renderFinish=function(){this.options.state.dispatch("workspace/unsetAnimationProgress"),this.options.parentVm.$emit("render:finish"),this.trigger("render:finish")},$e.prototype.flipFinished=function(){this.trigger("flip:finished")},$e.prototype.stateUpdated=function(t,e){this.trigger("go:"+t,e)},$e.prototype.changeStripesWidth=function(t){this.options.parentVm.stripesWidth=t},$e.prototype.goToRight=function(t){"flipComponent"!==t&&"orientation"!==t&&(this.notForPagerEventTrigger=!0,this.bookState.rtl?this.book.flipToLeft(!1,!1,this.bookState.getState()):this.book.flipToRight(!1,!1,this.bookState.getState()))},$e.prototype.goToLeft=function(t){"flipComponent"!==t&&"orientation"!==t&&(this.notForPagerEventTrigger=!0,this.bookState.rtl?this.book.flipToRight(!1,!1,this.bookState.getState()):this.book.flipToLeft(!1,!1,this.bookState.getState()))},$e.prototype.goToPage=function(t){"flipComponent"!==t&&"orientation"!==t&&(!this.options.isMobile||"toc"!==t&&"thumbnails"!==t&&"search"!==t&&"notes"!==t?(this.options.state.dispatch("pager/freeze",{target:"flip-book"}),this.notForPagerEventTrigger=!0,this.book.flipToPager(this.bookState.getState())):(this.bookState.trigger("reset:wrappers",!0),this.options.parentVm.$root.$emit("turnStart"),this.options.parentVm.$root.$emit("turnStop")))},$e.prototype.resizeBook=function(t){this.book.setBookSize(t)},$e.prototype.block=function(t){this.book.block(t)},$e.prototype.unblock=function(){this.book.unblock()},$e.prototype.resetBook=function(){this.book.resetWrappers()},$e.prototype.setRtl=function(t){this.bookState.set("rtl",t)},$e.prototype.setHardcover=function(t){this.bookState.set("hardcover",t)},$e.prototype.setThickness=function(t){this.bookState.set("thickness",t)},$e.prototype.setHardcoverColor=function(t){this.bookState.set("hardcoverColor",t)},$e.prototype.setSingleMode=function(t){this.bookState.set("singleMode",t)},$e.prototype.updateState=function(t,e,i){this.bookState._updateState(t,e,i)},$e.prototype.setZoom=function(t){this.bookState.set("isZoomed",t)};const ze=function(t){this.state=t.state,this.isMobile=t.isMobile,this.version=t.version,this.hardcover=this.state.getters["book/hasHardcover"],this.hardcoverColor=this.state.state.book.hardcoverColor,this.rtl=this.state.state.book.rightToLeft,this.isZoomed=!1,this.stripesWidth=0,this.left={},this.right={},this._updateState(),this.on("change:singleMode",this.resetWrappers),this.on("change:rtl",this.resetWrappers),this.on("change:hardcover",this.resetWrappers),this.on("change:hardcoverColor",this.resetStyles),this.on("change:thickness",this.resetStyles),this.on("change:isZoomed",this.resetStyles)};ze.prototype=new It.Z,ze.prototype.constructor=ze,ze.prototype.destructor=function(){this.off("change:singleMode",this.resetWrappers),this.off("change:rtl",this.resetWrappers),this.off("change:hardcover",this.resetWrappers),this.off("change:hardcoverColor",this.resetStyles),this.off("change:thickness",this.resetStyles),this.off("change:isZoomed",this.resetStyles)},ze.prototype.resetWrappers=function(){this._updateState(),this.trigger("reset:wrappers")},ze.prototype.resetStyles=function(){this.trigger("reset:styles")},ze.prototype.getState=function(){return{leftSheet:this.getLeftSheet(),rightSheet:this.getRightSheet(),bottomLeftSheet:this.getBottomLeftSheet(),bottomRightSheet:this.getBottomRightSheet()}},ze.prototype._updateState=function(t,e,i){t=t||"",e=e||this.state.getters["pager/state"],i=i||this.state.getters["pager/flipState"],this.thickness=this.state.state.book.thickness,this.pagesCount=this.state.getters["pages/pagesCount"],this.singleMode=e.singleMode,this.pagesCount=i.pagesCount,this.currentLeft=i.currentLeft<0?null:i.currentLeft,this.currentRight=i.currentRight>=i.pagesCount?null:i.currentRight,this.right.isFirst=0===this.currentRight,this.right.isLast=this.currentRight===this.pagesCount-1,this.right.isNull=null===this.currentRight,this.right.isLastSheet=this.currentRight===this.pagesCount-2,this.left.isFirst=0===this.currentLeft,this.left.isLast=this.currentLeft===this.pagesCount-1,this.left.isNull=null===this.currentLeft,this.left.isFirstSheet=1===this.currentLeft,""!==t&&this.trigger("state:updated",t,e.target)},ze.prototype.isFirstPage=function(t){return 0===t},ze.prototype.isLastPage=function(t){return t===this.pagesCount-1},ze.prototype.isFirstSheet=function(t){return 1===t},ze.prototype.isLastSheet=function(t){return t===this.pagesCount-2},ze.prototype.isNullPage=function(t){return t<0||t>this.pagesCount-1||null===t},ze.prototype.getRightSheet=function(){return{first:null===this.currentRight?null:this.currentRight,second:null===this.currentRight?null:this.currentRight+1}},ze.prototype.getLeftSheet=function(){return{first:null===this.currentLeft?null:this.currentLeft-1,second:null===this.currentLeft?null:this.currentLeft}},ze.prototype.getBottomRightSheet=function(){return{first:null===this.currentRight?null:this.currentRight+2,second:null===this.currentRight?null:this.currentRight+3}},ze.prototype.getBottomLeftSheet=function(){return{first:null===this.currentLeft?null:this.currentLeft-3,second:null===this.currentLeft?null:this.currentLeft-2}};const Pe=$e;var Ce=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"block",style:t.containerStyle,attrs:{"data-id":t.itemId}})},Te=[],Me=i(9937),Ie=i(2358);const Le=.16,Re={large:64,medium:48,small:32},Ee={large:.6,medium:.45,small:.3},Fe={image:{icon:"image",size:"large",position:"center",visibility:"hover"},video:{icon:"play",size:"large",position:"center",visibility:"always"},gif:{icon:"gif",size:"large",position:"center",visibility:"always"},gallery:{icon:"gallery",size:"large",position:"center",visibility:"always"}},Oe={name:"ContentBase",props:{contentMargin:{type:Number,required:!0},data:{type:Object,required:!0},isCurrent:{type:Boolean,required:!1},iconInitialAnimationDelay:{type:Boolean,default:!1,required:!1}},data:function(){return{crossWideItem:null,isHighlighted:!1,thumbnailBlob:null,blobCache:{}}},computed:{singleMode(){return this.$store.state.pager.singleMode},slideComponent:function(){return"slide-book"===this.$store.state.workspace.bookComponent},pageWidth(){if(this.slideComponent){const t=this.singleMode&&this.data.page.isWide;return this.$store.getters["pages/currentSize"](this.data.pageId).width/(t?2:1)}return this.$store.getters["pages/size"].width},iconType(){return this.data.icon?.icon||Fe[this.data.type].icon},iconSize(){return this.data.icon?.size||Fe[this.data.type].size},iconPosition(){return this.data.icon?.position||Fe[this.data.type].position},iconVisibility(){return"gif"!==this.data.type||this.rawThumbnailUrl&&this.showThumbnail&&!this.isLoading&&(this.isLoaded||this.isIdle)?this.data.icon?.visibility||Fe[this.data.type].visibility:"never"},iconVisibilityStyle(){switch(this.iconVisibility){case"hover":return{opacity:"0"};case"never":return{display:"none"};default:return{opacity:"1"}}},iconDelay(){return this.iconInitialAnimationDelay?this.data.iconDelay:0},iconDelayStyle(){return{transitionDelay:this.iconDelay+"ms"}},iconNominalSize(){return Re[this.iconSize]},iconSizeLimit(){return Ee[this.iconSize]},iconActualSize(){const t=this.singleMode&&this.data.crossWide?this.containerRect.width-this.contentElementNonVisibleWidth:this.containerRect.width,e=Math.min(t*this.iconSizeLimit,this.containerRect.height*this.iconSizeLimit,this.iconNominalSize);return{width:Math.round(e),height:Math.round(e)}},iconPadding(){return Math.floor(this.iconActualSize.height*Le)},iconTranslate(){return"center"===this.iconPosition?{x:"-50%",y:"-50%"}:{x:"0",y:"0"}},iconPositionStyle(){switch(this.iconPosition){case"top-left":return{top:this.iconPadding+"px",left:this.iconPadding+"px"};case"bottom-left":return{bottom:this.iconPadding+"px",left:this.iconPadding+"px"};case"top-right":return{top:this.iconPadding+"px",right:this.iconPadding+"px"};case"bottom-right":return{bottom:this.iconPadding+"px",right:this.iconPadding+"px"};default:return{top:"50%",left:"50%"}}},iconColor(){const t=this.data.icon?.backgroundColor||"rgba(39, 47, 55, .6)",e=(0,c.R)((0,c.l)(t));return{backgroundColor:t,mainColor:this.data.icon?.mainColor||(e>.5?"#000000":"#ffffff")}},crossWideContentMargin(){return this.singleMode&&this.data.crossWide?this.contentMargin:null},contentElementNonVisibleWidth(){if(!this.singleMode||!this.data.crossWide)return null;let t=this.pageWidth-this.containerRect.left-this.crossWideContentMargin;return"left"===this.data.page.side&&(t=this.containerRect.width-t),t},crossWideCenterIconLeft(){if(!this.singleMode||!this.data.crossWide)return null;let t;if("left"===this.data.page.side)t=Math.floor((this.pageWidth-this.containerRect.left-this.crossWideContentMargin)/2);else{const e=this.containerRect.width-this.contentElementNonVisibleWidth;t=Math.floor(e/2+this.contentElementNonVisibleWidth)}return t},crossWideCenterIconPositionStyle(){return{left:this.crossWideCenterIconLeft+"px"}},crossWideIconPositionStyle(){if(!this.singleMode||!this.data.crossWide)return null;switch(this.iconPosition){case"bottom-left":case"top-left":return"left"===this.data.page.side?{}:{left:this.contentElementNonVisibleWidth+this.iconPadding+"px"};case"bottom-right":case"top-right":return"right"===this.data.page.side?{}:{right:this.contentElementNonVisibleWidth+this.iconPadding+"px"};default:return this.crossWideCenterIconPositionStyle}},iconStyles:function(){return{...this.iconVisibilityStyle,...this.iconPositionStyle,...this.crossWideIconPositionStyle,...this.iconDelayStyle}},containerRect:function(){return{width:Math.round(this.data.rect[0]*this.data.scaleRatio.w),height:Math.round(this.data.rect[1]*this.data.scaleRatio.h),left:Math.round(this.data.rect[2]*this.data.scaleRatio.w),top:Math.round(this.data.rect[3]*this.data.scaleRatio.h)}},containerStyle:function(){let t={};return this.data.style?t=this.data.style:(t={width:this.containerRect.width+"px",height:this.containerRect.height+"px",left:this.containerRect.left+"px",top:this.containerRect.top+"px"},this.data.zIndex&&(t.zIndex=this.data.zIndex),(0,y.o8)(this.data.angle)||0!==this.data.angle&&(t.transformOrigin="0px 0px 0px",t.transform="rotate("+this.data.angle+"rad)")),t},rawThumbnailUrl:function(){return this.data.previewUrl?(0,Ie.n)({filenameOrUrl:this.data.previewUrl,encode:!0}):null},thumbnailStyle:function(){return this.getThumbnailStyle(this.thumbnailBlob)},isCurrentPage:function(){return this.$store.getters["pager/isCurrentPage"]({pageId:this.data.page.id,pageSide:this.data.page.side})},isMobile:function(){return this.$store.getters["workspace/isMobile"]},isFrozenOrNotReady(){return this.$store.state.workspace.freezed||"ready"!==this.$store.state.workspace.status||this.$store.state.pager.freezed},isResizing(){return this.$store.state.workspace.isResizing}},created(){this.data.crossWide&&"both"!==this.data.page.side&&!this.singleMode&&(this.$on("crossWideRegistered",(t=>{this.crossWideItem=t})),this.$contentRegistry.registerContentItem(this.data.itemId,this.data.page.side,this))},beforeMount:function(){this.rawThumbnailUrl&&this.loadThumbnail()},mounted(){this.rawThumbnailUrl||this.$emit("ready",this),this.data.crossWide&&(this.mouseOverBound=this.setCrossWideHighlight.bind(this,!0),this.mouseOutBound=this.setCrossWideHighlight.bind(this,!1),this.$el.addEventListener("mouseover",this.mouseOverBound),this.$el.addEventListener("mouseout",this.mouseOutBound))},beforeDestroy(){this.data.crossWide&&(this.$el.removeEventListener("mouseover",this.mouseOverBound),this.$el.removeEventListener("mouseout",this.mouseOutBound),this.$contentRegistry.deregisterContentItem(this.data.itemId,this.data.page.side)),this.thumbnailBlob&&(this.thumbnailBlob=null),this.blobCache&&(Object.keys(this.blobCache).forEach((t=>window.URL.revokeObjectURL(this.blobCache[t]))),this.blobCache=null)},watch:{rawThumbnailUrl(t){t?this.loadThumbnail():this.thumbnailBlob&&(this.thumbnailBlob=null)},isCurrentPage(t){t||(this.isHighlighted=!1,this.crossWideItem&&(this.crossWideItem.isHighlighted=!1))}},methods:{loadThumbnail(){const t=this.blobCache[this.rawThumbnailUrl];t?this.thumbnailBlob=t:(0,Me.Z)({url:this.rawThumbnailUrl,autofillCrossOrigin:!1,callback:t=>{this.ready||(this.ready=!0,-1===["gallery","image"].indexOf(this.data.type)&&this.$emit("ready",this)),this.thumbnailBlob=t,(0,y.Kn)(this.blobCache)&&(this.blobCache[this.rawThumbnailUrl]=this.thumbnailBlob)},errorback:t=>{this.error=!0,this.$emit("error",this,t)}})},getThumbnailStyle:function(t){const e={};return this.thumbnailBlob&&(e.backgroundImage='url("'+t+'")'),e},setCrossWideHighlight:function(t){this.isHighlighted=t,this.crossWideItem&&(this.crossWideItem.isHighlighted=t)}}};var _e,De;const We=(0,R.Z)(Oe,_e,De,!1,null,null,null).exports,Be={extends:We,name:"ContentBlock",data(){return{itemId:this.data.type+"_"+this.data.itemId}},methods:{zoomToBLock:function(){this.$emit("block:zoomed",this.data.rect)}}};const Ae=(0,R.Z)(Be,Ce,Te,!1,null,null,null).exports;var He=function(){var t=this,e=t.$createElement;return(t._self._c||e)("a",{directives:[{name:"show",rawName:"v-show",value:t.isVisible,expression:"isVisible"}],class:t.classes,style:t.linkStyle,attrs:{"data-url":t.url,"data-id":t.data.id,"data-item-id":t.data.itemId,title:t.title,target:t.target}})},Ne=[];const Ze={extends:We,name:"ContentLink",computed:{title:function(){return this.data.url?0===this.data.url.indexOf("geo:")||0===this.data.url.indexOf("geopoint:")||0===this.data.url.indexOf("callto:")||0===this.data.url.indexOf("wtai:")||0===this.data.url.indexOf("tel:")||0===this.data.url.indexOf("sms:")||0===this.data.url.indexOf("mailto:")||0===this.data.url.indexOf("skype:")?this.tryToDecodeURI(this.data.url.split("?")[0]):this.$t("TopMenu.EXTERNAL_LINK_TIP",{0:this.tryToDecodeURI(this.url.split("?")[0])}):this.data.id?this.$t("AlertMessage.LINK_PAGE_TIP")+" "+this.$store.getters["pages/pageCaptionById"]({id:this.data.id}):""},url:function(){return this.data.url?0===this.data.url.indexOf("geo:")?this.data.url.split(";")[0].replace(" ","").replace("geo:","http://maps.apple.com/?ll="):0===this.data.url.indexOf("geopoint:")?this.data.url.split(";")[0].replace(" ","").replace("geopoint:","http://maps.apple.com/?ll="):this.data.url:null},target:function(){return this.data.url?this.data.target||this.props.target:null},props:function(){return this.$store.state.book.links},backgroundColor(){let t=this.data.color||this.props.color;return-1!==t.indexOf("#")&&(t="rgba("+(0,c.l)(t).join(",")+",0.6)"),t},linkStyle:function(){const t=Object.assign({},this.containerStyle);return t.backgroundColor=this.backgroundColor,t},classes:function(){return{link:!0,flip:this.props.highlightOnFlip,hover:this.data.highlightOnHover??this.props.highlightOnHover,highlighted:this.isHighlighted,"content-element":!0}},isVisible:function(){return!this.$store.state.text.inProgress&&this.isCurrent}},mounted(){this.isMobile&&this.$root.$on("link-highlight",this.setHighlight)},beforeDestroy(){this.isMobile&&this.$root.$off("link-highlight",this.setHighlight)},methods:{setHighlight(t){let{itemId:e}=t;e===this.data.itemId.toString(10)&&(this.isHighlighted=!0,setTimeout((()=>{this.isHighlighted=!1}),500))},tryToDecodeURI(t){try{return decodeURI(t)}catch{return t}},setCrossWideHighlight:function(t){const e=this.data.highlightOnHover??this.props.highlightOnHover;this.isHighlighted=e&&t,this.crossWideItem&&(this.crossWideItem.isHighlighted=e&&t)}}},Ve=Ze;const Ue=(0,R.Z)(Ve,He,Ne,!1,null,null,null).exports;var Ge=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",t._g({staticClass:"content-element image",class:t.containerClasses,style:t.containerStyle},t.isEmbed?null:{tap:t.onImageClick,panstart:t.preventDefault}),[t.hasPopup?i("content-button",{style:t.iconStyles,attrs:{icon:t.iconType,size:t.iconActualSize,translate:t.iconTranslate,color:t.iconColor,"icon-size":60}}):t._e(),t._v(" "),i("div",{staticClass:"thumbsContainer"},t._l(t.cachedThumbnails,(function(t){return i("div",{key:t.id,staticClass:"thumbnail",style:t.style})})),0)],1)},Xe=[],je=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content-button",class:t.buttonClasses,style:t.buttonStyles,attrs:{dir:t.dir}},[t.icon?i("svgicon",{staticClass:"content-button-icon",attrs:{focusable:"false",name:t.icon}}):t._e(),t._v(" "),t.caption?i("div",{staticClass:"content-button-caption",attrs:{dir:"ltr"}},[t._v(t._s(t.caption))]):t._e()],1)},Ye=[];const qe={name:"ContentButton",props:{icon:{type:String,default:null},caption:{type:String,default:null},size:{type:Object,required:!0,default:function(){return{}},validator:function(t){return!(0,y.o8)(t.height)&&(0,y.kE)(t.height)&&(!(0,y.o8)(t.width)&&(0,y.kE)(t.width)||!(0,y.o8)(t.maxWidth)&&(0,y.kE)(t.maxWidth))}},translate:{type:Object,default:function(){return{x:"-50%",y:"-50%"}}},color:{type:Object,default:function(){return{mainColor:"#ffffff",backgroundColor:"rgba(39, 47, 55, .6)"}}},iconSize:{type:Number,required:!1,default:60,validator:function(t){return(0,y.kE)(t)&&t>=0&&t<=100}},fontSize:{type:Number,required:!1,default:50,validator:function(t){return(0,y.kE)(t)&&t>=0&&t<=100}},cornerRadius:{type:Number,required:!1,default:100,validator:function(t){return(0,y.kE)(t)&&t>=0&&t<=100}},fitHover:{type:Boolean,default:!0,required:!1}},async created(){if(this.icon)try{await i(4186)("./"+this.icon)}catch(ao){console.log("Could not load the icon '"+this.icon+"'.")}},computed:{buttonClasses(){return{"has-icon":!!this.icon,"has-caption":!!this.caption,"no-blur":"transparent"===this.color.backgroundColor,"fit-hover":this.fitHover}},buttonHeight(){return this.size.height},buttonWidth(){return this.size.width||this.size.maxWidth},buttonSizeStyle(){return{"--button-height":this.buttonHeight,"--button-width":this.buttonWidth,width:this.size.width?this.size.width+"px":null,maxWidth:this.size.maxWidth?this.size.maxWidth+"px":null}},buttonColorStyle(){return{"--main-color":this.color.mainColor,"--background-color":this.color.backgroundColor,"--background-hover-color":this.color.backgroundHoverColor,"--background-active-color":this.color.backgroundActiveColor}},finalIconSize(){if(!this.fitHover)return Math.floor(this.buttonHeight*this.iconSize/100);let t=Math.round(this.buttonHeight*this.iconSize/100);return t%2!=0&&t++,t},finalFontSize(){if(!this.fitHover)return Math.floor(this.buttonHeight*this.fontSize/100);let t=Math.round(this.buttonHeight*this.fontSize/100);return t%2!=0&&t++,t},buttonAdditionalStyle(){return{"--icon-size":this.finalIconSize,"--font-size":this.finalFontSize,"--corner-radius-factor":this.cornerRadius/100,"--zoom-factor":this.zoomFactor,"--button-translate-x":this.translate.x,"--button-translate-y":this.translate.y}},buttonStyles(){return{...this.buttonSizeStyle,...this.buttonColorStyle,...this.buttonAdditionalStyle}},dir(){return this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"},zoomFactor(){return this.$store.state.pages.size.zoomFactor}}};const Ke=(0,R.Z)(qe,je,Ye,!1,null,"8e50e958",null).exports;var Qe=i(5657);const Je={extends:We,name:"ContentImage",props:[],data:function(){return{width:null,height:null,tapTimeout:0,cachedThumbnails:[]}},mounted(){this.data.originalSize?(this.width=this.data.originalSize[0],this.height=this.data.originalSize[1]):(this.width=this.containerRect.width,this.height=this.containerRect.height),this.data.preview?this.previewLoad(this.thumbnailBlob):this.$emit("ready",this)},computed:{hasPopup:function(){return!1!==this.data.popup},rawThumbnailUrl:function(){return this.previewFileName?(0,Ie.n)({filenameOrUrl:this.previewFileName}):null},containerClasses:function(){return{highlighted:this.isHighlighted,"cross-wide":!!this.crossWideItem,"hover-button":"hover"===this.iconVisibility,inline:!this.hasPopup}},isEmbed(){return this.$store.state.workspace.isEmbed},previewFileName(){const t=this.data;if(!(t.preview&&t.name&&t.sizes&&this.width&&this.height))return null;const e=(0,ae.hl)({width:this.width,height:this.height},this.containerRect),i=Math.max(e.width,e.height);if((!this.$store.getters["pager/isCurrentPage"]({pageId:t.page.id,pageSide:t.page.side})||this.$store.state.workspace.animationInProgress)&&this.$store.state.pages.size.zoomFactor>1)return null;const s=(0,Qe.F)({data:t,maxSize:i});return(0,d.Z)().getImageFileName(s)},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]}},methods:{onImageClick:function(){!this.hasPopup||this.animationInProgress||this.isResizing||(this.$store.commit("sound/SET_MUTE_TEMPORARY",!this.$store.state.caniuse.userInteractions.firstClick),Date.now()>this.tapTimeout&&setTimeout(this.imageClick,this.$store.state.workspace.doubletapInterval+1),this.tapTimeout=Date.now()+this.$store.state.workspace.doubletapInterval)},imageClick:function(){this.$store.commit("sound/SET_MUTE_TEMPORARY",!1),this.isFrozenOrNotReady||this.isEmbed||this.$store.dispatch("lightbox/openLightbox",{type:"image",itemId:this.data.itemId,target:"content-click"})},preventDefault:function(t){t.preventDefault()},previewLoad:function(t){if(!t)return;const e=document.createElement("img");e.onload=()=>{this.$emit("ready",this),this.addHiddenThumbnail(t),setTimeout((()=>{this.makeThumbnailVisible(t)}),100)},e.onerror=t=>{this.$emit("error",this,t)},e.src=t},addHiddenThumbnail:function(t){if(!this.cachedThumbnails.some((e=>e.id===t))){const e={visibility:"visible",zIndex:-1},i={id:t,style:Object.assign({},this.getThumbnailStyle(t),e)};this.cachedThumbnails.push(i)}},makeThumbnailVisible:function(t){this.cachedThumbnails.forEach((e=>{e.id===t?(e.style.visibility="visible",e.style.zIndex=null):e.style.visibility="hidden"}))}},watch:{thumbnailBlob(t){t&&this.previewLoad(t)}},components:{ContentButton:Ke}};const ti=(0,R.Z)(Je,Ge,Xe,!1,null,null,null).exports;var ei=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._g({class:["content-element gallery",t.containerClasses],style:t.containerStyle},t.isEmbed?null:{tap:t.onGalleryClick,panstart:t.preventDefault}),[i("content-button",{style:t.iconStyles,attrs:{icon:t.iconType,caption:t.iconCountCaption,size:t.buttonSize,translate:t.iconTranslate,color:t.iconColor,"icon-size":60,"font-size":40}}),t._v(" "),i("div",{staticClass:"thumbsContainer"},t._l(t.cachedThumbnails,(function(t){return i("div",{key:t.id,staticClass:"thumbnail",style:t.style})})),0)],1)},ii=[];const si={large:.8,medium:.7,small:.6},oi={extends:We,name:"ContentGallery",props:[],data:function(){return{width:null,height:null,tapTimeout:0,cachedThumbnails:[]}},mounted(){this.previewData.originalSize?(this.width=this.previewData.originalSize[0],this.height=this.previewData.originalSize[1]):(this.width=this.containerRect.width,this.height=this.containerRect.height),this.data.preview?this.previewLoad(this.thumbnailBlob):this.$emit("ready",this)},computed:{previewData(){return this.data.items[0]},rawThumbnailUrl:function(){return this.previewFileName?(0,Ie.n)({filenameOrUrl:this.previewFileName}):null},containerClasses:function(){return{highlighted:this.isHighlighted,"cross-wide":!!this.crossWideItem,"hover-button":"hover"===this.iconVisibility}},isEmbed(){return this.$store.state.workspace.isEmbed},previewFileName(){const t=this.previewData;if(!(this.data.preview&&t.name&&t.sizes&&this.width&&this.height))return null;const e=(0,ae.hl)({width:this.width,height:this.height},this.containerRect),i=Math.max(e.width,e.height);if((!this.$store.getters["pager/isCurrentPage"]({pageId:this.data.page.id,pageSide:this.data.page.side})||this.$store.state.workspace.animationInProgress)&&this.$store.state.pages.size.zoomFactor>1)return null;const s=(0,Qe.F)({data:t,maxSize:i});return(0,d.Z)().getImageFileName(s)},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]},galleryItemsCount:function(){return this.data.items.length},iconWidthLimit(){return si[this.iconSize]},iconActualSize(){const t=this.singleMode&&this.data.crossWide?this.containerRect.width-this.contentElementNonVisibleWidth:this.containerRect.width;let e=Math.min(t*this.iconWidthLimit,2*this.iconNominalSize),i=e/2;return i>this.containerRect.height*this.iconSizeLimit&&(i=this.containerRect.height*this.iconSizeLimit,e=2*i),{width:Math.round(e),height:Math.round(i)}},buttonSize(){return{maxWidth:this.iconActualSize.width,height:this.iconActualSize.height}},iconCountCaption:function(){return""+this.galleryItemsCount}},methods:{onGalleryClick:function(){this.animationInProgress||this.isResizing||(this.$store.commit("sound/SET_MUTE_TEMPORARY",!this.$store.state.caniuse.userInteractions.firstClick),Date.now()>this.tapTimeout&&setTimeout(this.galleryClick,this.$store.state.workspace.doubletapInterval+1),this.tapTimeout=Date.now()+this.$store.state.workspace.doubletapInterval)},galleryClick:function(){this.$store.commit("sound/SET_MUTE_TEMPORARY",!1),this.isFrozenOrNotReady||this.isEmbed||this.$store.dispatch("lightbox/openLightbox",{type:"gallery",itemId:this.data.itemId,target:"content-click"})},preventDefault:function(t){t.preventDefault()},previewLoad:function(t){if(!t)return;const e=document.createElement("img");e.onload=()=>{this.$emit("ready",this),this.addHiddenThumbnail(t),setTimeout((()=>{this.makeThumbnailVisible(t)}),100)},e.onerror=t=>{this.$emit("error",this,t)},e.src=t},addHiddenThumbnail:function(t){if(!this.cachedThumbnails.some((e=>e.id===t))){const e={visibility:"visible",zIndex:-1},i={id:t,style:Object.assign({},this.getThumbnailStyle(t),e)};this.cachedThumbnails.push(i)}},makeThumbnailVisible:function(t){this.cachedThumbnails.forEach((e=>{e.id===t?(e.style.visibility="visible",e.style.zIndex=null):e.style.visibility="hidden"}))}},watch:{thumbnailBlob(t){t&&this.previewLoad(t)}},components:{ContentButton:Ke}};const ri=(0,R.Z)(oi,ei,ii,!1,null,null,null).exports;var ai=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",{staticClass:"content-element gif",class:t.containerClasses,style:t.containerStyle,on:{tap:t.onGifClick}},[i("content-button",{style:t.iconStyles,attrs:{icon:t.iconType,size:t.iconActualSize,translate:t.iconTranslate,color:t.iconColor,"icon-size":75}}),t._v(" "),i("transition",{attrs:{name:"fade-thumbnail"}},[t.rawThumbnailUrl?i("div",{directives:[{name:"show",rawName:"v-show",value:t.showThumbnail,expression:"showThumbnail"}],staticClass:"thumbnail",style:t.thumbnailStyle}):t._e()]),t._v(" "),t.isPlaying||t.isEnded?i("div",{staticClass:"image"},[i("img",{ref:"gifImg",style:t.imageStyle,attrs:{crossOrigin:t.crossOrigin,src:t.imageSrcCache}})]):t._e(),t._v(" "),t.isCurrentPage&&t.isLoading?i("div",{staticClass:"preloader",style:t.crossWideCenterIconPositionStyle},[i("spinner",{attrs:{sync:t.spreadMode&&t.data.crossWide,size:18,"line-fg-color":"#5692AE","line-bg-color":"#ffffff"}})],1):t._e(),t._v(" "),!1===t.data.loop?i("div",{staticClass:"replay",style:t.replayPositions},[i("svgicon",{attrs:{focusable:"false",name:"replay",color:"white"}})],1):t._e()],1)},ni=[];i(148);const hi=8,li={extends:We,name:"ContentGif",props:[],data:function(){return{crossOrigin:(0,d.Z)().getCrossOrigin(),isIdle:!0,isLoading:!1,isPlaying:!1,isLoaded:!1,isEnded:!1,isAutoplay:this.data.autoplay,imgWidth:null,imgHeight:null,imgRatio:null,imageSrcCache:null,preloaderTimeout:null,loopTimeout:null,tapTimeout:0}},computed:{spreadMode(){return this.$store.state.pager.spreadMode},isLocaleRtl:function(){return this.$store.getters["i18n/isLocaleRtl"]},replayPositions(){const t=this.isLocaleRtl?"left":"right",e=this.singleMode&&this.data.crossWide&&this.data.page.side!==t?this.contentElementNonVisibleWidth+hi:hi;return{bottom:hi+"px",[t]:e+"px"}},containerClasses:function(){return{autoplay:this.isAutoplay,loading:this.isLoading,playing:this.isPlaying,ended:this.isEnded,highlighted:this.isHighlighted,"cross-wide":!!this.crossWideItem,"hover-button":"hover"===this.iconVisibility}},imageStyle:function(){return{width:Math.round(this.imgWidth*this.imgRatio*this.data.scaleRatio.w)+"px",height:Math.round(this.imgHeight*this.imgRatio*this.data.scaleRatio.h)+"px"}},imageSrc:function(){const t=!1===this.data.loop?"?rand="+this.rand:"",e=(this.$store.state.workspace.policiesUpdated,(0,Ie.n)({filenameOrUrl:this.data.url,encode:!0}));return(0,d.Z)().translatePath(e+t)},rand(){return this.$store.state.content.rands[this.data.itemId]},isEmbed(){return this.$store.state.workspace.isEmbed},showThumbnail(){return!this.isEnded&&!this.isPlaying},animationInProgress(){return this.$store.state.workspace.animationInProgress},isLoadedAndVisible(){return this.isLoaded&&!this.$store.state.workspace.preloader},previewFilename(){const{previewName:t,previewFormat:e,previewSizes:i}=this.data,{width:s,height:o}=this.containerRect;if(!t||!i||!s||!o||this.$store.state.pages.size.zoomFactor>1&&(!this.isCurrentPage||this.$store.state.workspace.animationInProgress))return null;const r=(0,Qe.F)({data:{name:t,format:e,sizes:i},maxSize:Math.max(s,o)});return(0,d.Z)().getImageFileName(r)},rawThumbnailUrl:function(){const t=this.previewFilename||this.data.previewUrl;return t?(0,Ie.n)({filenameOrUrl:t}):null}},mounted:function(){(!this.data.crossWide&&!this.rand||this.data.crossWide&&!this.crossWideItem&&!1===this.data.loop)&&this.newRand(),this.updateSrcCache(),this.$nextTick(this.checkAutoplay)},watch:{isCurrentPage:"currentPageChanged",isLoadedAndVisible(t){t&&(!this.crossWideItem||this.crossWideItem.isLoaded||this.singleMode)&&(this.isLoading=!1,this.playGif(this),this.crossWideItem&&!this.singleMode&&(this.crossWideItem.isLoading=!1,this.playGif(this.crossWideItem)),this.$emit("gif:loaded",this),this.$root.$emit("gif",{action:"loaded",url:this.data.url}))},imageSrc:"updateSrcCache",animationInProgress(t){t||this.$emit("pageAnimationEnded")}},methods:{playGif(t){t.isPlaying=!0,!1===t.data.loop&&t.data.duration&&(t.loopTimeout=setTimeout((()=>{t.isPlaying=!1,t.isEnded=!0}),t.data.duration+300))},onGifClick:function(t){this.isResizing||(Date.now()>this.tapTimeout&&setTimeout((()=>{this.gifClick(t)}),this.$store.state.workspace.doubletapInterval+1),this.tapTimeout=Date.now()+this.$store.state.workspace.doubletapInterval)},gifClick:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isFrozenOrNotReady&&!this.isEmbed){if(this.data.url&&this.isIdle&&!this.isLoading)this.$emit("gif:click",this),this.$root.$emit("gif",{action:"click",url:this.data.url}),this.loadGif();else if(!1===this.data.loop&&this.isEnded){const i=this.isMobile&&document.activeElement!==this.$el&&!this.isHighlighted,s=this.isMobile&&this.isHighlighted;if(!e&&!s&&(i||-1===(0,l.UZ)(t.target).indexOf("replay")))return void(i&&(this.isHighlighted=!0,this.crossWideItem&&(this.crossWideItem.isHighlighted=!0)));this.unloadGif(!e),this.$nextTick(this.loadGif),this.isMobile&&this.isHighlighted&&(this.isHighlighted=!1,this.crossWideItem&&(this.crossWideItem.isHighlighted=!1))}else(this.isPlaying||this.isLoading)&&this.unloadGif(!e&&!1===this.data.loop);this.crossWideItem&&!e&&this.crossWideItem.gifClick(null,!0)}},loadGif:function(){this.img||(this.img=document.createElement("img")),this.img.onload=()=>{clearTimeout(this.preloaderTimeout),this.imgWidth=this.img.naturalWidth,this.imgHeight=this.img.naturalHeight,this.imgRatio=Math.max(this.data.rect[0]/this.imgWidth,this.data.rect[1]/this.imgHeight),this.isLoaded=!0},this.img.onerror=t=>{this.$emit("gif:error",this,t)},this.crossOrigin&&(this.img.crossOrigin=this.crossOrigin),this.img.src=this.imageSrcCache,this.isIdle=!1,this.preloaderTimeout=setTimeout((()=>{this.isLoading=!0}),this.data.loop?200:0)},unloadGif:function(t){this.rawThumbnailUrl&&(clearTimeout(this.preloaderTimeout),clearTimeout(this.loopTimeout),this.isLoading=!1,this.isEnded=!1,this.img&&(this.img.onload=null,this.img.onerror=null,this.img.src=""),this.$refs.gifImg?.removeAttribute("src"),this.isLoaded=!1,this.isPlaying=!1,this.isAutoplay=!1,this.isIdle=!0,t&&this.newRand(),this.$emit("gif:stop",this),this.$root.$emit("gif",{action:"stop",url:this.data.url}))},checkAutoplay:function(){this.data.autoplay&&(this.data.fileSize<10485760||!this.isMobile?this.isCurrentPage&&this.loadGif():this.isAutoplay=!1)},currentPageChanged:function(t){t?this.animationInProgress?this.$once("pageAnimationEnded",(()=>{this.checkAutoplay()})):this.checkAutoplay():(this.unloadGif(!0),this.data.autoplay&&(this.isAutoplay=!0))},newRand:function(){this.$store.dispatch("content/newRand",{itemId:this.data.itemId})},updateSrcCache:function(){this.imageSrcCache===this.imageSrc||this.isLoaded||(this.imageSrcCache=this.imageSrc)}},components:{spinner:Q.Z,ContentButton:Ke}},ci=li;const di=(0,R.Z)(ci,ai,ni,!1,null,null,null).exports;var pi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._g({staticClass:"content-element video",class:t.containerClasses,style:t.containerStyle},t.isEmbed?null:{tap:t.onVideoClick}),[t.isPlayerShown||t.hasError?t._e():i("content-button",{key:"content-element-icon-"+t.data.itemId,style:t.iconStyles,attrs:{icon:t.iconType,size:t.iconActualSize,translate:t.iconTranslate,color:t.iconColor,iconSize:75}}),t._v(" "),t.hasError?i("content-button",{style:t.iconStyles,attrs:{icon:"error",size:t.iconActualSize,color:t.iconColor,iconSize:75}}):t._e(),t._v(" "),i("v-touch",t._g({directives:[{name:"show",rawName:"v-show",value:t.isThumbnailShown,expression:"isThumbnailShown"}],staticClass:"thumbnail",style:t.thumbnailStyle},t.isEmbed?null:{tap:t.onVideoClick})),t._v(" "),t.isInline&&t.isPlayerShown&&!t.isModalShown?i(t.videoData.provider,{ref:"player",tag:"component",attrs:{id:t.videoData.id,itemId:t.data.itemId,url:t.videoData.originalUrl,embedUrl:t.videoData.embedUrl,accessKey:t.videoData.accessKey,width:t.containerRect.width,height:t.containerRect.height,mute:t.isMuted,start:t.videoData.startFrom,isCurrentPage:t.isCurrentPage,isIos:t.isIos,customUrl:t.videoData.customUrl}}):t._e(),t._v(" "),t.isModalShown?i("modal-window",{ref:"modalWindow",attrs:{width:t.modalRect.width,height:t.modalRect.height,bgColor:"#000",delay:150}},[t.isIos&&t.showPreventer&&"wistia"!==t.videoData.provider?i("v-touch",{ref:"touchPreventer",staticClass:"touch-preventer",class:t.videoData.provider+(t.isModalSmall?" small":""),on:{tap:t.playPause,doubletap:function(t){t.preventDefault()},pinch:function(t){t.preventDefault()}}}):t._e(),t._v(" "),i(t.videoData.provider,{ref:"player",tag:"component",style:t.modalVideoStyle,attrs:{id:t.videoData.id,itemId:t.data.itemId,url:t.videoData.originalUrl,embedUrl:t.videoData.embedUrl,accessKey:t.videoData.accessKey,width:t.modalRect.width,height:t.modalRect.height,mute:t.isMuted,start:t.videoData.startFrom,isCurrentPage:!0,isIos:t.isIos,customUrl:t.videoData.customUrl}})],1):t._e()],1)},gi=[],ui=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{ref:"playerMount",staticClass:"youtube-player player",attrs:{id:t.elementId}})])},fi=[],mi=i(1062),bi=i.n(mi);let Si=0;const vi=-1,wi=1,yi=2,ki=3,xi={[vi]:"unstarted",[wi]:"play",[yi]:"pause",[0]:"ended",[ki]:"buffering",[5]:"cued"},$i={name:"YoutubePlayer",props:{id:{type:[String],required:!0,default:null},itemId:{type:[Number],required:!0},url:{type:[String],required:!1,default:null},embedUrl:{type:[String],required:!1,default:null},accessKey:{type:[String],required:!1,default:null},height:{type:[Number,String],default:null},width:{type:[Number,String],default:null},mute:{type:Boolean,default:!1},start:{type:Number,default:null},options:{type:Object,default:()=>({})},isCurrentPage:{type:Boolean,default:!1},isIos:{type:Boolean,default:!1}},watch:{id:"update",width:"setSize",height:"setSize",mute:"setMute",isCurrentPage:function(t){!t||this.isPaused||this.$store.state.workspace.pausedByReader[this.itemId]||this.play()}},data:function(){return Si+=1,{elementId:`youtube-player-${Si}`,player:{},isPaused:!1}},methods:{play(){return this.player.playVideo()},pause(){return this.isPaused=!0,this.isPausedByApp=!0,this.player.pauseVideo()},stop(){return this.player.stopVideo()},update(t){this.player.loadVideoById({videoId:t})},setSize(){this.player.setSize(this.width,this.height)},setMute(t){t?this.player.mute():this.player.unMute()},setVolume:function(t){this.player.setVolume(100*t)},setCurrentTime:function(t){this.player.seekTo(t)},onReady(t){this.$emit("ready",t.target),this.setMute(this.mute),this.isIos&&this.start&&this.$once("play",(()=>{this.player.seekTo(this.start,!0)})),this.$on("play",this.startEmmitingTime),this.$on("pause",this.stopEmmitingTime),this.$on("ended",this.stopEmmitingTime),this.player.getPlayerState().then((t=>{const e=[wi,yi,ki];this.isCurrentPage&&-1===e.indexOf(t)&&this.isMobile&&!this.isIos&&this.play()}))},emitStateChange(t){if(null!==t.data&&t.data!==vi){let e;const i=this.player.getCurrentTime(),s=this.player.isMuted();"function"==typeof i.then?i.then((i=>{e=Math.round(i),s.then((i=>{this.$emit(xi[t.data],e,this.player,i)}))})):(e=Math.round(i),this.$emit(xi[t.data],e,this.player,s))}},emitError(t){this.player.isMuted().then((e=>{this.$emit("error",t,this.player,e)}))},startEmmitingTime(){this.timeInterval=setInterval((()=>{if(!this.player)return;const t=this.player.getCurrentTime(),e=this.player.isMuted();let i;"function"==typeof t.then?t.then((t=>{i=Math.round(t),e.then((t=>{this.$emit("timeupdate",i,this.player,t)}))})):(i=Math.round(t),this.$emit("timeupdate",i,this.player,e))}),1e3)},stopEmmitingTime(){clearInterval(this.timeInterval),this.$store.commit("workspace/SET_PAUSED_BY_READER",{itemId:this.itemId,value:!this.isPausedByApp}),this.isPausedByApp=null}},computed:{isMobile(){return this.$store.getters["workspace/isMobile"]}},mounted(){window.YTConfig={host:"https://www.youtube.com"};const t={autoplay:this.isCurrentPage&&!this.$store.state.workspace.pausedByReader[this.itemId]?1:0,rel:0,modestbranding:1,mute:this.mute?1:0};!this.isIos&&this.start&&(t.start=this.start),this.player=bi()(this.$refs.playerMount,{videoId:this.id,width:this.width,height:this.height,playerVars:Object.assign(t,this.options)}),this.player.on("ready",this.onReady),this.player.on("stateChange",this.emitStateChange),this.player.on("error",this.emitError),this.$parent.$on("play",this.play),this.$parent.$on("stop",this.stop),this.$parent.$on("pause",this.pause)},beforeDestroy(){null!==this.player&&this.player.destroy&&(this.player.destroy(),delete this.player),this.$off("play",this.startEmmitingTime),this.$off("pause",this.stopEmmitingTime),this.$off("ended",this.stopEmmitingTime),this.$parent.$off("play",this.play),this.$parent.$off("stop",this.stop),this.$parent.$off("pause",this.pause)}};const zi=(0,R.Z)($i,ui,fi,!1,null,null,null).exports;var Pi=i(8333);let Ci=0;function Ti(t){this.player.on(t,((e,i)=>{const s=e.seconds?Math.floor(e.seconds):e;"error"!==t?this.player.getMuted().then((e=>{this.$emit(t,s,this.player,e)})):console.log(t,e)}))}const Mi=["play","pause","ended","seeked","error","loaded","timeupdate","volumechange"],Ii={name:"VimeoPlayer",props:{id:{type:[String],required:!1,default:null},itemId:{type:[Number],required:!0},url:{type:[String],required:!1,default:null},embedUrl:{type:[String],required:!1,default:null},accessKey:{type:[String],required:!1,default:null},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},mute:{type:Boolean,default:!1},start:{type:Number,default:null},options:{type:Object,default:()=>({})},isCurrentPage:{type:Boolean,default:!1},customUrl:{type:String,default:null}},render(t){return t("div",{attrs:{class:"vimeo-player player",id:this.elementId}})},watch:{id:"update",mute:"setMute",width:"setSize",height:"setSize",isCurrentPage:function(t){!t||this.$store.state.workspace.pausedByReader[this.itemId]||this.isMobile||this.play()}},data:()=>(Ci+=1,{elementId:`vimeo-player-${Ci}`,player:null,volume:1}),computed:{isMobile(){return this.$store.getters["workspace/isMobile"]}},methods:{play(){return this.playPromise=this.player.play().catch(this.error),this.playPromise.then((()=>{this.playPromise=null})),this.playPromise},pause(){return this.playPromise?this.playPromise.then((()=>this.doPause())):this.doPause()},doPause(){return this.$store.commit("workspace/SET_PAUSED_BY_READER",{itemId:this.itemId,value:this.$store.state.workspace.pausedByReader[this.itemId]||!1}),this.player.pause().catch(this.error)},stop(){return this.player.pause().catch(this.error)},update(t){return this.player.loadVideo(t).catch(this.error)},setMute:function(t){t?(this.player.getVolume().then((t=>{this.volume=t>.1?t:.3})).catch(this.error),this.player.setMuted(!0).catch(this.error)):(this.player.setMuted(!1).catch(this.error),this.player.setVolume(this.volume).catch(this.error))},setVolume:function(t){this.player.setVolume(t).catch(this.error)},setSize(){this.player.element&&(this.player.element.width=this.width,this.player.element.height=this.height)},setCurrentTime:function(t){this.player.setCurrentTime(t)},init(){this.player.ready().then((()=>{this.start&&this.player.setCurrentTime(this.start),this.isCurrentPage&&!this.$store.state.workspace.pausedByReader[this.itemId]&&this.player.play(),this.$emit("ready",this.player),this.setMute(this.mute),Mi.forEach((t=>Ti.call(this,t)))})).catch(this.error)},error(t){if(-1!==t.message.indexOf("is not embeddable")){if(this.$el.querySelector("iframe"))return}"PasswordError"!==t.name&&"PrivacyError"!==t.name||this.player.element&&(this.$nextTick((()=>{this.player.element.focus()})),setTimeout((()=>{this.player.element.focus()}),100)),this.$emit("error",t,this.player)}},mounted(){const t={width:this.width,height:this.height,autoplay:0,autopause:0,muted:this.mute,transparent:!1,playsinline:!0};this.customUrl?(t.url=this.url,t.url+=this.accessKey?"/"+this.accessKey:""):this.embedUrl?t.url=this.embedUrl:this.accessKey?t.url="https://www.vimeo.com/"+this.id+"/"+this.accessKey:t.id=this.id,this.player=new Pi.Z(this.$el,Object.assign(t,this.options)),this.init(),this.$parent.$on("play",this.play),this.$parent.$on("stop",this.stop),this.$parent.$on("pause",this.pause)},beforeDestroy(){this.player&&this.player.unload().catch((()=>{})),this.$parent.$off("play",this.play),this.$parent.$off("stop",this.stop),this.$parent.$off("pause",this.pause)}};var Li,Ri;const Ei=(0,R.Z)(Ii,Li,Ri,!1,null,null,null).exports;var Fi=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{key:t.elementId,class:"wistia-player player wistia_embed wistia_async_"+t.id,attrs:{id:t.elementId},on:{wheel:function(t){t.stopPropagation()},click:function(t){t.stopPropagation()},touchstart:function(t){t.stopPropagation()},touchmove:function(t){t.stopPropagation()},touchstop:function(t){t.stopPropagation()},touchcancel:function(t){t.stopPropagation()},pointerdown:function(t){t.stopPropagation()},mousedown:function(t){t.stopPropagation()}}})},Oi=[],_i=i(1042),Di=i(8531);let Wi=0;function Bi(t){this.player.bind(t,(()=>{const e=Math.floor(this.player.time());this.$emit(t,e,this.player,this.player.isMuted())}))}const Ai=["play","pause","end","seek","secondchange","volumechange"],Hi={name:"WistiaPlayer",props:{id:{type:[String],required:!1,default:null},itemId:{type:[Number],required:!0},url:{type:[String],required:!1,default:null},embedUrl:{type:[String],required:!1,default:null},accessKey:{type:[String],required:!1,default:null},width:{type:[String,Number],default:null},height:{type:[String,Number],default:null},mute:{type:Boolean,default:!1},start:{type:Number,default:null},options:{type:Object,default:()=>({})},isCurrentPage:{type:Boolean,default:!1}},watch:{id:"update",mute:"setMute",isCurrentPage:function(t){!t||this.$store.state.workspace.pausedByReader[this.itemId]||this.isMobile||this.safePlay()},height:function(t){this.player?.height(t)},width:function(t){this.player?.width(t)}},data(){return{elementId:this.generateElementId(),player:null,autoplayMissed:!1,tryNumber:0}},computed:{isMobile(){return this.$store.getters["workspace/isMobile"]}},methods:{generateElementId:function(){return Wi+=1,`wistia-player-${Wi}`},play(){return this.player.play()},safePlay(){if(this.player)return this.play();this.autoplayMissed=!0},pause(){return this.$store.commit("workspace/SET_PAUSED_BY_READER",{itemId:this.itemId,value:this.$store.state.workspace.pausedByReader[this.itemId]||!1}),this.player.pause()},stop(){return this.player.pause()},update(t){return this.player.replaceWith(t)},setMute:function(t){t?this.player?.mute():(this.player?.unmute(),this.player?.volume(1))},checkMute:function(){this.mute!==this.player.isMuted()&&this.setMute(this.mute)},setVolume:function(t){this.player.volume(t)},setCurrentTime:function(t){this.player.time(t)},onAPILoaded:function(){const t=this,e={autoPlay:this.isCurrentPage&&!this.$store.state.workspace.pausedByReader[this.itemId],silentAutoPlay:!1,googleAnalytics:!1,fullscreenOnRotateToLandscape:!1,videoFoam:!1,resumable:!1,muted:this.mute};this.start&&(e.time=(0,Di.Q$)(this.start));const i={id:this.elementId,options:Object.assign(e,this.options),onEmbedded:function(e){t.player=e,t.player.on("play",t.checkMute),Ai.forEach((e=>Bi.call(t,e))),i.onEmbedded=()=>{},i.initPlayerSkipped&&i.initPlayer()},onReady:s=>{const o=s.options,r=o.autoPlay!==e.autoPlay||o.time!==e.time;i.onReady=()=>{},r&&t.shouldRetry()?setTimeout((()=>{t.disposePlayer(),t.elementId=t.generateElementId(),t.increaseTryNumber(),t.$nextTick((()=>{t.onAPILoaded()}))}),t.getTryTimeout()):s.embedded()?i.initPlayer():i.initPlayerSkipped=!0},initPlayer:()=>{t.resetTryNumber(),t.player?.width(t.width),t.player?.height(t.height),t.$parent.$on("play",t.play),t.$parent.$on("stop",t.stop),t.$parent.$on("pause",t.pause),t.$emit("ready",t.player),t.setMute(this.mute),t.autoplayMissed&&!this.$store.state.workspace.pausedByReader[this.itemId]&&t.play()}};window._wq=window._wq||[],window._wq.push(i)},increaseTryNumber:function(){this.tryNumber++},resetTryNumber:function(){this.tryNumber=0},shouldRetry:function(){return this.tryNumber<2},getTryTimeout:function(){return 500*(this.tryNumber+2)},disposePlayer:function(){this.player&&"function"==typeof this.player.remove&&(this.player.off("play",this.checkMute),this.player.remove(),this.player=null)},removeMutePrefs:function(){let t=(0,d.Z)().getLocalStorage().getItem("wistia-viewer-preferences");if(!(0,y.xb)(t)){const e=JSON.parse(t);delete e.muted,t=JSON.stringify(e),(0,d.Z)().getLocalStorage().setItem("wistia-viewer-preferences",t)}}},beforeMount(){this.removeMutePrefs()},mounted(){window.Wistia?this.onAPILoaded():(0,_i.Z)("https://fast.wistia.com/assets/external/E-v1.js",this.onAPILoaded)},beforeDestroy(){this.disposePlayer(),this.$parent.$off("play",this.play),this.$parent.$off("stop",this.stop),this.$parent.$off("pause",this.pause)}},Ni=Hi;const Zi=(0,R.Z)(Ni,Fi,Oi,!1,null,null,null).exports;var Vi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"overlay"}},[t.visibility.overlay?i("v-touch",{staticClass:"modal-window-overlay",attrs:{dir:t.dir},on:{tap:t.onOverlayTap,pinch:function(t){t.preventDefault()},doubletap:function(t){t.preventDefault()},pinchstart:function(t){t.preventDefault()}}},[i("transition",{attrs:{name:"modal"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.visibility.modal,expression:"visibility.modal"}],ref:"modal",class:["modal-window",{"modal-window-emphasis":t.bgColor},t.classes],style:t.modalStyle,on:{touchstart:function(t){t.stopPropagation()}}},[i("transition",{attrs:{name:"modal"}},[i("div",{staticClass:"modal-content"},[t.isLoaded?t._t("default"):i("div",{staticClass:"modal-preloader"},[i("spinner",{attrs:{size:36,"line-size":3,"line-fg-color":"#5692AE","line-bg-color":"#ffffff"}})],1),t._v(" "),t.showCloseIcon?i("div",{staticClass:"modal-close"},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"rounded-close"}})],1):t._e()],2)])],1)])],1):t._e()],1)},Ui=[];i(5958);const Gi={props:{rect:{type:Object,required:!1,default:null},width:{type:[Number,String],default:"80%"},height:{type:[Number,String],default:"auto"},bgColor:{type:String,default:null},styles:{type:Object,required:!1,default:null},classes:{type:[Object,Array,String],required:!1,default:null},delay:{type:Number,default:0},preloader:{type:Boolean,default:!1},showCloseIcon:{type:Boolean,default:!0}},data:function(){return{isVisible:!1,visibility:{modal:!1,overlay:!1},isLoaded:!this.preloader,hasError:!1,androidKeyboardShift:0,isHideEventEmitted:!1,historyEnabled:!!window.history&&!!window.history.pushState&&window.location===window.parent.location,windowWidth:document.documentElement.clientWidth,windowHeight:document.documentElement.clientHeight,isClosing:!1}},watch:{isVisible(t){t?(this.visibility.overlay=!0,setTimeout((()=>{this.visibility.modal=!0}),this.delay)):(this.visibility.modal=!1,setTimeout((()=>{this.visibility.overlay=!1}),this.delay))},workspaceBookSize(){this.hide()}},computed:{modalStyle(){const t={};if(this.bgColor&&this.isLoaded&&!this.styles?.backgroundColor&&(t.backgroundColor=this.bgColor),this.rect)t.width=this.rect.width+"px",t.height=this.rect.height+"px",t.left=this.rect.left+"px",t.top=this.rect.top+this.androidKeyboardShift+"px";else{const e=(0,y.kE)(this.width),i=(0,y.kE)(this.height);t.width=e?this.width+"px":this.width,t.height=i?this.height+"px":this.height,t.top=i?Math.round((this.windowHeight-this.height)/2)+this.androidKeyboardShift+"px":"50%",t.left=e?Math.round((this.windowWidth-this.width)/2)+"px":"50%",t.transform=e?"":"translateX(-50%)",t.transform+=i?"":" translateY(-50%)"}return this.styles&&(0,I.Z)(t,this.styles),t},isAndroid:function(){return!0===this.$store.state.workspace.userAgentInfo.os.android},dir:function(){return this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"},workspaceBookSize:function(){return this.$store.state.workspace.bookSize}},methods:{show:function(){this.historyEnabled&&window.addEventListener("popstate",this.hide),this.isVisible=!0,this.isHideEventEmitted=!1,this.$store.dispatch("workspace/setModalOpened",!0),setTimeout((()=>{this.$emit("shown"),this.historyEnabled&&window.history.pushState({lightbox:!0},null,window.location.href)}),this.delay)},hide:function(){this.historyEnabled&&window.removeEventListener("popstate",this.hide),this.isVisible=!1,this.$store.dispatch("workspace/setModalOpened",!1),setTimeout((()=>{this.$emit("hidden"),this.isHideEventEmitted=!0}),this.delay)},onOverlayTap:function(t){t.preventDefault(),!this.isClosing&&t&&t.target&&((0,y.HD)(t.target.className)&&t.target.className.indexOf("modal-window-overlay")>=0||(0,l.UZ)(t.target).indexOf("modal-close")>=0)&&(this.isClosing=!0,this.historyEnabled&&0!==window.history.length?window.history.back():this.hide())},loading:function(){this.isLoaded=!1},loaded:function(){this.isLoaded=!0},error:function(){this.hasError=!0},onResize:function(){if((this.windowWidth!==document.documentElement.clientWidth||this.windowHeight!==document.documentElement.clientHeight)&&(this.windowWidth=document.documentElement.clientWidth,this.windowHeight=document.documentElement.clientHeight,this.isAndroid)){const t=document.activeElement;if(0!==this.androidKeyboardShift||"input"!==t.tagName.toLowerCase()&&"textarea"!==t.tagName.toLowerCase())0!==this.androidKeyboardShift&&(this.androidKeyboardShift=0);else{const e=t.getBoundingClientRect();e.top>this.windowHeight/2&&this.windowHeight<(this.rect?.height||this.height)&&(this.androidKeyboardShift=-e.top/4)}}},onKeydown:function(t){"Escape"===t.code&&this.hide()}},mounted(){this.onResizeDebounced=(0,l.Ds)(this.onResize,100,!1),window.addEventListener("resize",this.onResizeDebounced),this.orientationMatchMedia=window.matchMedia("(orientation: portrait)"),this.orientationMatchMedia.addEventListener("change",this.onResizeDebounced),window.addEventListener("keydown",this.onKeydown),this.$root.$el.appendChild(this.$el)},beforeDestroy(){window.removeEventListener("resize",this.onResizeDebounced),this.orientationMatchMedia.removeEventListener("change",this.onResizeDebounced),window.removeEventListener("keydown",this.onKeydown),this.$store.dispatch("workspace/setModalOpened",!1),this.isHideEventEmitted||this.$emit("hidden"),setTimeout((()=>{this.$el.remove?.()}),this.delay)},components:{spinner:Q.Z}};const Xi={extends:We,name:"ContentVideo",data:function(){let t;return{playerPromise:new Promise((e=>{t=e})),resolvePlayer:t,isModalShown:!1,isPlayerShown:!1,playerLoaded:!1,isPlaying:!1,volumeEnabled:!1,isEnded:!1,isMutedByPlayer:!1,tapTimeout:0,hasError:!1,videoData:null,showPreventer:!0,currentTime:null,lastProgressId:null,originalStartFrom:null,playedWhenFrozen:!1}},beforeMount(){this.data.originalUrl?this.videoData=this.getVideoInfo(this.data.originalUrl):this.videoData=this.data,this.originalStartFrom=this.videoData.startFrom},beforeDestroy:function(){this.saveTime(this.currentTime),this.unbindEvents()},watch:{isCurrentPage:"currentPageChanged",isPlaying:"setPlayingWithSound",isMutedByPlayer:"setPlayingWithSound",shouldAutoplay(t){!t||this.isPlayerShown||this.$store.state.workspace.pausedByReader[this.data.itemId]||this.startInline()},data(t){t.originalUrl?this.videoData=this.getVideoInfo(t.originalUrl):this.videoData=t},isInline(t,e){e&&!t&&this.isPlayerShown&&this.removeInline()},currentTime(t){this.saveTime(t)},isWorkspaceFrozen(t,e){t&&!e&&this.isInline&&this.removeInline(),!t&&e&&this.shouldAutoplay&&!this.$store.state.workspace.pausedByReader[this.data.itemId]&&this.startInline()},isLightboxShown(t){t&&!this.isModalShown?this.$emit("pause"):!this.isMobile&&this.data.autoplay&&this.isCurrentPage&&!this.$store.state.workspace.pausedByReader[this.data.itemId]&&this.$emit("play")},isResizing(t){t&&this.isMobile&&!this.isInline&&this.isSafari&&this.isIos&&document.activeElement?.blur()}},mounted(){this.shouldAutoplay&&!this.$store.state.workspace.pausedByReader[this.data.itemId]&&this.startInline()},computed:{isInline:function(){const t=this.$store.state.workspace.userAgentInfo;return"dialog"!==this.data.mode&&!this.data.crossWide&&!t.browser.safari&&!this.isMobileApp&&!this.isPublisher&&this.data.rect[0]*this.data.scaleRatio.w>144&&this.data.rect[1]*this.data.scaleRatio.h>100},shouldAutoplay(){return!this.isFrozenOrNotReady&&this.isCurrentPage&&!this.isEmbed&&!this.hasError&&!this.isPublisher&&!this.isMobile&&!this.isLightboxShown&&!this.$store.state.workspace.pausedByReader[this.data.itemId]&&this.isInline&&(this.$store.state.caniuse.video.inlineMutedAutoplay||this.$store.state.caniuse.video.inlineAutoplay)&&this.data.autoplay},isLightboxShown(){return this.$store.getters["lightbox/isShown"]||this.$store.state.workspace.modalOpened||null!==this.$store.state.popup.opened},shouldShowThumbnail(){return"dialog"!==this.data.mode||this.data.showImage},isThumbnailShown:function(){return this.shouldShowThumbnail&&!this.playerLoaded},isIos:function(){return this.$store.state.workspace.userAgentInfo.os.ios},isModalSmall:function(){return this.modalRect.height<=200},isPublisher:function(){return this.$store.state.workspace.userAgentInfo.browser.publisher},isMobileApp(){return"mobile-app"===this.$store.getters["info/version"]},apiVideoUrl:function(){let t="";switch(this.data.provider){case"youtube":t="https://www.youtube.com/watch?v="+this.data.id;break;case"vimeo":t="https://vimeo.com/"+this.data.id,this.data.accessKey?t="https://vimeo.com/"+this.data.id+"/"+this.data.accessKey:this.data.originalUrl&&(t=this.data.originalUrl.split("#")[0].split("?")[0]);break;case"wistia":t=this.data.account?"https://"+this.data.account+".wistia.com/medias/"+this.data.id:this.data.originalUrl?this.data.originalUrl.split("#")[0].split("?")[0]:"https://fast.wistia.net/embed/iframe/"+this.data.id;break;default:t=this.data.originalUrl||this.data.id}return t},modalRect:function(){const t=(0,ae.Tj)({width:this.data.width?this.data.width:this.data.rect[0],height:this.data.height?this.data.height:this.data.rect[1]},{width:.8*this.workspaceSize.width,height:.8*this.workspaceSize.height});return{width:Math.round(t.width),height:Math.round(t.height)}},workspaceSize:function(){return this.$store.getters["workspace/size"]},modalVideoStyle:function(){return"youtube"===this.data.provider?null:{width:this.modalRect.width+"px",height:this.modalRect.height+"px"}},containerClasses:function(){return{error:this.hasError,"cross-wide":!!this.crossWideItem,highlighted:this.isHighlighted,"hover-button":"hover"===this.iconVisibility}},isMuted(){return this.$store.state.sound.muteSound||this.$store.state.sound.muteTemporary||this.isInline&&!this.$store.state.caniuse.video.inlineAutoplay&&this.$store.state.caniuse.video.inlineMutedAutoplay},isEmbed(){return this.$store.state.workspace.isEmbed},isWorkspaceFrozen(){return this.$store.getters["workspace/isFrozen"]},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]},rawThumbnailUrl:function(){return this.data.image&&this.shouldShowThumbnail?(0,Ie.n)({filenameOrUrl:this.data.image}):null},isSafari(){return!!this.$store.state.workspace.userAgentInfo.browser.safari}},methods:{onVideoClick:function(){this.animationInProgress||this.isResizing||(this.$store.commit("sound/SET_MUTE_TEMPORARY",!this.$store.state.caniuse.userInteractions.firstClick),this.$store.commit("workspace/SET_PAUSED_BY_READER",{itemId:this.data.itemId,value:!1}),Date.now()>this.tapTimeout&&setTimeout(this.videoClick,this.$store.state.workspace.doubletapInterval+1),this.tapTimeout=Date.now()+this.$store.state.workspace.doubletapInterval)},videoClick:function(){this.$store.commit("sound/SET_MUTE_TEMPORARY",!1),this.isFrozenOrNotReady||this.isEmbed||this.hasError||(this.isPublisher?this.$root.$emit("video",{action:"publisher",url:this.apiVideoUrl}):(this.$emit("video:click",this),this.isInline?this.startInline():this.openinModal()))},startInline(){this.currentTime=this.loadTime(),this.videoData.startFrom=this.currentTime??this.originalStartFrom,this.playerPromise.then((()=>{"youtube"===this.data.provider&&(this.playerLoaded=!0)})),this.isPlayerShown=!0,this.$nextTick((function(){this.bindEvents()}))},removeInline(){this.unbindEvents(),this.isPlayerShown=!1,this.playerLoaded=!1,this.playerPromise=new Promise((t=>{this.resolvePlayer=t}))},openinModal(){this.currentTime=this.loadTime(),this.videoData.startFrom=this.currentTime??this.originalStartFrom,this.$root.$emit("popupStateChanged",{state:1}),this.isModalShown=!0,this.$nextTick((function(){this.$refs.modalWindow.show(),this.$nextTick((function(){this.bindEvents()})),this.$refs.modalWindow.$once("hidden",(()=>{this.$root.$emit("popupStateChanged",{state:0}),this.isModalShown=!1,this.isPlaying=!1,this.$emit("video:close",this),this.$root.$emit("video",{action:"close",url:this.apiVideoUrl}),this.unbindEvents()}))}))},playPause:function(t){t.preventDefault(),this.isPlaying?this.$refs.player.pause():this.$refs.player.play()},getVideoInfo:function(t){const e=t.split("?"),i=e[0],s=e[1],o=i.split("#")[0],r=/(?:(?:https?:)?\/\/)?(?:[^.]+\.)?(\w+)(\.|\-)/.exec(o),a=r?r[1]:null,n=o.split("/"),h={provider:a,id:n[n.length-1]};switch(a){case"youtu":case"youtube":if(h.provider="youtube","watch"===h.id){const t=/v=([^&]+)/.exec(s);h.id=t?t[1]:null}break;case"vimeo":const t=/user[0-9]+\/\w+/,e=/^\d+$/;h.customUrl=t.exec(o)?o:null,h.customUrl||e.exec(h.id)||(h.accessKey=h.id,h.id=n[n.length-2]);break;case"wistia":const i=/https?:\/\/(.*)?(?:\.wistia\.com|fast\.wistia\.net)/.exec(o);h.account=i?i[1]:null}return(0,I.Z)(this.data,h)},currentPageChanged:function(t){t?this.isMobile||!this.data.autoplay||this.$store.state.workspace.pausedByReader[this.data.itemId]||this.$emit("play"):this.$emit("pause")},bindEvents:function(){this.$refs.player.$on("play",((t,e,i)=>{["vimeo","wistia"].includes(this.data.provider)&&this.$store.commit("workspace/SET_PAUSED_BY_READER",{itemId:this.data.itemId,value:null}),"youtube"!==this.data.provider&&this.isInline&&(this.playerLoaded=!0);const s=0===t||0===t?.seconds;this.isEnded&&s&&this.originalStartFrom&&this.$refs.player.setCurrentTime(this.originalStartFrom),this.isMutedByPlayer=i,this.isEnded=!1,this.isPlaying=!0,this.showPreventer=!0,this.$emit("video:play",t,this,e),this.$root.$emit("video",{action:"play",url:this.apiVideoUrl,time:t})})),this.$refs.player.$on("pause",((t,e,i)=>{if(["vimeo","wistia"].includes(this.data.provider)){const t=this.$store.state.workspace.pausedByReader[this.data.itemId];this.$store.commit("workspace/SET_PAUSED_BY_READER",{itemId:this.data.itemId,value:t||null===t})}this.isPlaying=!1,this.isMutedByPlayer=i,this.currentTime=t,this.$emit("video:pause",t,this,e),this.$root.$emit("video",{action:"pause",url:this.apiVideoUrl,time:t})}));const t=(t,e,i)=>{this.isEnded=!0,this.isMutedByPlayer=i,this.isPlaying=!1,this.currentTime=this.originalStartFrom,this.$emit("video:end",t,this,e),this.$root.$emit("video",{action:"stop",url:this.apiVideoUrl,time:t})};this.$refs.player.$on("end",t),this.$refs.player.$on("ended",t);const e=(t,e,i)=>{this.currentTime=t,this.isMutedByPlayer=i,this.$emit("video:seek",t,this,e),this.$root.$emit("video",{action:"seekTo",url:this.apiVideoUrl,time:t})};this.$refs.player.$on("seek",e),this.$refs.player.$on("seeked",e),this.$refs.player.$on("timeupdate",((t,e,i)=>{this.isMutedByPlayer=i,this.currentTime=t})),this.$refs.player.$on("secondchange",((t,e,i)=>{"wistia"===this.data.provider&&this.isEnded||(this.currentTime=t),this.isMutedByPlayer=i})),this.$refs.player.$on("error",((t,e,i)=>{"NotAllowedError"!==t.name&&("PasswordError"!==t.name&&"PrivacyError"!==t.name?(this.$emit("video:error",t,this,e),this.isModalShown=!1,this.isPlayerShown=!1,this.playerLoaded=!1,this.isPlaying=!1,this.hasError=!0,this.isMutedByPlayer=i):this.showPreventer=!1)})),this.$refs.player.$on("loaded",((t,e,i)=>{this.showPreventer=!0,"youtube"!==this.data.provider&&this.isInline&&(this.playerLoaded=!0),this.isMutedByPlayer=i,this.$emit("video:loaded",t,this,e)})),this.$refs.player.$on("ready",(()=>{this.$nextTick((()=>{this.resolvePlayer()}))}))},unbindEvents:function(){this.$refs.player&&(this.$refs.player.$off("play"),this.$refs.player.$off("pause"),this.$refs.player.$off("end"),this.$refs.player.$off("ended"),this.$refs.player.$off("seek"),this.$refs.player.$off("seeked"),this.$refs.player.$off("error"),this.$refs.player.$off("loaded"),this.$refs.player.$off("ready"))},setPlayingWithSound(){this.$store.state.caniuse.userInteractions.firstClick||this.isMutedByPlayer||this.$store.dispatch("caniuse/setFirstClick"),this.$store.dispatch("content/setVideoPlayingWithSound",{playing:this.isPlaying&&!this.isMutedByPlayer,itemId:this.data.itemId})},getVideoHash(t){return[[this.videoData.page.id,this.videoData.page.isWide?"wide":this.videoData.page.side].join("_"),this.videoData.provider,this.videoData.id,t].join("_")},saveTime(t){const e=this.getVideoHash("time"),i=this.getVideoHash("id"),s=(0,d.Z)().getSessionStorage().getItem(i);this.data.crossWide&&s&&s!=this.lastProgressId||(this.lastProgressId=Date.now(),(0,d.Z)().getSessionStorage().setItem(e,t),(0,d.Z)().getSessionStorage().setItem(i,this.lastProgressId))},loadTime(){const t=this.getVideoHash("time"),e=(0,d.Z)().getSessionStorage().getItem(t),i=e?parseInt(e,10):null,s=this.getVideoHash("id");return this.lastProgressId=(0,d.Z)().getSessionStorage().getItem(s),null===i||isNaN(i)?null:i}},components:{ContentButton:Ke,youtube:zi,vimeo:Ei,wistia:Zi,"modal-window":(0,R.Z)(Gi,Vi,Ui,!1,null,"1536e47e",null).exports}};const ji=(0,R.Z)(Xi,pi,gi,!1,null,null,null).exports;var Yi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",t._g({class:t.containerClasses,style:[t.containerStyle,t.highlightedColor],attrs:{"data-item-id":t.data.itemId,"data-popup-form-area":!t.hasButton}},t.isEmbed?null:{tap:t.onButtonClick}),[t.hasButton?i("button-component",{attrs:{fontSize:t.buttonProps.fontSize,size:t.containerRect,caption:t.buttonProps.caption,cornerRadius:t.buttonProps.cornerRadius,color:t.buttonColor,translate:t.buttonTranslate,"fit-hover":!1}}):t._e()],1)},qi=[],Ki=i(6767),Qi=i.n(Ki),Ji=i(9712),ts=i(1909);let es,is;const ss={extends:We,name:"ContentForm",components:{FormContainer:Ji.Z,ButtonComponent:Ke},props:[],data:function(){return{tapTimeout:0,isPopup:this.data.popup,hasButton:!!this.data.button,isPressed:!1,provider:(0,ts.V)(this.data.url),buttonTranslate:{x:0,y:0}}},mounted(){this.isMobile&&this.$root.$on("form-highlight",this.setHighlight),es=()=>{this.isPressed=!0,this.crossWideItem&&(this.crossWideItem.isPressed=!0)},is=()=>{this.isPressed=!1,this.crossWideItem&&(this.crossWideItem.isPressed=!1)},this.$el.addEventListener("pointerdown",es),this.$el.addEventListener("pointerup",is),this.$el.addEventListener("mouseout",is)},beforeDestroy(){this.isMobile&&this.$root.$off("form-highlight",this.setHighlight),this.$el.removeEventListener("pointerdown",es),this.$el.removeEventListener("pointerup",is),this.$el.removeEventListener("mouseout",is)},computed:{containerClasses:function(){return{highlighted:this.isHighlighted,pressed:this.isPressed,"cross-wide":!!this.crossWideItem&&!this.isSlideMode,"content-element":!0,"popup-form-area":!this.hasButton}},isEmbed(){return this.$store.state.workspace.isEmbed},animationInProgress:function(){return this.$store.getters["workspace/animationInProgress"]},buttonProps:function(){return this.data.button},buttonColor:function(){if(!this.data.button.color)return;const t=new(Qi())(this.data.button.color),e=(0,c.R)((0,c.l)(this.data.button.color))>.5,i=e?t.mix(Qi()("black"),.15).hsl().string():t.mix(Qi()("white"),.2).hsl().string(),s=e?t.mix(Qi()("black"),.3).hsl().string():t.mix(Qi()("white"),.4).hsl().string(),o=e?"#000000":"#ffffff";return{backgroundColor:this.data.button?.color,backgroundHoverColor:i,backgroundActiveColor:s,mainColor:o}},isSlideMode(){return this.$store.state.pager.slideMode},highlightedColor(){let t=this.$store.state.book.links.color;return-1!==t.indexOf("#")&&(t=`rgba(${(0,c.l)(t).join(",")}, 0.6)`),{"--highlighted-color":t}},isPublisher:function(){return this.$store.state.workspace.userAgentInfo.browser.publisher}},methods:{onButtonClick:function(){this.animationInProgress||this.isResizing||(this.$store.commit("sound/SET_MUTE_TEMPORARY",!this.$store.state.caniuse.userInteractions.firstClick),Date.now()>this.tapTimeout&&setTimeout(this.buttonClick,this.$store.state.workspace.doubletapInterval+1),this.tapTimeout=Date.now()+this.$store.state.workspace.doubletapInterval)},buttonClick:function(){if(this.$store.commit("sound/SET_MUTE_TEMPORARY",!1),this.isFrozenOrNotReady||this.isEmbed)return;const t=this.hasButton?"button":"content-click";this.isPublisher&&this.isPopup?this.$root.$emit("popupFormOpenPrevented",{url:this.data.url}):this.isPopup?this.$store.dispatch("lightbox/openLightbox",{type:"form",itemId:this.data.itemId,target:t}):(window.open(this.data.url,"_blank"),this.$root.$emit("onTabFormOpen",{pageId:this.data.page.id,url:this.data.url,target:t}))},setHighlight(t){let{itemId:e}=t;e===this.data.itemId.toString(10)&&(this.isHighlighted=!0,setTimeout((()=>{this.isHighlighted=!1}),500))}}},os=ss;const rs=(0,R.Z)(os,Yi,qi,!1,null,null,null).exports;var as=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"panel-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:(t.showPanel||t.forceShow)&&!t.inProgress&&!t.contextMenuVisible,expression:"(showPanel || forceShow) && !inProgress && !contextMenuVisible"}],ref:"copyPanel",staticClass:"select-text-panel",class:t.panelClass,style:t.panelStyle,attrs:{dir:t.blockDirection},on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave,mousedown:function(t){t.stopPropagation()}}},[i("div",{staticClass:"pointer",style:t.pointerStyle}),t._v(" "),i("span",{staticClass:"button",on:{click:t.copyText}},[t._v(t._s(t.$t("RightClickMenu.COPY_TEXT")))]),t._v(" "),t.isOnline?i("span",{staticClass:"divider"},[t._v("|")]):t._e(),t._v(" "),t.isOnline?i("span",{staticClass:"button",on:{click:t.copyTextLink}},[t._v(t._s(t.$t("RightClickMenu.SHARE_SELECTED_TEXT")))]):t._e()])])},ns=[];const hs={name:"select-text-panel",data:function(){return{showPanel:!1,forceShow:!1,panelStyle:{},panelRect:{},vertical:null,rightOffset:!1,showPanelTimeout:null,pointerStyle:{}}},mounted(){this.$root.$on("selectText:hidePanel",this.hide),this.$root.$on("selectText:showPanel",this.show)},beforeDestroy(){this.$root.$off("selectText:hidePanel",this.hide),this.$root.$off("selectText:showPanel",this.show)},computed:{isSlideMode(){return this.$store.state.pager.slideMode},userRect(){return this.$store.state.text.selectionRect},pageId(){return this.$store.state.text.pageID},pageSide(){return this.$store.state.text.pageSide},inProgress(){return this.$store.state.text.inProgress},pageSize(){return this.$store.state.pages.size},cornerSymbols(){return this.$store.state.text.cornerSymbols},holderSize(){return this.$store.getters["workspace/holderSize"]},bookComponent(){return this.$store.state.workspace.bookComponent},locale(){return this.$store.getters["i18n/getCurrent"]},blockDirection:function(){return this.$store.getters["i18n/isLocaleRtl"]?"rtl":null},isRtl(){return this.$store.state.book.rightToLeft},panelClass(){return this.vertical+(this.rightOffset?" right-side":"")+(this.contextMenuVisible?" quick-leave":"")},pages(){const t=this.$store.getters["pager/currentPages"].length;return this.$store.getters["pages/pageProp"](this.pageId,"wide")?2:t},hardcoverTopPadding(){if(!this.$store.getters["book/hasHardcover"])return 0;if(this.$store.state.pager.spreadMode){return 1===this.pages&&(this.$store.getters["pages/isFirstPage"](this.pageId)||this.$store.getters["pages/isLastPage"](this.pageId))?-.03*this.pageSize.height/2:0}return this.$store.state.pager.singleMode&&this.$store.getters["pages/isFirstPage"](this.pageId)?-.03*this.pageSize.height/2:0},hardcoverLeftPadding(){return this.$store.getters["book/hasHardcover"]&&(this.$store.state.pager.spreadMode&&1===this.pages&&(!this.isRtl&&this.$store.getters["pages/isLastPage"](this.pageId)||this.isRtl&&this.$store.getters["pages/isFirstPage"](this.pageId))||this.$store.state.pager.singleMode&&this.isRtl&&this.$store.getters["pages/isFirstPage"](this.pageId))?-.03*this.pageSize.width:0},pageLeftPadding(){const t=this.$store.getters["pages/pageProp"](this.pageId,"wide");return this.$store.getters["pager/isFirstSpread"]||"right"!==this.pageSide||(this.isRtl&&this.$store.getters["pages/isLastPage"](this.pageId)||t)&&!this.$store.state.pager.singleMode?0:this.$store.state.pager.spreadMode?this.pageSize.width:this.$store.state.pager.singleMode&&t?-this.pageSize.width:0},contextMenuVisible(){return this.$store.state.workspace.contextMenuVisible},isOnline(){return!this.$store.getters["workspace/isOffline"]},pagesWidth(){let t;const e=this.$store.getters["pager/state"];if(e.slideMode)t=this.holderSize.width;else{const i=e.leftPage&&e.rightPage;t=this.$store.state.pages.size.width*(i?2:1)}return t},workspaceSize(){return this.$store.getters["workspace/size"]},isZoomed(){return 1!==this.$store.state.pages.size.zoomFactor},bookContainerWidth(){const t=this.$store.state.sidebar.opened?this.$store.state.sidebar.width:0;return this.workspaceSize.width-t}},methods:{hide(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{forceHide:!0};this.showPanel=!1,t.forceHide&&(this.forceShow=!1)},show(){const t="first:"+this.cornerSymbols.first.left+"-"+this.cornerSymbols.first.top+" last:"+this.cornerSymbols.last.left+"-"+this.cornerSymbols.last.top;null===this.userRect||this.showPanel&&this.cornerSymbolsCode===t||(this.showPanel=!0,this.cornerSymbolsCode=t,this.$nextTick((()=>{this.setPosition()})))},setPosition(){const t=this.calculatePanelPosition();this.panelRect.left=t.left,this.panelRect.top=t.top,this.vertical=t.vertical,this.panelStyle={left:this.panelRect.left+"px",top:this.panelRect.top+"px"}},calculatePanelPosition(){let t;t=this.cornerSymbols.first.top===this.cornerSymbols.last.top?"left"===this.userRect.cursorHSide?{vertical:"top",horizontal:"first"}:{vertical:"bottom",horizontal:"last"}:"top"===this.userRect.cursorVSide?{vertical:"top",horizontal:"first"}:{vertical:"bottom",horizontal:"last"};const e="[data-zoom-wrapper]",i=new window.WebKitCSSMatrix(window.getComputedStyle(this.$root.$el.querySelector(e)).transform),s=i.m41,o=i.m42,r=50;let a=this.calculatePanelCoordinates({position:t,zoomWrapperTranslateX:s});return this.isZoomed?a.top+o<r?(t.vertical="bottom",a=this.calculatePanelCoordinates({position:t,zoomWrapperTranslateX:s})):a.top-o+this.workspaceSize.height>this.holderSize.height-r&&(t.vertical="top",a=this.calculatePanelCoordinates({position:t,zoomWrapperTranslateX:s})):a.top<r?(t.vertical="bottom",a=this.calculatePanelCoordinates({position:t,zoomWrapperTranslateX:s})):a.top>this.holderSize.height-r&&(t.vertical="top",a=this.calculatePanelCoordinates({position:t,zoomWrapperTranslateX:s})),t=(0,I.Z)(t,a),t},calculatePanelCoordinates(t){let{position:e,zoomWrapperTranslateX:i}=t;const s=this.userRect?.offsetX??0,o=this.userRect.offsetY??0,r=this.cornerSymbols[e.horizontal],a=this.cornerSymbols.first.top!==this.cornerSymbols.last.top,n=this.cornerSymbols.first.isRtlSelection&&a,h=e.horizontal===(n?"last":"first")&&r.collisions.left||e.horizontal===(n?"first":"last")&&!r.collisions.right?r.width:0,l="bottom"===e.vertical?r.height:0;let c=this.pageLeftPadding+this.hardcoverLeftPadding+r.left+h+s;const d=this.hardcoverTopPadding+r.top+l+o;let p,g;if(this.isZoomed){const t=this.isSlideMode&&this.holderSize.left<0?0:this.holderSize.left,e=!this.isSlideMode&&this.bookContainerWidth>this.pagesWidth?(this.bookContainerWidth-this.pagesWidth)/2:0;p=this.$el.offsetWidth/2-t-i-e,g=this.bookContainerWidth-this.$el.offsetWidth/2-t-i-e}else p=this.$el.offsetWidth/2-this.holderSize.left,g=this.pagesWidth-(this.$el.offsetWidth/2-this.holderSize.left);const u=this.isZoomed&&(this.$el.offsetWidth/2-(p-c)<23||this.$el.offsetWidth/2-(c-g)<23);return this.pointerStyle.marginLeft=null,this.pointerStyle.display=u?"none":"block",c<p?(this.pointerStyle.marginLeft=c-p+"px",c=p):c>g&&(this.pointerStyle.marginLeft=c-g+"px",c=g),{left:c,top:d}},copyText(){this.$root.$emit("contextMenu:copyText"),this.hide()},copyTextLink(){this.$root.$emit("contextMenu:copyTextLink"),this.hide()},onMouseEnter(){this.forceShow=!0},onMouseLeave(){this.forceShow=!1}}};const ls=(0,R.Z)(hs,as,ns,!1,null,"122cbd9d",null).exports;var cs=i(6373);const ds=i.n(cs)()({features:["js","ww"],idle:1e4}),ps={},gs={methods:{resizePage(t,e,i,s,o){let r;const a=new Promise(((t,e)=>{r=e})),n=()=>delete ps[s];ds.resize(t,e,Object.assign({},i,{cancelToken:a})).then(o,o).then(n,n),ps[s]=r},cancelResize(t){const e=ps[t];e&&e(),delete ps[t]}}},us={computed:{defaultZoomFactor(){return this.$store.state.workspace.defaultZoomFactor},minZoomFactor(){return this.$store.state.workspace.minZoomFactor},isZoomed(){return 1!==this.zoomFactor}},methods:{getTappedZoomBlock(t){let e,i;return t.target&&"block"===t.target.className&&(e=t.target.getAttribute("data-id"),i=t.target.getBoundingClientRect()),{id:e,rect:i}},getBlockRect(t,e){const i={width:t.width>e.width+e.left-t.left?e.width+e.left-t.left:t.width,height:t.height,left:t.left-e.left,top:t.top-e.top};return i.left<0&&(i.width=i.width+i.left,i.left=0),i},checkScaleFactorForZoom:(t,e,i)=>1*(e*t).toFixed(2)>i?i/e:t,getScrollAmount(t,e,i,s,o){if(!t||!t.direction)return;let r,a;switch(t.direction){case"left":r=e<-100?100:-e;break;case"up":r=i<-100?100:-i;break;case"right":a=Math.max(o.width-s.width,0),r=e-100>-a?-100:-a-e;break;case"down":a=Math.max(o.height-s.height,0),r=i-100>-a?-100:-a-i}return r},getSuitableZoomFactor(t,e,i,s){if(0===e)return null;const o=[1.1,1.25,1.5,1.75,2,2.5,3,3.5,4,4.5,5].filter((t=>t>=i&&t<=s)).filter((i=>e>0?i>t:i<t));return e>0?o.shift():o.pop()},showSelectTextTip(){this.$store.getters["workspace/canShowSelectTextTip"]&&(this.$store.dispatch("workspace/setFlashMessage",{text:this.$tc("AlertMessage.SELECT_TEXT_TIP",0,{key:this.isMac?"":"Ctrl"}),delay:1500}),this.$store.dispatch("workspace/increaseSelectTextTipShowsCount"))}}};function fs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0};return{width:t.width*e,height:t.height*e,top:t.top+(i.y-i.y*e),left:t.left+(i.x-i.x*e)}}function ms(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:0,y:0};return{width:e.width*i,height:e.height*i,top:t.height/2-s.y*i+2*t.top,left:t.width/2-s.x*i+2*t.left}}function bs(t,e){const{width:i,height:s}=t;let{top:o,left:r}=t;return s<e.height?o=(e.height-s)/2:o>0?o=0:s+o<e.height&&(o=e.height-s),i<e.width?r=(e.width-i)/2:r>0?r=0:i+r<e.width&&(r=e.width-i),{width:i,height:s,top:o,left:r}}function Ss(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return 1===i?{x:0,y:0}:{x:(t.left-e.left)/(i-1),y:(t.top-e.top)/(i-1)}}i(8856),i(6965),i(9036),i(464),i(925);var vs=i(5109);const ws={"content-block":Ae,"content-link":Ue,"content-image":ti,"content-gallery":ri,"content-gif":di,"content-video":ji,"content-form":rs},ys={name:"FlipBook",mixins:[gs,us,g.Z],props:{containerSize:{type:Object,required:!0},pageSize:{type:Object,required:!0}},components:{page:et,selectTextPanel:ls},data:()=>({status:"ready",zoomFactor:1,scaleFactor:1,scaleOrigin:{x:0,y:0},holderScrollTop:0,holderScrollLeft:0,holderScrollY:0,holderScrollX:0,zoomTimeout:0,addNoteTimeout:0,hideLeftArrow:!1,hideRightArrow:!1,visiblePages:"right",animation:!1,lastWheelTime:0,dragActive:!0,stripesWidth:0,dragging:!1,lastZoomFactor:null,overriddenPagerState:null}),beforeMount:function(){this.visiblePages=this.getVisiblePages(),this.lastZoomFactor=this.defaultZoomFactor,this.zoomFactor=this.$store.state.pages.size.zoomFactor,this.setPageSize(this.pageSize)},mounted:function(){const t={};t.bookWidth=2*this.$store.state.pages.size.width,t.bookHeight=this.$store.state.pages.size.height,this.bookHolderElement=this.$el.querySelector("#book-holder"),this.lastZoomBlockID=null,this.flipAdapter=new Pe({bookSize:this.bookSize,state:this.$store,container:this.bookHolderElement,parentVm:this,contentCreator:this.contentCreator,initDomEvents:!this.isEmbed,isMobile:this.isMobile,version:this.version}),this.toggleBlockOnFlip(),this.flipAdapter.on("render:start",this.onRenderStart,this),this.flipAdapter.on("render:finish",this.onRenderFinish,this),this.flipAdapter.on("flip:finished",this.onFlipFinished,this),this.$root.$on("contextMenu:zoomIn",this.zoomIn),this.$root.$on("contextMenu:zoomOut",this.zoomOut),this.$root.$on("bottomMenu:zoomIn",this.zoomIn),this.$root.$on("bottomMenu:zoomOut",this.zoomOut),this.$root.$on("zoomPanel",this.changeZoom),this.$root.$on("zoomMove",this.zoomMove),this.$root.$on("wheel",this.onWheel),this.$root.$on("publication:mouseleave",this.refreshScroll),this.zoomFactor>1&&this.refreshScroll()},beforeDestroy(){this.$root.$off("contextMenu:zoomIn",this.zoomIn),this.$root.$off("contextMenu:zoomOut",this.zoomOut),this.$root.$off("bottomMenu:zoomIn",this.zoomIn),this.$root.$off("bottomMenu:zoomOut",this.zoomOut),this.$root.$off("zoomPanel",this.changeZoom),this.$root.$off("zoomMove",this.zoomMove),this.$root.$off("wheel",this.onWheel),this.$root.$off("publication:mouseleave",this.refreshScroll),this.flipAdapter.off("render:start",this.onRenderStart,this),this.flipAdapter.off("render:finish",this.onRenderFinish,this),this.flipAdapter.off("flip:finished",this.onFlipFinished,this),this.flipAdapter.destructor()},watch:{forceRerender:function(){this.forceRerender&&(this.$store.dispatch("pager/setForceRerender",{forceRerender:!1}),this.flipAdapter.resetBook())},pageSize:function(t){this.setPageSize(t)},zoomFactor:function(t,e){this.toggleBlockOnFlip();const i={width:this.pageSize.width,height:this.pageSize.height};if(i.width=i.width*t,i.height=i.height*t,i.zoomFactor=t,this.$store.dispatch("pages/changePageSize",i),t>1&&1===e){const t=this.$store.getters["pager/currentPages"].some((t=>this.$store.getters["pages/pageProp"](t,"textBlocks")),this);this.selectTextEnabled&&t&&!this.$store.state.pager.isMoveWatcherActive&&this.showSelectTextTip()}},zoomPanel(){this.toggleBlockOnFlip()},status:function(t){"ready"!==t?(this.$store.dispatch("pager/freeze",{target:"flip-book-zoom"}),this.$store.dispatch("workspace/setAnimationProgress",{animationType:this.scaleFactor>1&&1===this.zoomFactor?"initialZoom":"zoomNotInitial"})):(this.$store.dispatch("pager/unfreeze",{target:"flip-book-zoom"}),this.$store.dispatch("workspace/unsetAnimationProgress")),this.toggleBlockOnFlip(),this.refreshScroll(),this.$store.dispatch("workspace/setStatus",t)},bookSize:function(t){this.flipAdapter.resizeBook(t)},singleMode:function(t){this.zoomOut(!0),this.flipAdapter.setSingleMode(t)},currentPages(t,e){if(t.mode!==e.mode&&t.zoomMode!==e.zoomMode)return;if(t.isEqualState(e))return void(t.zoomMode?this.zoomIn():this.zoomOut(!1));const i=(t,e,i)=>{t.mode===e.mode&&this.$store.dispatch("sound/playFlipSound",{hardcover:e.hardcover||t.hardcover});const s=this.$store.getters["pager/getDeltaTurns"](e,t);if(1===Math.abs(s)){const e=s>0?"toLeft":"toRight",o=s>0?!t.rightPage||t.isLastSpread:!t.leftPage||t.isFirstSpread;"flipComponent"!==t.target&&"orientation"!==t.target&&o&&this.$store.dispatch("pager/setForceFlip",{forceFlip:!0}),this.flipAdapter.updateState(e,t,i)}else Math.abs(s)>1&&this.flipAdapter.updateState("toPage",t,i)};if(1!==this.zoomFactor){this.overriddenPagerState=e,this.zoomOut(!1);const s=this.$store.getters["pager/flipState"];this.$once("transition:end",(()=>{this.overriddenPagerState=null,setTimeout(i.bind(this,t,e,s),0)}))}else{const s=this.$store.getters["pager/flipState"];setTimeout(i.bind(this,t,e,s),0)}},isWorkspaceFrozen(t){t?this.flipAdapter.block(!1):this.flipAdapter.unblock()},workspaceSize(){if(1===this.zoomFactor)return;let t;if(this.isInitialZoom)t={x:this.isRTLBook?this.bookHolderSize.width:0,y:0};else{let e,i;e=this.bookHolderSize.width>this.containerSize.width?-this.holderScrollX+this.containerSize.width/2:this.bookHolderSize.width/2,i=this.bookHolderSize.height>this.containerSize.height?-this.holderScrollY+this.containerSize.height/2:this.bookHolderSize.height/2,t={x:e,y:i}}const e={x:t.x-this.bookHolderSize.left,y:t.y-this.bookHolderSize.top};this.scaleFactor=1;let i=ms(this.containerSize,this.bookHolderSize,this.scaleFactor,e);i=bs(i,this.containerSize),this.fixBounds(i),this.holderScrollLeft=i.left,this.holderScrollTop=i.top,this.scrollComponent?.refresh(),this.isInitialZoom&&this.$store.dispatch("workspace/clearInitialZoom")},isRTLBook(t){this.flipAdapter.setRtl(t)},isHardcover(t){this.zoomOut(!0),this.flipAdapter.setHardcover(t),this.$root.$emit("forceBookResize")},hardcoverColor(t){this.flipAdapter.setHardcoverColor(t)},hasThickness(t){this.flipAdapter.setThickness(t)},isOnlyRightPage(){const t=this.getVisiblePages();t!==this.visiblePages&&(this.visiblePages=t)},isOnlyLeftPage(){const t=this.getVisiblePages();t!==this.visiblePages&&(this.visiblePages=t)},dragActive(t){t?this.$refs.bookHolder.$el.classList.remove("nodrag"):this.$refs.bookHolder.$el.classList.add("nodrag")},isMini(){this.zoomOut(!0)},workspaceBookSize(){this.zoomOut(!0)},orientationChanged(t,e){e&&this.isMobile&&this.zoomOut(!0)}},computed:{isFirstSpread(){return this.$store.getters["pager/isFirstSpread"]},isLastSpread(){return this.$store.getters["pager/isLastSpread"]},isOuterHardcover(){return this.isHardcover&&(this.isFirstSpread||this.isLastSpread)},bookSize(){let t;const e=this.$store.state;return t=e.book.rightToLeft?"left"===this.visiblePages?-e.pages.size.width:0:this.singleMode||"right"===this.visiblePages?-e.pages.size.width:0,{width:2*this.$store.state.pages.size.width,height:this.$store.state.pages.size.height,top:this.containerSize.top+(this.containerSize.height-e.pages.size.height)/2,left:t}},isOnlyRightPage(){const t=this.overriddenPagerState??this.$store.getters["pager/state"];return t.spreadMode&&null===t.leftPage},isOnlyLeftPage(){const t=this.overriddenPagerState??this.$store.getters["pager/state"];return t.spreadMode&&null===t.rightPage},isOnlyPage(){return 1===this.$store.getters["pages/pagesCount"]},bookHolderSize(){const t="both"!==this.visiblePages,e=this.$store.getters["pages/size"],i=this.singleMode,s=this.isHardcover?1.03:1,o=this.containerSize.width,r=this.containerSize.height,a=this.holderScrollLeft,n=this.holderScrollTop,h=this.stripesWidth||0,l=24,c=t||i?e.width:2*e.width,d=e.height;let p,g;return 1===this.zoomFactor?(p=(o-c)/2,g=(r-d)/2):(p=a,g=n),this.$store.dispatch("workspace/setHolderSize",{width:c*s+2*h+2*l,height:d*s,left:1===this.zoomFactor?p:0,top:1===this.zoomFactor?g:0}),{width:Math.round(c),height:Math.round(d),top:Math.round(g),left:Math.round(p)}},bookHolderStyle(){const t=this.bookHolderSize,e=this.containerSize,i=this.zoomFactor,s=this.scaleOrigin,o=this.holderScrollLeft,r=this.holderScrollTop,a=this.scaleFactor,n=this.status,h=this.fastAnimation,l=this.animationSpeed,c=e.height>=t.height?Math.round(t.top)+"px":"0",d=e.width>=t.width?Math.round(t.left)+"px":"0",p={width:t.width+"px",height:t.height+"px",top:1===i?t.top+"px":c,left:1===i?t.left+"px":d};if("animating"===n||"pinch"===n||"scale"===n){p.transformOrigin=s.x+"px "+s.y+"px";const i="translate("+(e.width<t.width?o:0)+"px,"+(e.height<t.height?r:0)+"px) translateZ(0) ",c="scale3d("+a+", "+a+", "+a+")";p.transform=0!==r||0!==o?i+c:c;const d="transform "+(h?1:l)+"ms "+(this.isFirefox||h?"linear":"cubic-bezier(0.215, 0.61, 0.355, 1)");p.transition="animating"===n?d:"transform 0s"}else p.transition="transform 0s",1===i&&(p.transform="");return p},flipBookClass(){const t={};t.zoomed=1!==this.zoomFactor||1!==this.scaleFactor,t.rtl=this.isRTLBook,t["arrow-attract-right"]="right"===this.arrowAttract,t["arrow-attract-left"]="left"===this.arrowAttract;const e=this.$store.state.book.bookSize.height/this.$store.state.book.bookSize.width;return this.isHardcover&&(e<=1.1&&e>=.9?t.square=!0:e>1.1?t.portrait=!0:t.landscape=!0),t.scaling="scale"===this.status,t["drag-active"]=this.dragging,t["single-page"]=this.pageCount<=2,t["single-mode"]=this.singleMode,t},pageCount(){return this.$store.getters["pages/pagesCount"]},currentPages(){const t=this.$store.getters["pager/state"],e=this.$store.getters["pages/isFirstPage"](t.currentPage),i=t.spreadMode&&!this.$store.state.pager.spread_rightPage,s=this.isHardcover&&(e||i);return(0,I.Z)(t,{hardcover:s})},singleMode(){return this.$store.state.pager.singleMode},forceRerender(){return this.$store.state.pager.forceRerender},holderOriginalWidth(){return"both"!==this.visiblePages||this.singleMode?this.pageSize.width:2*this.pageSize.width},isWorkspaceFrozen(){return this.$store.state.workspace.freezed},frozenBy(){return this.$store.state.workspace.frozenBy?this.$store.state.workspace.frozenBy:null},zoomPanel(){return this.$store.state.workspace.zoomPanel},wheelScroll(){return this.$store.state.workspace.wheelScroll},workspaceSize(){return this.$store.state.workspace.containerSize},workspaceBookSize(){return this.$store.state.workspace.bookSize},orientationChanged(){return this.$store.getters["workspace/orientation"]},minZoom(){const t=this.isHardcover&&(this.isFirstPage||this.isLastPage)?1.03:1,e=this.singleMode?1:2,i=this.$store.state.workspace.bookSize/100;return Math.min(this.$store.state.workspace.containerSize.height*i/(this.$store.state.pages.size.height*t/this.$store.state.pages.size.zoomFactor),this.$store.state.workspace.containerSize.width*i/(this.$store.state.pages.size.width*t*e/this.$store.state.pages.size.zoomFactor))},maxZoom(){return this.$store.state.workspace.maxZoom},isInitialZoom(){return this.$store.state.workspace.initialZoom},animationSpeed(){return this.scaleFactor<1?400:600},isMini(){return this.$store.state.workspace.mini},isEmbed(){return this.$store.state.workspace.isEmbed},version(){return this.$store.getters["info/version"]},isMobile(){return this.$store.getters["workspace/isMobile"]},isFirefox(){return!0===this.$store.state.workspace.userAgentInfo.browser.firefox},isSafari(){return!!this.$store.state.workspace.userAgentInfo.browser.safari},isMac(){return!0===this.$store.state.workspace.userAgentInfo.os.mac},isRTLBook:function(){return this.$store.state.book.rightToLeft},isLocaleRtl:function(){return this.$store.getters["i18n/isLocaleRtl"]},isHardcover:function(){return this.$store.getters["book/hasHardcover"]},hardcoverColor:function(){return this.$store.state.book.hardcoverColor},hasThickness:function(){return this.$store.state.book.thickness},isFirstPage:function(){const t=this.$store.getters["pager/isFirstSpread"],e=this.$store.getters["pager/isLastSpread"];return this.isRTLBook?e:t},isLastPage:function(){const t=this.$store.getters["pager/isLastSpread"],e=this.$store.getters["pager/isFirstSpread"];return this.isRTLBook?e:t},isSecondPage(){const t=this.$store.getters["pager/prevPageId"];return this.$store.getters["pages/isFirstPage"](t)},isSecondToLastPage(){const t=this.$store.getters["pager/nextPageId"];return this.$store.getters["pages/isLastPage"](t)},isLightboxShown(){return this.$store.getters["lightbox/isShown"]},showBookButtons(){return!this.isLightboxShown&&1===this.zoomFactor&&1===this.scaleFactor&&"html"===this.version},showLeftButtons(){const t=this.showBookButtons&&!this.isFirstPage&&!(this.hideLeftArrow&&(this.isRTLBook?this.isSecondToLastPage:this.isSecondPage));return t||this.switchFocus("left","right"),t},showRightButtons(){const t=this.showBookButtons&&!this.isLastPage&&!(this.hideRightArrow&&(this.isRTLBook?this.isSecondPage:this.isSecondToLastPage));return t||this.switchFocus("right","left"),t},notesEnabled(){return this.$store.state.workspace.components.notes&&!this.isMini},showRightAddNote(){return(this.showRightButtons||this.hideRightArrow)&&(!this.isLocaleRtl||this.isFirstPage)},showOnlyAddNote(){return this.showBookButtons&&this.notesEnabled&&this.isOnlyPage},addNoteTitleText:function(){return this.$t("NotesToolWindow.ADD_NOTE")},leftArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.NEXT_PAGE_TIP"):this.$t("NavigationPanel.PREV_PAGE_TIP")},rightArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.PREV_PAGE_TIP"):this.$t("NavigationPanel.NEXT_PAGE_TIP")},leftMostArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.LAST_PAGE_TIP"):this.$t("NavigationPanel.FIRST_PAGE_TIP")},rightMostArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.FIRST_PAGE_TIP"):this.$t("NavigationPanel.LAST_PAGE_TIP")},bookState(){return this.flipAdapter},selectTextEnabled(){return!this.isMobile&&this.$store.state.workspace.components.textSelection},arrowAttract(){const t=this.$store.getters["workspace/callToNavigation"];return"arrow"===t.type&&t.side},bookEventHandlers(){return this.isEmbed?null:{pinchstart:this.onPinchStart,pinchmove:this.onPinchMove,pinchend:this.onPinchFinish,pinchcancel:this.onPinchFinish}},bookHolderEventHandlers(){const t=this.isEmbed?{}:{doubletap:this.zoomByTap.bind(this,"tap")};return t.tap=this.isHardcover?this.clickOnCover:()=>{},t}},methods:{fixBounds(t){if(this.isOuterHardcover){const e=this.scaleFactor*this.zoomFactor;if(e>1||e<.95){const i=this.isFirstSpread&&!this.isRTLBook||this.isLastSpread&&this.isRTLBook&&!this.singleMode,s=this.isLastSpread&&!this.isRTLBook&&!this.singleMode||this.isFirstSpread&&this.isRTLBook,o=this.$store.state.pages.size.width,r=Math.round(.03*o/this.zoomFactor*e/2);i?t.left=t.left-r:s&&(t.left=t.left+r)}}},setPageSize:function(t){const e={width:t.width*this.zoomFactor,height:t.height*this.zoomFactor,zoomFactor:this.zoomFactor};this.$store.dispatch("pages/changePageSize",e)},clickOnCover:function(t){const e=(0,l.iZ)(t.target);for(let i=0,s=e.length;i<s&&!e[i].classList.contains("page");i++){if(e[i].classList.contains("z1")&&e[i].classList.contains("hard-front")){this.rightPage();break}if(e[i].classList.contains("z3")&&e[i].classList.contains("hard-front")){this.leftPage();break}}},switchFocus:function(t,e){["notes","go","go-last"].forEach((i=>{const s=[i,t].join("-"),o=[i,e].join("-");document.body.contains(document.activeElement)&&document.activeElement?.getAttribute("data-nav-name")===s&&document.querySelector('[data-nav-name="'+o+'"]').focus()}))},onRenderStart(t){t.drag&&"left"===t.hide?this.hideLeftArrow=!0:t.drag&&"right"===t.hide&&(this.hideRightArrow=!0),this.animation=!0,this.$root.$emit("turnStart")},onRenderFinish(){this.hideLeftArrow=!1,this.hideRightArrow=!1,this.animation=!1,this.$root.$emit("render:finish"),this.$root.$emit("turnStop")},onFlipFinished(){this.$root.$emit("turned")},onWheel(t){if(!(!this.wheelScroll||this.isMini||Date.now()-this.lastWheelTime<200||t.target&&"note-article"===t.target.className)){if(t.ctrlKey||t.metaKey){if("ready"!==this.status)return;const e=-1*t.deltaY,i=this.getSuitableZoomFactor(this.zoomFactor,e,this.minZoom,this.maxZoom);e<0&&!i&&this.zoomOut(!1,"wheel-zoom"),i&&(this.$store.dispatch("pager/setLastTarget","wheel-zoom"),this.setZoom(i,!0,{x:t.clientX,y:t.clientY}))}else{if(this.zoomFactor>1||this.scaleFactor>1)return;this.$store.state.notes.opened&&this.$store.dispatch("notes/setOpenedId",{id:null}),t.deltaY>0?this.$store.dispatch("pager/goForward",{target:"wheel"}):t.deltaY<0&&this.$store.dispatch("pager/goBackward",{target:"wheel"})}this.lastWheelTime=Date.now()}},zoomMove(t){if(!t||!t.direction)return;if("ready"!==this.status)return void("drag"===t.direction&&(this.dragActive=t.active));let e;switch(t.direction){case"left":case"right":e=this.getScrollAmount(t,this.scrollComponent.x,0,this.containerSize,this.bookHolderSize),this.scrollComponent.scrollBy(e,0);break;case"up":case"down":e=this.getScrollAmount(t,0,this.scrollComponent.y,this.containerSize,this.bookHolderSize),this.scrollComponent.scrollBy(0,e);break;case"drag":this.dragActive=t.active,this.initScrollComponent(this.dragActive)}this.scrollComponent&&(this.holderScrollX=this.scrollComponent.x,this.holderScrollY=this.scrollComponent.y,this.$store.dispatch("text/setHolderScroll",{x:this.holderScrollX,y:this.holderScrollY}))},getVisiblePages(){return this.isOnlyRightPage?"right":this.isOnlyLeftPage?"left":"both"},toggleBlockOnFlip(){1!==this.zoomFactor||this.zoomPanel||"ready"!==this.status?this.flipAdapter.block(!0):setTimeout((()=>{this.flipAdapter.unblock()}),20)},refreshScroll(){this.cancelDragging(),this.$nextTick((()=>{this.zoomFactor>1&&"ready"===this.status?this.initScrollComponent(this.dragActive):this.scrollComponent&&(this.holderScrollX=0,this.holderScrollY=0,this.$store.dispatch("text/setHolderScroll",{x:this.holderScrollX,y:this.holderScrollY}),this.scrollComponent.destroy(),delete this.scrollComponent)}))},onScrollEnd:function(){this.cancelDragging(),this.holderScrollX=this.scrollComponent.x,this.holderScrollY=this.scrollComponent.y,this.$store.dispatch("text/setHolderScroll",{x:this.holderScrollX,y:this.holderScrollY})},onScrollBegin:function(){this.holderScrollX=this.scrollComponent.x,this.holderScrollY=this.scrollComponent.y,this.$store.dispatch("text/setHolderScroll",{x:this.holderScrollX,y:this.holderScrollY})},setDragging:function(){1!==this.zoomFactor&&(this.dragging=!0)},cancelDragging:function(){this.dragging=!1},zoomOut(t,e){if(1!==this.zoomFactor){if(this.lastZoomFactor=Math.max(this.zoomFactor,this.minZoomFactor),t)return this.status="calculating",this.zoomFactor=1,this.scaleFactor=1,this.refreshScroll(),this.holderScrollLeft=0,this.holderScrollTop=0,this.status="ready",this.$root.$emit("unzoomed"),void(this.fastAnimation=!1);this.zoomByTap(e,{center:{x:0,y:0}})}},zoomIn(t){this.zoomFactor>1||this.zoomByTap(t)},zoomByTap(t,e){if(t&&this.$store.dispatch("pager/setLastTarget",t),this.zoomTimeout>Date.now())return;if(this.isWorkspaceFrozen||"ready"!==this.status||"pending"!==this.$store.state.pager.flipState||this.isMini)return;e||(e={center:{x:this.isRTLBook?this.workspaceSize.width:0,y:0},target:null});const i=["next-button","previous-button","icon-book-next","icon-book-prev","reflex-container"];if(e.target&&(i.indexOf(e.target.className)>=0||e.target.classList.contains("stripe")||e.target.classList.contains("page-stripe")||(0,y.HD)(e.target.className)&&e.target.className.indexOf("stripe-block")>=0||"0-0"===e.target.dataset.page||"textarea"===e.target.tagName.toLowerCase()))return;this.status="calculating";let s,o=!1;const r=this.getTappedZoomBlock(e);if(this.isMobile&&r.id){o=this.lastZoomBlockID!==r.id;const t=this.bookHolderElement.getBoundingClientRect();s=this.getBlockRect(r.rect,t)}if(this.lastZoomBlockID=o?r.id:null,o){const t=1.5,e=40;let i=2,o=this.containerSize.width-e*i,r=1*(.96*o/s.width).toFixed(2);const a=this.bookHolderSize.width-s.width-s.left;(s.left*r<e||a*r<e)&&(i=1,o=this.containerSize.width-e*i,r=1*(.96*o/s.width).toFixed(2)),this.updateHolderScroll(!0),this.scaleFactor=this.checkScaleFactorForZoom(r,this.zoomFactor,this.maxZoom),this.scaleFactor*this.zoomFactor<t&&(this.scaleFactor=t/this.zoomFactor)}else this.scaleFactor=1!==this.zoomFactor||this.zoomPanel?this.holderOriginalWidth/this.bookHolderSize.width:this.lastZoomFactor;const a={x:e.center.x-this.bookHolderSize.left,y:e.center.y-this.bookHolderSize.top};let n=ms(this.containerSize,this.bookHolderSize,this.scaleFactor,a);if(o){const t=s.left*this.scaleFactor,e=s.width*this.scaleFactor;n.left=-t+(this.containerSize.width-e)/2}n=bs(n,this.containerSize),this.fixBounds(n),this.status="animating",this.scaleOrigin=Ss(this.bookHolderSize,n,this.scaleFactor),this.newBounds=n,this.refreshScroll(),this.flipAdapter.setZoom(this.scaleFactor*this.zoomFactor>1),this.scaleFactor>1?this.$root.$emit("zoomed"):(this.scaleFactor<1||this.zoomPanel&&1===this.scaleFactor)&&this.$root.$emit("unzoomed"),this.$store.dispatch("workspace/setHighlightTimeout",Date.now()+1e3)},onPinchStart(t){this.isWorkspaceFrozen||"ready"!==this.status||"inProgress"===this.$store.state.pager.flipState||this.isMini||(this.$store.dispatch("pager/setLastTarget","pinch-zoom"),this.minScale=this.holderOriginalWidth/this.bookHolderSize.width,this.scaleFactor=1,this.pinchCenter=t.center,this.isZoomed?(this.updateHolderScroll(!1),this.scaleOrigin={x:t.center.x-this.holderScrollLeft,y:t.center.y-this.holderScrollTop}):this.scaleOrigin={x:t.center.x-this.bookHolderSize.left,y:t.center.y-this.bookHolderSize.top},this.status="pinch")},onPinchMove(t){if("pinch"!==this.status)return;const e=this.minScale<t.scale?t.scale:this.minScale;if(this.scaleFactor=this.checkScaleFactorForZoom(e,this.zoomFactor,this.maxZoom),1!==this.scaleFactor){let t=fs(this.bookHolderSize,this.scaleFactor,this.scaleOrigin);t=bs(t,this.containerSize),this.scaleOrigin=Ss(this.bookHolderSize,t,this.scaleFactor)}},onPinchFinish(){if("pinch"!==this.status)return;let t=fs(this.bookHolderSize,this.scaleFactor,this.scaleOrigin);t=bs(t,this.containerSize),this.zoomFactor=1*(this.zoomFactor*this.scaleFactor).toFixed(2),this.scaleFactor=1,this.holderScrollLeft=this.isZoomed?t.left:0,this.holderScrollTop=this.isZoomed?t.top:0,this.status="ready",this.scaleFactor>1?this.$root.$emit("zoomed"):this.scaleFactor<1&&this.$root.$emit("unzoomed")},setZoom(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.isWorkspaceFrozen||"ready"!==this.status)return;this.scaleFactor=t/this.zoomFactor,this.updateHolderScroll(!1);const s=i||{x:this.workspaceSize.width/2,y:this.workspaceSize.height/2},o={x:s.x-this.bookHolderSize.left,y:s.y-this.bookHolderSize.top};let r=fs(this.bookHolderSize,this.scaleFactor,o);r=bs(r,this.containerSize),this.fixBounds(r),this.scaleOrigin=Ss(this.bookHolderSize,r,this.scaleFactor),this.newBounds=r,this.flipAdapter.setZoom(this.scaleFactor*this.zoomFactor>1),this.fastAnimation=e,this.status="animating",this.refreshScroll()},setScaleStart(){this.minScale=Math.max(this.minZoom/this.zoomFactor,this.holderOriginalWidth/this.bookHolderSize.width),this.maxScale=this.maxZoom/this.zoomFactor,this.scaleFactor=1,this.updateHolderScroll(!1),this.scaleOrigin={x:this.workspaceSize.width/2-this.holderScrollLeft,y:this.workspaceSize.height/2-this.holderScrollTop},this.status="scale"},setScale(t){if("scale"!==this.status)return;const e=this.minScale+(this.maxScale-this.minScale)*t;let i=fs(this.bookHolderSize,e,{x:this.workspaceSize.width/2-this.holderScrollLeft,y:this.workspaceSize.height/2-this.holderScrollTop});i=bs(i,this.containerSize),this.fixBounds(i),this.scaleOrigin=Ss(this.bookHolderSize,i,e);const s=Math.min(this.maxScale,Math.max(this.minScale,e));this.scaleFactor=this.checkScaleFactorForZoom(s,this.zoomFactor,this.maxZoom)},setScaleFinish(){if("scale"!==this.status)return;let t=fs(this.bookHolderSize,this.scaleFactor,this.scaleOrigin);t=bs(t,this.containerSize),this.fixBounds(t),this.zoomFactor=1*(this.zoomFactor*this.scaleFactor).toFixed(2),this.scaleFactor=1,this.holderScrollLeft=1!==this.zoomFactor?t.left:0,this.holderScrollTop=1!==this.zoomFactor?t.top:0,this.status="ready"},changeZoom(t){switch(this.$store.dispatch("pager/setLastTarget","change-zoom"),t.action){case"setZoom":this.setZoom(t.zoomFactor,t.fast);break;case"startScale":this.setScaleStart();break;case"changeScale":this.setScale(t.scalePosition);break;case"endScale":this.setScaleFinish();break;case"zoomIn":this.zoomByTap();break;case"zoomOut":this.dragActive=!0,this.zoomOut()}},transitionEnd(t){t&&"transform"===t.propertyName&&t.target===this.bookHolderElement&&"animating"===this.status&&(this.fastAnimation=!1,this.lastZoomFactor=Math.max(this.zoomFactor,this.minZoomFactor),this.zoomFactor=1*(this.zoomFactor*this.scaleFactor).toFixed(2),this.scaleFactor=1,this.holderScrollLeft=1===this.zoomFactor?0:this.newBounds.left,this.holderScrollTop=1===this.zoomFactor?0:this.newBounds.top,this.status="ready",this.$emit("transition:end"))},updateHolderScroll(t){t&&1===this.zoomFactor||(this.containerSize.width<this.bookHolderSize.width&&(this.holderScrollLeft=this.holderScrollX),this.containerSize.height<this.bookHolderSize.height&&(this.holderScrollTop=this.holderScrollY))},contentCreator:t=>ws["content-"+t.type],rightPage(){this.addNoteTimeout>Date.now()||this.$store.state.pager.freezed||(this.zoomTimeout=Date.now()+500,setTimeout((()=>{this.movePagerRight({target:"nav-arrow-tap"})}),0))},leftPage(){this.addNoteTimeout>Date.now()||this.$store.state.pager.freezed||(this.zoomTimeout=Date.now()+500,setTimeout((()=>{this.movePagerLeft({target:"nav-arrow-tap"})}),0))},rightmostPage(){this.zoomTimeout=Date.now()+500,setTimeout((()=>{this.movePagerRightmost({navTarget:!0})}),0)},leftmostPage(){this.zoomTimeout=Date.now()+500,setTimeout((()=>{this.movePagerLeftmost({navTarget:!0})}),0)},arrowHover(t,e){e?this.$el.classList.add(t+"-highlighted"):this.$el.classList.remove(t+"-highlighted")},btnAddNote(t){let e,i,s;this.zoomTimeout=Date.now()+500,this.addNoteTimeout=Date.now()+500,this.currentPages.singleMode?(e=this.currentPages.currentPage,i=this.currentPages.widePageSecondHalf,s=this.isRTLBook&&this.$store.getters["pages/pageProp"](e,"wide")&&!i):(e="left"===t&&!this.isRTLBook||"right"===t&&this.isRTLBook?this.currentPages.leftPage:this.currentPages.rightPage,i="right"===t&&this.currentPages.wide),this.$store.dispatch("notes/addNote",{pageId:e,wideRight:i,wideOpposite:s,target:"flipBook"})},initScrollComponent(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(1===this.zoomFactor)return;this.scrollComponent?(this.holderScrollX=this.scrollComponent.x,this.holderScrollY=this.scrollComponent.y,this.scrollComponent.off("beforeScrollStart",this.setDragging),this.scrollComponent.off("scrollCancel",this.cancelDragging),this.scrollComponent.off("scroll",this.onScrollBegin),this.scrollComponent.off("scrollEnd",this.onScrollEnd),this.scrollComponent.destroy(),delete this.scrollComponent):(this.holderScrollX=this.containerSize.width<this.bookHolderSize.width?this.bookHolderSize.left:0,this.holderScrollY=this.containerSize.height<this.bookHolderSize.height?this.bookHolderSize.top:0),this.scrollComponent=new vs.ZP(this.$el,{mouseWheel:t,scrollbars:!1,freeScroll:!this.isMobile,scrollX:this.containerSize.width<this.bookHolderSize.width,scrollY:this.containerSize.height<this.bookHolderSize.height,probeType:this.isSafari?3:1,bindToWrapper:this.isMobile,bounce:!1,startX:this.holderScrollX,startY:this.holderScrollY,disablePointer:!0,disableTouch:!1,disableMouse:!t}),this.$store.dispatch("text/setHolderScroll",{x:this.holderScrollX,y:this.holderScrollY}),this.scrollComponent.on("beforeScrollStart",this.setDragging),this.scrollComponent.on("scrollCancel",this.cancelDragging),this.scrollComponent.on("scroll",this.onScrollBegin),this.scrollComponent.on("scrollEnd",this.onScrollEnd);this.scrollComponent.scroller.translater.hooks.on("beforeTranslate",(()=>{"text-context-menu"===this.$store.state.workspace.activeInteractiveElement?this.$store.dispatch("workspace/setActiveInteractiveElement","selected-text"):"selected-text"!==this.$store.state.workspace.activeInteractiveElement&&this.$store.dispatch("workspace/setActiveInteractiveElement",null)}))},getPageInfo(t,e,i){return{page:t,wide:this.$store.getters["pages/pageProp"](t,"wide"),first:this.$store.getters["pages/isFirstPage"](t),last:this.$store.getters["pages/isLastPage"](t),index:null!==t?this.$store.getters["pages/pageIndexById"](t):this.$store.getters["pages/pageIndexById"](e)+i}},getStateInfo(t){return{right:this.getPageInfo(t.rightPage,t.leftPage,1),left:this.getPageInfo(t.leftPage,t.rightPage,-1),differentPages:t.rightPage!==t.leftPage}}}},ks=ys;const xs=(0,R.Z)(ks,r,a,!1,null,null,null).exports;var $s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"slide-book"},[i("v-touch",t._g({ref:"holder",staticClass:"slide-holder",class:t.holderClasses,attrs:{tag:"div",id:"slide-holder"}},t.isEmbed?null:{pinchstart:t.onPinchStart,pinchmove:t.onPinchMove,pinchend:t.onPinchFinish,pinchcancel:t.onPinchFinish,panstart:t.onPanStart,panmove:t.onPanMove,panend:t.onPanEnd,pancancel:t.onPanEnd}),t._l(t.outputSlidesCache,(function(e){return i("div",{key:e.pages[0].id+"_"+e.pages[0].side,ref:"current"===e.position?"wrapper":null,refInFor:!0,class:"slide-wrapper "+e.position,style:t.slideStyles[e.position],attrs:{"data-id":e.pages[0].id+"_"+e.pages[0].side+(e.pages[1]?"-"+e.pages[1].id+"_"+e.pages[0].side:"")}},[i("v-touch",{staticClass:"spread-wrapper",style:t.spreadStyles[e.position],attrs:{tag:"div","data-zoom-wrapper":"current"===e.position||null},on:{doubletap:function(i){!t.isEmbed&&"current"===e.position&&t.onDoubleTap(i)}},nativeOn:{transitionend:function(e){return t.onTransitionEnd(e)}}},[t.selectTextEnabled&&"current"===e.position?i("select-text-panel"):t._e(),t._v(" "),t.isSpreadFillerShown?[i("div",{staticClass:"spread-filler"},t._l(e.pages,(function(e){return i("div",{staticClass:"page-filler",class:e.side,style:e.style,attrs:{"data-caption":e.caption}},[i("svgicon",{attrs:{name:e.icon}}),t._v(" "),e.wide&&t.isSpreadMode?i("svgicon",{attrs:{name:e.icon}}):t._e()],1)})),0)]:t._l(e.pages,(function(s){return i("page",{key:s.id+"_"+s.side,ref:"current"===e.position?"current":null,refInFor:!0,class:"slide-page "+(t.isContentCropMode?"content-crop":s.position),attrs:{id:s.id,side:s.side,size:t.pageSizes[e.position],contentCreator:t.contentCreator,"data-id":s.id+"_"+s.side,contentCrop:t.isContentCropMode}})}))],2)],1)})),0),t._v(" "),i("transition",{attrs:{name:"note-icon-fade"}},[t.noteIconShown?i("button",{staticClass:"icon-add-note",class:t.noteIconClass,style:t.noteIconStyle,attrs:{tabindex:"0",title:t.addNoteTitleText},on:{click:function(e){return e.stopPropagation(),t.addNote(e)}}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"add-note"}})],1):t._e()])],1)},zs=[];i(9719),i(1619);const Ps={"content-block":Ae,"content-link":Ue,"content-image":ti,"content-gallery":ri,"content-gif":di,"content-video":ji,"content-form":rs},Cs={name:"SlideBook",mixins:[gs,us,g.Z],props:{containerSize:{type:Object,required:!0},pageSize:{type:Object,required:!0}},components:{page:et,selectTextPanel:ls},data:()=>({status:"ready",zoomFactor:1,scaleFactor:1,slideScrollTop:0,slideScrollLeft:0,slideScrollY:0,slideScrollX:0,scaleOrigin:{x:0,y:0},delta:0,slidesCache:{},outputSlidesCache:[],horizontalScale:1,fastAnimation:!1,dragActive:!0,lastZoomFactor:null,lastWheelTime:0,propCache:{},dragging:!1,noteIconClass:["hidden"],noteIconStyle:null,isFastSliding:!1,isSpreadFillerShown:!1,pendingFastSlide:null,fastSlidingCancelTimeout:null}),beforeMount:function(){this.lastZoomFactor=this.defaultZoomFactor,this.zoomFactor=this.$store.state.pages.size.zoomFactor},mounted(){this.slidesCacheUpdate(),this.status="ready",this.pendingSlide=null,this.$root.$on("contextMenu:zoomIn",this.zoomIn),this.$root.$on("contextMenu:zoomOut",this.zoomOut),this.$root.$on("bottomMenu:zoomIn",this.zoomIn),this.$root.$on("bottomMenu:zoomOut",this.zoomOut),this.$root.$on("zoomPanel",this.changeZoom),this.$root.$on("zoomMove",this.zoomMove),this.$root.$on("wheel",this.onWheel),this.$root.$on("nav:goRight",this.goFastRight),this.$root.$on("nav:goLeft",this.goFastLeft),this.$root.$on("publication:mouseleave",this.onMouseLeave),this.updateNoteIcon(),requestAnimationFrame(this.animationLoop),this.zoomFactor>1&&this.refreshScroll()},beforeDestroy(){this.tween&&j().remove(this.tween),this.$root.$off("contextMenu:zoomIn",this.zoomIn),this.$root.$off("contextMenu:zoomOut",this.zoomOut),this.$root.$off("bottomMenu:zoomIn",this.zoomIn),this.$root.$off("bottomMenu:zoomOut",this.zoomOut),this.$root.$off("zoomPanel",this.changeZoom),this.$root.$off("zoomMove",this.zoomMove),this.$root.$off("wheel",this.onWheel),this.$root.$off("nav:goRight",this.goFastRight),this.$root.$off("nav:goLeft",this.goFastLeft),this.$root.$off("publication:mouseleave",this.onMouseLeave)},watch:{pageSize(t){const e={width:t.width*this.zoomFactor,height:t.height*this.zoomFactor,zoomFactor:this.zoomFactor};this.$store.dispatch("pages/changePageSize",e),this.slidesCacheUpdate()},isSingleMode(){this.slidesCacheUpdate()},isSlideMode(){this.slidesCacheUpdate()},isRtl(){this.slidesCacheUpdate()},zoomFactor(t,e){const i={width:this.pageSize.width*t,height:this.pageSize.height*t,zoomFactor:t};if(this.$store.dispatch("pages/changePageSize",i),t>1&&1===e){const t=[...this.slidesCache.current.map((t=>t.id))].filter((t=>null!==t)).some((t=>this.$store.getters["pages/pageProp"](t,"textBlocks")),this);this.selectTextEnabled&&t&&this.showSelectTextTip()}this.refreshScroll()},status(t){"sliding"===t?this.$store.dispatch("pager/isPageChanging",!0):this.$store.state.pager.isMoveWatcherActive||this.$store.dispatch("pager/isPageChanging",!1),this.refreshScroll(),this.$store.dispatch("workspace/setStatus",t);const e=["sliding","pan"].indexOf(status)>=0?"inProgress":"pending";this.$store.dispatch("pager/setFlipState",{newState:e}),"ready"!==t||this.isFastSliding?this.$store.dispatch("workspace/setAnimationProgress",{animationType:"pagerMove"}):this.$store.dispatch("workspace/unsetAnimationProgress"),this.updateNoteIcon()},slides(t,e){if(this.scrollLock)return void(this.scrollLock=!1);const i=e.current[0].state,s=t.current[0].state;if(i.mode!==s.mode)return;this.isSlideMode||this.isSingleMode||this.updateHorizontalScale(t.current,e.current);const o=this.$store.getters["pager/getDeltaTurns"](i,s),r=Math.abs(o)>1;s.zoomMode===i.zoomMode||o?!this.isRtl&&o>0||this.isRtl&&o<0?(r&&this.replaceCachedSlide("right",t.current),this.isZoomed?(this.pendingSlide="right",this.zoomOut()):this.$nextTick((()=>{this.animateSlides("right",!1,!0)}))):(!this.isRtl&&o<0||this.isRtl&&o>0)&&(r&&this.replaceCachedSlide("left",t.current),this.isZoomed?(this.pendingSlide="left",this.zoomOut()):this.$nextTick((()=>{this.animateSlides("left",!1,!0)}))):s.zoomMode?this.zoomIn():this.zoomOut()},workspaceSize(t,e){if(this.isMobile&&e.width&&e.height&&(t.width!==e.width||t.height!==e.height))this.zoomOut(!0);else if(1!==this.zoomFactor){let e;e=this.isInitialZoom?{x:this.isRTLBook?this.spreadSizes.current.width:0,y:0}:{x:t.width/2,y:t.height/2};const i={x:e.x-this.spreadSizes.current.left,y:e.y-this.spreadSizes.current.top};let s;this.scaleFactor=1,s=this.isInitialZoom?ms(this.containerSize,this.spreadSizes.current,this.scaleFactor,i):fs(this.spreadSizes.current,this.scaleFactor,i),s=bs(s,this.containerSize),this.scaleOrigin=Ss(this.spreadSizes.current,s,this.scaleFactor),this.slideScrollLeft=s.left,this.slideScrollTop=s.top,this.isInitialZoom&&(this.$store.dispatch("workspace/clearInitialZoom"),this.refreshScroll())}},containerSize(){1===this.zoomFactor||this.isMobile||this.refreshScroll()},pageSizes(t){const e=this.slidesCache;Object.keys(e).forEach((i=>{for(let s=0;s<e[i].length;s++){const o=e[i][s].id,r=this.getPageProp(o,"wide"),a=t[i].width*(this.isSingleMode&&r?2:1),n=t[i].height,h=r&&"current"!==i&&o===e.current[0].id;if(this.zoomFactor>1&&"current"!==i||this.isSingleMode&&h)return;this.$store.dispatch("pages/setCurrentSize",{pageID:o,value:{width:a,height:n}})}}))},spreadSizes(t){this.$store.dispatch("workspace/setHolderSize",t.current),this.updateNoteIcon()},isLocaleRtl(){this.updateNoteIcon()},notesEnabled(){this.updateNoteIcon()},dragActive(t){t?this.$refs.holder.$el.classList.remove("nodrag"):this.$refs.holder.$el.classList.add("nodrag")},isMini(){this.zoomOut(!0),this.updateNoteIcon()},orientationChanged(t,e){e&&this.zoomOut(!0)}},computed:{isRTLBook:function(){return this.$store.state.book.rightToLeft},isFirstPage(){return this.$store.getters["pager/isFirstSpread"]},isLastPage(){return this.$store.getters["pager/isLastSpread"]},isRightmostPage(){return this.isFirstPage&&this.isRtl||this.isLastPage&&!this.isRtl},isLeftmostPage(){return this.isLastPage&&this.isRtl||this.isFirstPage&&!this.isRtl},isRtl(){return this.$store.state.book.rightToLeft},isLocaleRtl:function(){return this.$store.getters["i18n/isLocaleRtl"]},isMobile(){return this.$store.getters["workspace/isMobile"]},isSingleMode(){return this.$store.state.pager.singleMode},isSpreadMode(){return this.$store.state.pager.spreadMode},isSlideMode(){return this.$store.state.pager.slideMode},isContentCropMode(){return this.isSlideMode&&this.$store.state.book.contentCrop},isZoomed(){return 1!==this.zoomFactor},isInitialZoom(){return this.$store.state.workspace.initialZoom},zoomPanel(){return this.$store.state.workspace.zoomPanel},slides(){const t={},e=this.isRtl?"right":"left",i=this.isRtl?"left":"right",s=this.$store.getters["pager/state"],o=this.$store.getters["pager/nextState"],r=this.$store.getters["pager/prevState"],a=this.$store.getters["pager/secondNextState"],n=this.$store.getters["pager/secondPrevState"],h=this.isRtl?o:r,l=this.isRtl?r:o,c=this.isRtl?a:n,d=this.isRtl?n:a,p=(e,i,o,r,a,n)=>{if(n||(t[e]=[]),!i)return;let h=this.$store.getters["pages/pageIndexById"](i);r&&o===(this.isRtl?"left":"right")&&h++;const l=this.$store.getters["pages/pageCaptionByIndex"](h),c=this.$store.getters["pages/pageProp"](i,"backgroundColor"),d=this.isSlideMode&&r?"page-wide":"page",p={backgroundColor:c};this.isFastSliding&&(p["font-size"]=Math.min(Math.floor(this.containerSize.height/20),20)+"px"),t[e].push({id:i,side:o,caption:l,icon:d,style:p,wide:r,position:a,state:s})};if(s.singleMode)p("current",s.currentPage,s.pageSide,s.wide,""),h&&p("left",h.currentPage,h.pageSide,h.wide,""),l&&p("right",l.currentPage,l.pageSide,l.wide,""),c&&p("second-left",c.currentPage,c.pageSide,c.wide,""),d&&p("second-right",d.currentPage,d.pageSide,d.wide,"");else if(s.slideMode){if(t.current=[],s.currentPage){const t=s.wide?"both":e;p("current",s.currentPage,t,s.wide,e)}if(h){const t=h.wide?"both":e;p("left",h.currentPage,t,h.wide,e)}if(l){const t=l.wide?"both":e;p("right",l.currentPage,t,l.wide,e)}if(c){const t=c.wide?"both":e;p("second-left",c.currentPage,t,c.wide,e)}if(d){const t=d.wide?"both":e;p("second-right",d.currentPage,t,d.wide,e)}}else if(s.spreadMode){const t=(t,s)=>{const o=this.getPageProp(s.leftPage,"wide"),r=o?"both":e;if(p(t,s.leftPage,r,o,e),s.rightPage&&s.leftPage!==s.rightPage){const e=o?"both":i;p(t,s.rightPage,e,o,i,!0)}};t("current",s),h&&t("left",h),l&&t("right",l),c&&t("second-left",c),d&&t("second-right",d)}return t},fitPageSize(){return(0,ae.Tj)(this.pageSize,this.containerSize)},fitDoublePageSize(){return(0,ae.Tj)({width:2*this.pageSize.width,height:this.pageSize.height},this.containerSize)},fitSinglePageSize(){return{width:this.fitDoublePageSize.width/2,height:this.fitDoublePageSize.height,top:this.fitDoublePageSize.top,left:(this.containerSize.width-this.fitDoublePageSize.width/2)/2}},pageSizes(){const t={},e=this.fitPageSize,i=this.fitDoublePageSize,s=this.fitSinglePageSize;for(const o in this.slidesCache){if(!this.slidesCache.hasOwnProperty(o))return;const r="current"===o?this.zoomFactor:1;if(this.isSingleMode)t[o]={width:Math.round(e.width*r),height:Math.round(e.height*r)};else if(this.isContentCropMode){const e=this.getContentSize(this.slidesCache[o][0].id);t[o]={width:Math.round(e.width*r),height:Math.round(e.height*r),left:e.left,top:e.top}}else{const e=this.slidesCache[o][0].wide;t[o]={width:Math.round((e?i.width:s.width)*r),height:Math.round((e?i.height:s.height)*r)}}}return t},spreadSizes(){const t={};for(const e in this.slidesCache){if(!this.slidesCache.hasOwnProperty(e))return;if(t[e]={width:this.pageSizes[e].width*this.slidesCache[e].length,height:this.pageSizes[e].height},this.isZoomed&&"current"===e)t[e].left=this.slideScrollLeft,t[e].top=this.slideScrollTop;else if(this.isSingleMode)t[e].left=this.fitPageSize.left,t[e].top=this.fitPageSize.top;else if(this.isContentCropMode)t[e].left=this.pageSizes[e].left,t[e].top=this.pageSizes[e].top;else{const i=2===this.slidesCache[e].length||this.slidesCache[e][0].wide;t[e].left=i?this.fitDoublePageSize.left:this.fitSinglePageSize.left,t[e].top=i?this.fitDoublePageSize.top:this.fitSinglePageSize.top}}return t},holderClasses(){return{zoomed:this.isZoomed,"drag-active":this.dragging,single:this.isSingleMode}},spreadStyles(){const t={};return t.current={width:this.spreadSizes.current.width+"px",height:this.spreadSizes.current.height+"px",left:this.isZoomed?this.containerSize.width>=this.spreadSizes.current.width?Math.round((this.containerSize.width-this.spreadSizes.current.width)/2)+"px":0:Math.round(this.spreadSizes.current.left)+"px",top:this.isZoomed?this.containerSize.height>=this.spreadSizes.current.height?Math.round((this.containerSize.height-this.spreadSizes.current.height)/2)+"px":0:Math.round(this.spreadSizes.current.top)+"px",transformOrigin:Math.round(this.scaleOrigin.x)+"px "+Math.round(this.scaleOrigin.y)+"px",transition:"animating"===this.status?["-webkit-transform "+(this.fastAnimation?1:this.zoomAnimationSpeed)+"ms cubic-bezier(0.215, 0.61, 0.355, 1)","transform "+(this.fastAnimation?1:this.zoomAnimationSpeed)+"ms cubic-bezier(0.215, 0.61, 0.355, 1)"]:["-webkit-transform 0ms","transform 0ms"]},"pinch"!==this.status&&"scale"!==this.status&&"animating"!==this.status?t.current.transform="":0!==this.slideScrollTop||0!==this.slideScrollLeft?t.current.transform="translate3d("+(this.containerSize.width<this.spreadSizes.current.width?Math.round(this.slideScrollLeft):0)+"px,"+(this.containerSize.height<this.spreadSizes.current.height?Math.round(this.slideScrollTop):0)+"px, 0) scale("+this.scaleFactor.toFixed(2)+")":t.current.transform="scale("+this.scaleFactor.toFixed(2)+")",this.slidesCache.left&&(t.left={width:this.spreadSizes.left.width+"px",height:this.spreadSizes.left.height+"px",left:Math.round(this.spreadSizes.left.left)+"px",top:Math.round(this.spreadSizes.left.top)+"px"}),this.slidesCache.right&&(t.right={width:this.spreadSizes.right.width+"px",height:this.spreadSizes.right.height+"px",left:Math.round(this.spreadSizes.right.left)+"px",top:Math.round(this.spreadSizes.right.top)+"px"}),this.slidesCache["second-left"]&&(t["second-left"]={width:this.spreadSizes["second-left"].width+"px",height:this.spreadSizes["second-left"].height+"px",left:Math.round(this.spreadSizes["second-left"].left)+"px",top:Math.round(this.spreadSizes["second-left"].top)+"px"}),this.slidesCache["second-right"]&&(t["second-right"]={width:this.spreadSizes["second-right"].width+"px",height:this.spreadSizes["second-right"].height+"px",left:Math.round(this.spreadSizes["second-right"].left)+"px",top:Math.round(this.spreadSizes["second-right"].top)+"px"}),t},slideStyles(){const t={};return t.current={transform:"translate3d("+Math.round(this.slideOffsets.current)+"px, 0, 0)"},this.slidesCache.left&&(t.left={transform:"translate3d("+Math.round(this.slideOffsets.left)+"px, 0, 0)"}),this.slidesCache.right&&(t.right={transform:"translate3d("+Math.round(this.slideOffsets.right)+"px, 0, 0)"}),this.slidesCache["second-left"]&&(t["second-left"]={transform:"translate3d("+Math.round(-this.maxDelta)+"px, 0, 0)",display:"none"}),this.slidesCache["second-right"]&&(t["second-right"]={transform:"translate3d("+Math.round(this.maxDelta)+"px, 0, 0)",display:"none"}),t},slideOffsets(){return{current:this.delta,left:-this.maxDelta+this.delta,right:this.maxDelta+this.delta}},maxDelta(){return parseInt(this.containerSize.width,10)},minZoom(){return Math.min(this.$store.state.workspace.containerSize.height/(this.$store.state.pages.size.height/this.$store.state.pages.size.zoomFactor),this.$store.state.workspace.containerSize.width/(2*this.$store.state.pages.size.width/this.$store.state.pages.size.zoomFactor))},maxZoom(){return this.$store.state.workspace.maxZoom},zoomAnimationSpeed(){return this.scaleFactor<1?400:600},slideAnimationSpeed:()=>400,slideEasing:()=>j().Easing.Sinusoidal.Out,isWorkspaceFrozen(){return this.$store.state.workspace.freezed},isPagerFrozen(){return this.$store.getters["pager/isFrozen"]},workspaceSize(){return this.$store.state.workspace.size},isMobileApp(){return"mobile-app"===this.$store.getters["info/version"]},isMini(){return this.$store.state.workspace.mini},isEmbed(){return this.$store.state.workspace.isEmbed},isMovingNote(){return this.$store.state.notes.isMoving},blockPan(){return this.isWorkspaceFrozen||this.isZoomed||this.isMovingNote},selectTextEnabled(){return!this.isMobile&&this.$store.state.workspace.components.textSelection},isSafari(){return!!this.$store.state.workspace.userAgentInfo.browser.safari},wheelScroll(){return this.$store.state.workspace.wheelScroll},notesEnabled(){return this.$store.state.workspace.components.notes},addNoteTitleText:function(){return this.$t("NotesToolWindow.ADD_NOTE")},noteIconShown(){return this.notesEnabled&&!this.isMobile&&!this.isMini&&!this.isZoomed&&"ready"===this.status&&this.spreadSizes.current},orientationChanged(){return this.$store.getters["workspace/orientation"]}},methods:{animationLoop(t){this._isDestroyed||(j().update(t),requestAnimationFrame(this.animationLoop))},getContentSize(t){const e=this.getPageProp(t,"width"),i=this.getPageProp(t,"height");return(0,ae.Tj)({width:e,height:i},this.containerSize)},getPageProp(t,e){if(!(0,y.o8)(this.propCache[t])&&!(0,y.o8)(this.propCache[t][e]))return this.propCache[t][e];(0,y.o8)(this.propCache[t])&&(this.propCache[t]={});const i=this.$store.getters["pages/pageProp"](t,e);return this.propCache[t][e]=i,i},zoomMove(t){if(!t||!t.direction)return;if("ready"!==this.status)return void("drag"===t.direction&&(this.dragActive=t.active));let e;switch(t.direction){case"left":case"right":e=this.getScrollAmount(t,this.scrollComponent.x,0,this.containerSize,this.spreadSizes.current),this.scrollComponent.scrollBy(e,0);break;case"up":case"down":e=this.getScrollAmount(t,0,this.scrollComponent.y,this.containerSize,this.spreadSizes.current),this.scrollComponent.scrollBy(0,e);break;case"drag":this.dragActive=t.active,this.initScrollComponent(this.dragActive)}this.scrollComponent&&(this.holderScrollX=this.scrollComponent.x,this.holderScrollY=this.scrollComponent.y,this.$store.dispatch("text/setHolderScroll",{x:this.holderScrollX,y:this.holderScrollY}))},onDoubleTap(t){this.onTap("tap",t)},onTap(t,e){if(t&&this.$store.dispatch("pager/setLastTarget",t),this.isWorkspaceFrozen||"ready"!==this.status||this.isMini)return;if(e?.target?.classList?.contains("note-article"))return;e||(e={center:{x:this.isRTLBook?this.workspaceSize.width:0,y:0},target:null});let i,s=!1;const o=this.getTappedZoomBlock(e);if(this.isMobile&&o.id){s=this.lastZoomBlockID!==o.id;const t=this.$refs.current[0].$el.getBoundingClientRect();i=this.getBlockRect(o.rect,t)}if(this.lastZoomBlockID=s?o.id:null,s){const t=1.5,e=40;let s=2,o=this.containerSize.width-e*s,r=1*(.96*o/i.width).toFixed(2);const a=this.spreadSizes.current.width-i.width-i.left;(i.left*r<e||a*r<e)&&(s=1,o=this.containerSize.width-e*s,r=1*(.96*o/i.width).toFixed(2)),this.updateSlideScroll(),this.scaleFactor=this.checkScaleFactorForZoom(r,this.zoomFactor,this.maxZoom),this.scaleFactor*this.zoomFactor<t&&(this.scaleFactor=t/this.zoomFactor)}else{const t=!(this.isFirstPage||this.isLastPage||!this.slidesCache.current[0].wide&&1===this.slidesCache.current.length)||this.isSingleMode||this.isContentCropMode?1:2,e=this.containerSize.width/this.spreadSizes.current.width*t*this.horizontalScale;this.scaleFactor=1!==this.zoomFactor||this.zoomPanel?Math.min(e,this.containerSize.height/this.spreadSizes.current.height):this.lastZoomFactor,this.horizontalScale=1}let r=fs(this.spreadSizes.current,this.scaleFactor,{x:e.center.x-this.spreadSizes.current.left,y:e.center.y-this.spreadSizes.current.top});if(s){const t=i.left*this.scaleFactor,e=i.width*this.scaleFactor;r.left=-t+(this.containerSize.width-e)/2}r=bs(r,this.containerSize),this.scaleOrigin=Ss(this.spreadSizes.current,r,this.scaleFactor),this.newBounds=r,this.status="animating",this.refreshScroll(),this.scaleFactor>1?this.$root.$emit("zoomed"):(this.scaleFactor<1||this.zoomPanel&&1===this.scaleFactor)&&this.$root.$emit("unzoomed")},setZoom(t,e){if(this.isWorkspaceFrozen||"ready"!==this.status)return;this.scaleFactor=t/this.zoomFactor,this.updateSlideScroll(!1);const i=e||{x:this.workspaceSize.width/2,y:this.workspaceSize.height/2},s={x:i.x-this.spreadSizes.current.left,y:i.y-this.spreadSizes.current.top};let o=fs(this.spreadSizes.current,this.scaleFactor,s);o=bs(o,this.containerSize),this.scaleOrigin=Ss(this.spreadSizes.current,o,this.scaleFactor),this.newBounds=o,this.fastAnimation=!0,this.status="animating",this.refreshScroll()},setScaleStart(){this.minScale=Math.min(this.containerSize.width/this.spreadSizes.current.width,this.containerSize.height/this.spreadSizes.current.height),this.maxScale=this.maxZoom/this.zoomFactor,this.scaleFactor=1,this.updateSlideScroll(!1),this.scaleOrigin={x:this.workspaceSize.width/2-this.slideScrollLeft,y:this.workspaceSize.height/2-this.slideScrollTop},this.status="scale"},setScale(t){if("scale"!==this.status)return;const e=this.minScale+(this.maxScale-this.minScale)*t;let i=fs(this.spreadSizes.current,e,{x:this.workspaceSize.width/2-this.slideScrollLeft,y:this.workspaceSize.height/2-this.slideScrollTop});i=bs(i,this.containerSize),this.scaleOrigin=Ss(this.spreadSizes.current,i,e);const s=Math.min(this.maxScale,Math.max(this.minScale,e));this.scaleFactor=this.checkScaleFactorForZoom(s,this.zoomFactor,this.maxZoom)},setScaleFinish(){if("scale"!==this.status)return;let t=fs(this.spreadSizes.current,this.scaleFactor,this.scaleOrigin);t=bs(t,this.containerSize),this.zoomFactor=1*(this.zoomFactor*this.scaleFactor).toFixed(2),this.scaleFactor=1,this.slideScrollLeft=this.isZoomed?t.left:0,this.slideScrollTop=this.isZoomed?t.top:0,this.status="ready"},onTransitionEnd(t){t&&"transform"===t.propertyName&&("animating"===this.status&&(this.fastAnimation=!1,this.lastZoomFactor=Math.max(this.zoomFactor,this.minZoomFactor),this.zoomFactor=1*(this.zoomFactor*this.scaleFactor).toFixed(2),this.slideScrollLeft=this.isZoomed?this.newBounds.left:0,this.slideScrollTop=this.isZoomed?this.newBounds.top:0,this.status="ready"),this.pendingSlide&&(this.updatePendingSlide(),this.animateSlides(this.pendingSlide,!1,!0),this.pendingSlide=null))},onPinchStart(t){this.isWorkspaceFrozen||"ready"!==this.status||this.isMini||(this.$store.dispatch("pager/setLastTarget","pinch-zoom"),this.minScale=Math.min(this.containerSize.width/this.spreadSizes.current.width,this.containerSize.height/this.spreadSizes.current.height),this.scaleFactor=1,this.pinchCenter=t.center,this.isZoomed?(this.updateSlideScroll(!1),this.scaleOrigin={x:t.center.x-this.slideScrollLeft,y:t.center.y-this.slideScrollTop}):this.scaleOrigin={x:t.center.x-this.spreadSizes.current.left,y:t.center.y-this.spreadSizes.current.top},this.status="pinch")},onPinchMove(t){if("pinch"!==this.status)return;const e=this.minScale<t.scale?t.scale:this.minScale;if(this.scaleFactor=this.checkScaleFactorForZoom(e,this.zoomFactor,this.maxZoom),1!==this.scaleFactor){let t=fs(this.spreadSizes.current,this.scaleFactor,this.scaleOrigin);t=bs(t,this.containerSize),this.scaleOrigin=Ss(this.spreadSizes.current,t,this.scaleFactor)}},onPinchFinish(){if("pinch"!==this.status)return;let t=fs(this.spreadSizes.current,this.scaleFactor,this.scaleOrigin);t=bs(t,this.containerSize),this.zoomFactor=1*(this.zoomFactor*this.scaleFactor).toFixed(2),this.scaleFactor=1,this.slideScrollLeft=this.isZoomed?t.left:0,this.slideScrollTop=this.isZoomed?t.top:0,this.status="ready",this.scaleFactor>1?this.$root.$emit("zoomed"):this.scaleFactor<1&&this.$root.$emit("unzoomed")},changeZoom(t){switch(this.$store.dispatch("pager/setLastTarget","change-zoom"),t.action){case"setZoom":this.setZoom(t.zoomFactor);break;case"startScale":this.setScaleStart();break;case"changeScale":this.setScale(t.scalePosition);break;case"endScale":this.setScaleFinish();break;case"zoomIn":this.onTap();break;case"zoomOut":this.zoomOut()}},onPanStart(t){if(this.blockPan||this.isFastSliding||"ready"!==this.status||t.srcEvent&&(t.srcEvent.metaKey||t.srcEvent.ctrlKey))return;if(t?.target?.classList?.contains("note-article"))return;const e=document.elementFromPoint(t.center.x-t.deltaX,t.center.y-t.deltaY);e&&"select-text-block"===e.getAttribute("data-set")||(this.status="pan",this.$root.$emit("turnStart"))},onPanMove(t){if(this.blockPan||this.isFastSliding||"pan"!==this.status)return;if(t?.target?.classList?.contains("note-article"))return;let e=1;(t.deltaX<0&&this.isRightmostPage||t.deltaX>0&&this.isLeftmostPage)&&(e=.3),window.requestAnimationFrame((()=>{this.delta=t.deltaX*e}))},onPanEnd(t){if(this.blockPan||!this.isFastSliding&&"pan"!==this.status&&"sliding"!==this.status)return;if(t?.target?.classList?.contains("note-article"))return;const e=Math.abs(t.overallVelocityX).toPrecision(2),i=Math.abs(t.deltaX);let s,o=null;t.deltaX>0&&!this.isLeftmostPage&&(i>this.maxDelta/3||e>.5)?(s="left",o="left"):t.deltaX<0&&!this.isRightmostPage&&(i>this.maxDelta/3||e>.5)?(s="right",o="right"):(s="center",o=t.deltaY>0?"down":t.deltaY<0?"up":null),("sliding"===this.status||this.isFastSliding)&&(this.checkFastSlide(s,!1),this.pendingFastSlide)||("left"===s&&!this.isLeftmostPage&&(i>this.maxDelta/3||e>.5)?this.animateSlides("left"):"right"===s&&!this.isRightmostPage&&(i>this.maxDelta/3||e>.5)?this.animateSlides("right"):"sliding"!==this.status&&this.animateSlides("center"),o&&this.$root.$emit("swipe",{direction:o}))},zoomIn(t){this.zoomFactor>1||this.onTap(t)},zoomOut(t,e){if(1!==this.zoomFactor){if(this.lastZoomFactor=Math.max(this.zoomFactor,this.minZoomFactor),t)return this.status="calculating",this.zoomFactor=1,this.refreshScroll(),this.slideScrollLeft=0,this.slideScrollTop=0,this.status="ready",void this.$root.$emit("unzoomed");this.onTap(e,{center:{x:0,y:0}})}},goRight(){this.scrollLock=!0,this.movePagerRight({target:"slide-swipe"}),this.$root.$emit("render:finish")},goLeft(){this.scrollLock=!0,this.movePagerLeft({target:"slide-swipe"}),this.$root.$emit("render:finish")},goFastRight(){this.checkFastSlide("right")},goFastLeft(){this.checkFastSlide("left")},canSlideInDirection(t){return t&&("left"===t&&!this.isLeftmostPage||"right"===t&&!this.isRightmostPage)},checkFastSlide(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.canSlideInDirection(t)&&(this.isFastSliding&&(this.isSpreadFillerShown=!0),this.pendingFastSlide&&this.pendingFastSlide!==t&&(this.pendingFastSlide=null),"sliding"===this.status&&this.tween?._isPlaying&&this.isPagerFrozen&&(this.isFastSliding=!0,e&&this.tween.stop()),!this.pendingFastSlide&&this.isFastSliding&&this.tween?._isPlaying&&(this.tween._duration=200,this.pendingFastSlide=t),this.isFastSliding&&(clearTimeout(this.fastSlidingCancelTimeout),this.fastSlidingCancelTimeout=setTimeout((()=>{this.isFastSliding=!1,this.isSpreadFillerShown=!1,this.$store.dispatch("workspace/unsetAnimationProgress")}),400)))},animateSlides(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s={x:this.delta};let o;switch(t){case"left":o={x:this.maxDelta};break;case"right":o={x:-this.maxDelta};break;case"center":o={x:0}}i&&this.$root.$emit("turnStart"),this.status="sliding",this.$store.dispatch("pager/freeze",{target:"slide-book"}),this.tween=new(j().Tween)(s).to(o,e||this.isFastSliding?200:this.slideAnimationSpeed).easing(this.slideEasing).onUpdate((t=>{this.delta=t.x})).onComplete((()=>{this.$root.$emit("turnStop"),this.$store.dispatch("pager/unfreeze",{target:"slide-book"}),i?this.$root.$emit("render:finish"):"left"===t?this.goLeft():"right"===t&&this.goRight(),this.slidesCacheUpdate(),this.status="ready","center"!==t&&this.$root.$emit("turned"),this.pendingFastSlide&&this.canSlideInDirection(this.pendingFastSlide)&&(this.animateSlides(this.pendingFastSlide),this.pendingFastSlide=null)})).onStop((()=>{this.slidesCacheUpdate(),this.$store.dispatch("pager/unfreeze",{target:"slide-book"})})).start()},updateHorizontalScale(t,e){let i=0;(e[0].wide||2===e.length)&&i--,(t[0].wide||2===t.length)&&i++,this.horizontalScale=i>0?2:i<0?.5:1},convertToOutputSlides(t){const e=e=>({position:e,pages:t[e]||[]});return[e("current")].concat([e("left")]).concat([e("right")]).concat([e("second-left")]).concat([e("second-right")]).filter((t=>t.pages.length>0))},getSlidesWithAllPages(t,e){const i=[].concat.apply([],t.map((t=>t.pages))),s=[].concat.apply([],e.map((t=>t.pages))).filter((t=>!i.some((e=>e.id===t.id))));t.forEach((t=>{t.pages=t.pages.filter((t=>!s.some((e=>t.id===e.id))))})),s.length>0&&s.forEach((e=>{const i={position:"hidden page_"+e.id,pages:[e]};t=t.concat([i])}));return t.sort(((t,e)=>t.pages[0].id-e.pages[0].id))},getNonHiddenSlides:t=>t.filter((t=>t.position.indexOf("hidden")<0)),updateOutputSlides(){const t=this.convertToOutputSlides(this.slidesCache);this.outputSlidesCache=this.getSlidesWithAllPages(t,this.outputSlidesCache),this.$nextTick((()=>{this.outputSlidesCache=this.getNonHiddenSlides(this.outputSlidesCache)}))},slidesCacheUpdate(){this.slidesCache=this.slides,this.delta=0,this.updateOutputSlides()},updatePendingSlide(){this.pendingSlide&&this.replaceCachedSlide(this.pendingSlide,this.slides.current)},replaceCachedSlide(t,e){this.slidesCache[t]=e,this.updateOutputSlides()},contentCreator:t=>Ps["content-"+t.type],refreshScroll(){this.isInitialZoom||(this.cancelDragging(),this.$nextTick((()=>{this.isZoomed&&"ready"===this.status?(this.initScrollComponent(this.dragActive),this.scrollComponent.refresh()):this.scrollComponent&&(this.slideScrollX=0,this.slideScrollY=0,this.$store.dispatch("text/setHolderScroll",{x:this.slideScrollX,y:this.slideScrollY}),this.scrollComponent.refresh(),this.scrollComponent.destroy(),delete this.scrollComponent)})))},initScrollComponent(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(1===this.zoomFactor)return;this.scrollComponent?(this.slideScrollX=this.scrollComponent.x,this.slideScrollY=this.scrollComponent.y,this.scrollComponent.off("beforeScrollStart",this.setDragging),this.scrollComponent.off("scrollCancel",this.cancelDragging),this.scrollComponent.off("scroll",this.onScrollBegin),this.scrollComponent.off("scrollEnd",this.onScrollEnd),this.scrollComponent.destroy(),delete this.scrollComponent):(this.slideScrollX=this.containerSize.width<this.spreadSizes.current.width?Math.round(this.slideScrollLeft):0,this.slideScrollY=this.containerSize.height<this.spreadSizes.current.height?Math.round(this.slideScrollTop):0),this.scrollComponent=new vs.ZP(this.$refs.wrapper[0],{mouseWheel:t,scrollbars:!1,freeScroll:!this.isMobile,scrollX:this.containerSize.width<this.spreadSizes.current.width,scrollY:this.containerSize.height<this.spreadSizes.current.height,probeType:this.isSafari?3:1,bindToWrapper:this.isMobile,bounce:!1,useTransition:!0,startX:this.slideScrollX,startY:this.slideScrollY,disablePointer:!0,disableTouch:!1,disableMouse:!t}),this.$store.dispatch("text/setHolderScroll",{x:this.slideScrollX,y:this.slideScrollY}),this.scrollComponent.on("beforeScrollStart",this.setDragging),this.scrollComponent.on("scrollCancel",this.cancelDragging),this.scrollComponent.on("scroll",this.onScrollBegin),this.scrollComponent.on("scrollEnd",this.onScrollEnd);this.scrollComponent.scroller.translater.hooks.on("beforeTranslate",(()=>{"text-context-menu"===this.$store.state.workspace.activeInteractiveElement?this.$store.dispatch("workspace/setActiveInteractiveElement","selected-text"):"selected-text"!==this.$store.state.workspace.activeInteractiveElement&&this.$store.dispatch("workspace/setActiveInteractiveElement",null)}))},onScrollEnd:function(){this.cancelDragging(),this.slideScrollX=this.scrollComponent.x,this.slideScrollY=this.scrollComponent.y,this.$store.dispatch("text/setHolderScroll",{x:this.slideScrollX,y:this.slideScrollY})},onScrollBegin:function(){this.slideScrollX=this.scrollComponent.x,this.slideScrollY=this.scrollComponent.y,this.$store.dispatch("text/setHolderScroll",{x:this.slideScrollX,y:this.slideScrollY})},setDragging:function(){1!==this.zoomFactor&&(this.dragging=!0)},cancelDragging:function(){this.dragging=!1},onWheel(t){if(!(!this.wheelScroll||this.isMini||Date.now()-this.lastWheelTime<200||t.target&&"note-article"===t.target.className)){if(t.ctrlKey||t.metaKey){if("ready"!==this.status)return;const e=-1*t.deltaY,i=this.getSuitableZoomFactor(this.zoomFactor,e,this.minZoom,this.maxZoom);e<0&&!i&&this.zoomOut(!1,"wheel-zoom"),i&&(this.$store.dispatch("pager/setLastTarget","wheel-zoom"),this.setZoom(i,{x:t.clientX,y:t.clientY}))}else{if(this.zoomFactor>1||this.scaleFactor>1)return;this.$store.state.notes.opened&&this.$store.dispatch("notes/setOpenedId",{id:null}),t.deltaY>0&&(this.$store.getters["pager/nextPageId"]||0===this.$store.getters["pager/nextPageId"])?(this.checkFastSlide(this.isRTLBook?"left":"right"),this.$store.dispatch("pager/goForward",{target:"wheel"})):t.deltaY<0&&(this.$store.getters["pager/prevPageId"]||0===this.$store.getters["pager/prevPageId"])&&(this.checkFastSlide(this.isRTLBook?"right":"left"),this.$store.dispatch("pager/goBackward",{target:"wheel"}))}this.lastWheelTime=Date.now()}},updateSlideScroll(t){t&&!this.isZoomed||(this.containerSize.width<this.spreadSizes.current.width&&(this.slideScrollLeft=this.slideScrollX),this.containerSize.height<this.spreadSizes.current.height&&(this.slideScrollTop=this.slideScrollY))},addNote(){const t=this.$store.getters["pager/state"],e=t.spreadMode;let i=this.slides.current[0].id;e&&this.slides.current[1]&&this.isRtl===this.isLocaleRtl&&(i=this.slides.current[1].id);const s=e&&!(this.isLocaleRtl&&t.leftPage===t.rightPage),o=this.isSingleMode&&this.slides.current[0].wide&&"right"===this.slides.current[0].side,r=this.isSlideMode&&this.slides.current[0].wide,a=s||o;this.$store.dispatch("notes/addNote",{pageId:i,wide:r,wideRight:a,target:"slideBook"})},updateNoteIcon(){if(!this.noteIconShown)return this.noteIconClass=[],void(this.noteIconStyle=null);const t={},e=[];if(this.isLocaleRtl){e.push("left");const i=this.spreadSizes.current.left-30;t.left=Math.max(i,0)+"px",i>0&&e.push("outside")}else{e.push("right");const i=this.spreadSizes.current.left+this.spreadSizes.current.width;t.left=Math.min(i,this.containerSize.width-30)+"px",i<this.containerSize.width-30&&e.push("outside")}t.top=this.spreadSizes.current.top+"px",this.noteIconStyle=t,this.noteIconClass=e},onMouseLeave(t){this.onPanEnd(t),this.refreshScroll()}}},Ts=Cs;const Ms=(0,R.Z)(Ts,$s,zs,!1,null,"abc0669c",null).exports;var Is=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showLogo?i("div",{staticClass:"logo-container",class:t.containerClasses,style:t.containerStyles},[i(t.logoLinkUrl?"button":"div",{tag:"component",staticClass:"logo-link",style:t.logoStyles,attrs:{role:t.logoLinkUrl?"link":"none",tabindex:t.logoLinkUrl?"0":"-1","aria-label":t.label},on:{click:t.onClick}},[t.customLogoUrl?i("img",{staticClass:"logo-custom",style:t.imageStyles,attrs:{src:t.customLogoUrl,tabindex:"-1"}}):i("svgicon",{ref:"svgLogo",staticClass:"logo-svg",attrs:{name:"made-with",focusable:"false",tabindex:"-1"}})],1)],1):t._e()},Ls=[];i(5284);const Rs={name:"Logo",data:function(){return{isReady:!1,crossOrigin:(0,d.Z)().getCrossOrigin(),originalWidth:0,originalHeight:0,globalPadding:10,minimalSize:60,maxWidthLimit:200,bottomMenu:null,customLogoUrl:null}},mounted(){this.logoLoad(),this.setSvgTransform(),this.setBottomMenu()},beforeDestroy(){this.destroyImgBlob()},computed:{target(){return this.$store.state.logo.target},logoLinkUrl(){return this.$store.state.logo.url||null},position(){return this.$store.state.logo.position},level(){return-1===this.position.indexOf("bottom")?"top":"bottom"},side(){return-1===this.position.indexOf("left")?"right":"left"},miniState(){return this.$store.state.workspace.mini},rawCustomLogoUrl(){return this.$store.getters["logo/customLogoUrl"]},hasDefaultLogo(){return this.$store.getters["logo/hasDefaultLogo"]},svgLogoColor(){return this.opaqueBottom&&this.allowOpaqueBar&&"menuRect"===this.optimalRect.name?this.$store.state.skin.styles["main-icon-color"]:this.$store.state.skin.styles[(this.top?"top":"bottom")+"-"+(this.left?"left":"right")+"-icon-color"]},allowOpaqueBar(){return this.$store.state.logo.allowOpaqueBar},showLogo(){return this.$store.getters["logo/showLogo"]},containerSize(){return this.$store.getters["workspace/containerSize"]},holderSize(){return this.$store.getters["workspace/holderSize"]},workspaceSize(){return this.$store.getters["workspace/size"]},bottomMenuEnabled(){return this.$store.getters["workspace/desktopBottomBarVisible"]},maxWidth(){return Math.max(this.maxWidthLimit,this.containerSize.width/(this.bookMode?4:6))},bookMode(){return"flip-book"===this.$store.state.workspace.bookComponent},sideRect(){const t={};return t.width=(this.containerSize.width-this.holderSize.width)/2-2*this.globalPadding,t.height=this.containerSize.height/2-2*this.globalPadding,t[this.side]=this.globalPadding,t[this.level]=this.globalPadding,t.name="sideRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},levelRect(){const t={};return t.width=this.containerSize.width/2-2*this.globalPadding,t.height=(this.containerSize.height-this.holderSize.height)/2-2*this.globalPadding,t[this.side]=this.globalPadding,t[this.level]=this.globalPadding,t.name="levelRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},menuLevelRect(){if("top"===this.level||this.opaqueBottom||!this.bottomMenu)return{scale:0};const t={},e=this.bottomMenu.getBoundingClientRect();return t.width=(this.containerSize.width-e.width)/2-2*this.globalPadding,t.height=(this.workspaceSize.height-this.holderSize.height)/2-2*this.globalPadding,t[this.side]=this.globalPadding,t[this.level]=this.globalPadding-e.height,t.lockWidth=!0,t.name="menuLevelRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},menuSideRect(){if("top"===this.level||this.opaqueBottom||!this.bottomMenu)return{scale:0};const t={},e=this.bottomMenu.getBoundingClientRect();return t.width=(this.containerSize.width-Math.max(this.holderSize.width,e.width))/2-2*this.globalPadding,t.height=this.workspaceSize.height/2-2*this.globalPadding,t[this.side]=this.globalPadding,t[this.level]=this.globalPadding-e.height,t.name="menuSideRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},menuRect(){if("top"===this.level||this.opaqueBottom&&!this.allowOpaqueBar||!this.bottomMenu)return{scale:0};const t={},e=this.bottomMenu.getBoundingClientRect();return t.width=(this.containerSize.width-e.width)/2-10,t.height=e.height-10,t[this.side]=10,t[this.level]=8-e.height,t.lockWidth=!0,t.lockHeight=!0,t.name="menuRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},slideRect(){if(this.bookMode)return{scale:0};const t={};return t.width=this.containerSize.width/2,t.height=this.containerSize.height/2,t[this.side]=this.globalPadding,t[this.level]=this.globalPadding,t.sizeOverride=!0,t.name="slideRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},slideLevelRect(){if(this.bookMode||"top"===this.level||this.opaqueBottom||!this.bottomMenu)return{scale:0};const t={},e=this.bottomMenu.getBoundingClientRect();return t.width=(this.containerSize.width-e.width)/2-2*this.globalPadding,t.height=this.containerSize.height/2,t[this.side]=this.globalPadding,t[this.level]=this.globalPadding-e.height,t.sizeOverride=!0,t.lockWidth=!0,t.name="slideLevelRect",this.applySizeConstraints(t),t.scale=this.calculateScale(t),t},optimalRect(){const t=[this.menuRect];return this.bookMode?t.push(this.menuLevelRect,this.menuSideRect,this.levelRect,this.sideRect):t.push(this.slideLevelRect,this.slideRect),t.reduce(((t,e)=>e.scale>t.scale?e:t))},containerClasses(){return{overlap:!!this.optimalRect.sizeOverride}},containerStyles(){if(!this.optimalRect.scale)return{display:"none"};const t={opacity:this.isReady?1:0,width:this.originalWidth*this.optimalRect.scale+"px",height:this.originalHeight*this.optimalRect.scale+"px"};return t.top=(0,y.o8)(this.optimalRect.top)?null:this.optimalRect.top+"px",t.bottom=(0,y.o8)(this.optimalRect.bottom)?null:this.optimalRect.bottom+"px",t.left=(0,y.o8)(this.optimalRect.left)?null:this.optimalRect.left+"px",t.right=(0,y.o8)(this.optimalRect.right)?null:this.optimalRect.right+"px","0px"!==t.width&&"0px"!==t.height||(t.display="none"),t},logoStyles(){return this.hasDefaultLogo?{fill:this.svgLogoColor}:{}},imageStyles(){return{width:this.originalWidth*this.optimalRect.scale+"px",height:this.originalHeight*this.optimalRect.scale+"px"}},opaqueBottom(){return this.$store.state.skin&&this.$store.state.skin.styles&&(0,y.HD)(this.$store.state.skin.styles.classes)?-1!==this.$store.state.skin.styles.classes.indexOf("opaqueBottom"):null},label(){return this.logoLinkUrl?this.$i18n.t("TopMenu.EXTERNAL_LINK_TIP",{0:this.logoLinkUrl}):null}},watch:{bottomMenuEnabled(){this.setBottomMenu()},rawCustomLogoUrl:"logoLoad",hasDefaultLogo:"logoLoad",side:"setSvgTransform",optimalRect(t){this.$store.dispatch("logo/setFitRectName",t.name)}},methods:{setBottomMenu(){this.bottomMenu=this.bottomMenuEnabled?document.getElementsByClassName("bottom-toolbar")[0]:null},logoLoad(){this.isReady=!1,!this.hasDefaultLogo&&this.rawCustomLogoUrl?this.preloadImg(this.customLogoUrl):this.hasDefaultLogo&&(this.originalWidth=119,this.originalHeight=30,this.customLogoUrl=null,this.isReady=!0,this.$nextTick((()=>this.setSvgTransform())))},preloadImg(){(0,Me.Z)({url:this.rawCustomLogoUrl,callback:t=>{const e=document.createElement("img");e.onload=()=>{this.originalWidth=e.naturalWidth,this.originalHeight=e.naturalHeight,this.destroyImgBlob(),this.customLogoUrl=t,this.isReady=!0},e.onerror=()=>{},e.src=t,e.style.width="100%"}})},destroyImgBlob(){this.customLogoUrl&&window.URL.revokeObjectURL(this.customLogoUrl)},calculateScale(t){if(0===this.originalWidth||0===this.originalHeight)return 0;if(t.width<0||t.height<0)return 0;let e=1,i=1;return this.originalHeight>t.height&&(e=t.height/this.originalHeight),this.originalWidth>t.width&&(i=t.width/this.originalWidth),Math.min(i,e,1)},applySizeConstraints(t){!t.lockWidth&&t.width<this.originalWidth&&t.width<this.minimalSize&&(t.width=Math.max(this.minimalSize,t.width),t.sizeOverride=!0),!t.lockHeight&&t.height<this.originalHeight&&t.height<this.minimalSize&&(t.height=Math.max(this.minimalSize,t.height),t.sizeOverride=!0),t.width=Math.min(this.maxWidth,t.width)},onClick(){this.logoLinkUrl&&window.open(this.logoLinkUrl,"_blank");const t=this.$store.state.pager.currentPage;this.$root.$emit("link",{type:"external",source:"logo",url:this.logoLinkUrl,target:this.target,pageId:t})},setSvgTransform(){if(!this.hasDefaultLogo)return;const t=this.$refs.svgLogo?.$el.querySelector(".made-with");t&&("right"===this.side?t.setAttribute("transform","translate(62, 0)"):t.removeAttribute("transform"))}},components:{}};const Es=(0,R.Z)(Rs,Is,Ls,!1,null,"5bad4f5e",null).exports;var Fs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav-arrows"},[t.isFirstPage?t._e():i("v-touch",t._g({staticClass:"nav-btn nav-left-arrow",attrs:{tag:"button",title:t.leftArrowTitle},nativeOn:{touchstart:function(t){t.preventDefault()},keydown:function(e){return t.leftButtonKeyHandler(e)}}},t.isEmbed?{tap:t.goLeft}:{tap:t.goLeft,swipeleft:function(e){return t.goRight(e,!0)},swiperight:function(e){return t.goLeft(e,!0)}}),[i("transition",{attrs:{name:"bars-fade"}},[t.show?i("svgicon",{staticClass:"arrow",attrs:{focusable:"false",name:"mobile-left",height:"100%"}}):t._e()],1)],1),t._v(" "),t.isLastPage?t._e():i("v-touch",t._g({staticClass:"nav-btn nav-right-arrow",attrs:{tag:"button",title:t.rightArrowTitle},nativeOn:{touchstart:function(t){t.preventDefault()},keydown:function(e){return t.rightButtonKeyHandler(e)}}},t.isEmbed?{tap:t.goRight}:{tap:t.goRight,swipeleft:function(e){return t.goRight(e,!0)},swiperight:function(e){return t.goLeft(e,!0)}}),[i("transition",{attrs:{name:"bars-fade"}},[t.show?i("svgicon",{staticClass:"arrow",attrs:{focusable:"false",name:"mobile-right",height:"100%"}}):t._e()],1)],1)],1)},Os=[];i(5843),i(9117);const _s={mixins:[g.Z],props:{show:Boolean},mounted(){this.isMobile&&(this.pointers=[],document.body.addEventListener("pointerdown",this.pointerDown),document.body.addEventListener("pointerup",this.pointerUp),document.addEventListener("visibilitychange",this.onVisibilityChange))},beforeDestroy(){document.body.removeEventListener("pointerdown",this.pointerDown),document.body.removeEventListener("pointerup",this.pointerUp),document.removeEventListener("visibilitychange",this.onVisibilityChange)},computed:{isMobile(){return this.$store.getters["workspace/isMobile"]},isRTLBook:function(){return this.$store.state.book.rightToLeft},isFirstPage:function(){const t=null===this.$store.getters["pager/prevNonStubPageId"],e=null===this.$store.getters["pager/nextPageId"];return this.isRTLBook?e:t},isLastPage:function(){const t=null===this.$store.getters["pager/nextPageId"],e=null===this.$store.getters["pager/prevNonStubPageId"];return this.isRTLBook?e:t},isEmbed(){return this.$store.state.workspace.isEmbed},isZoomed(){return 1!==this.$store.state.pages.size.zoomFactor},leftArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.NEXT_PAGE_TIP"):this.$t("NavigationPanel.PREV_PAGE_TIP")},rightArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.PREV_PAGE_TIP"):this.$t("NavigationPanel.NEXT_PAGE_TIP")}},methods:{leftButtonKeyHandler(t){"Space"!==t.code&&"Enter"!==t.code||this.goLeft(t)},rightButtonKeyHandler(t){"Space"!==t.code&&"Enter"!==t.code||this.goRight(t)},goRight(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.timeout>Date.now()||(this.$root.$emit("nav:goRight"),this.$store.state.pager.freezed||(setTimeout((()=>{this.movePagerRight({target:e?"nav-swipe":"nav-tap"})}),0),this.timeout=Date.now()+150))},goLeft(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.timeout>Date.now()||(this.$root.$emit("nav:goLeft"),this.$store.state.pager.freezed||(setTimeout((()=>{this.movePagerLeft({target:e?"nav-swipe":"nav-tap"})}),0),this.timeout=Date.now()+150))},pointerDown(t){this.isZoomed&&this.pointers.push(t.pointerId)},pointerUp(t){this.pointers.length>1&&(this.timeout=Date.now()+150),this.pointers.splice(this.pointers.indexOf(t.pointerId),1)},onVisibilityChange(){this.pointers.length=0,this.timeout=null}}};const Ds=(0,R.Z)(_s,Fs,Os,!1,null,"713bdbfe",null).exports;var Ws=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.classes},[t.isFirstPage||t.isLightboxShown?t._e():i("div",{staticClass:"button-block left"},[i("button",{staticClass:"nav-btn next-btn nav-left-arrow",attrs:{tabindex:"0",title:t.leftArrowTitle},on:{click:function(e){return e.preventDefault(),t.goLeft(e)}}},[i("transition",{attrs:{name:"bars-fade"}},[t.show?i("svgicon",{staticClass:"arrow",attrs:{focusable:"false",name:"mobile-left",height:"100%"}}):t._e()],1)],1),t._v(" "),i("button",{staticClass:"nav-btn last-btn nav-first-left-arrow",attrs:{tabindex:"0",title:t.leftMostArrowTitle},on:{click:function(e){return e.preventDefault(),t.leftToTheLast(e)}}},[t.show?i("svgicon",{staticClass:"arrow",attrs:{focusable:"false",name:"book-first",height:"100%"}}):t._e()],1)]),t._v(" "),t.isLastPage||t.isLightboxShown?t._e():i("div",{staticClass:"button-block right"},[i("button",{staticClass:"nav-btn next-btn nav-right-arrow",attrs:{tabindex:"0",title:t.rightArrowTitle},on:{click:function(e){return e.preventDefault(),t.goRight(e)}}},[i("transition",{attrs:{name:"bars-fade"}},[t.show?i("svgicon",{staticClass:"arrow",attrs:{focusable:"false",name:"mobile-right",height:"100%"}}):t._e()],1)],1),t._v(" "),i("button",{staticClass:"nav-btn last-btn nav-last-right-arrow",attrs:{tabindex:"0",title:t.rightMostArrowTitle},on:{click:function(e){return e.preventDefault(),t.rightToTheLast(e)}}},[t.show?i("svgicon",{staticClass:"arrow",attrs:{focusable:"false",name:"book-last",height:"100%"}}):t._e()],1)])])},Bs=[];const As={mixins:[g.Z],props:{show:Boolean},data:()=>({timeout:0,classes:{"nav-arrows":!0,start:!0}}),mounted(){setTimeout((()=>{this.classes.start=!1}),8e3)},computed:{isLightboxShown(){return this.$store.getters["lightbox/isShown"]},isRTLBook:function(){return this.$store.state.book.rightToLeft},isFirstPage:function(){const t=null===this.$store.getters["pager/prevNonStubPageId"],e=null===this.$store.getters["pager/nextPageId"];return this.isRTLBook?e:t},isLastPage:function(){const t=null===this.$store.getters["pager/nextPageId"],e=null===this.$store.getters["pager/prevNonStubPageId"];return this.isRTLBook?e:t},isEmbed(){return this.$store.state.workspace.isEmbed},leftArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.NEXT_PAGE_TIP"):this.$t("NavigationPanel.PREV_PAGE_TIP")},rightArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.PREV_PAGE_TIP"):this.$t("NavigationPanel.NEXT_PAGE_TIP")},leftMostArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.LAST_PAGE_TIP"):this.$t("NavigationPanel.FIRST_PAGE_TIP")},rightMostArrowTitle(){return this.isRTLBook?this.$t("NavigationPanel.FIRST_PAGE_TIP"):this.$t("NavigationPanel.LAST_PAGE_TIP")},animationInProgress(){return this.$store.state.workspace.animationInProgress}},watch:{animationInProgress(){this.classes.start=!1}},methods:{goRight(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.timeout>Date.now()||(this.$root.$emit("nav:goRight"),this.movePagerRight({target:e?"nav-swipe":"nav-tap"}),this.timeout=Date.now()+150)},goLeft(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.timeout>Date.now()||(this.$root.$emit("nav:goLeft"),this.movePagerLeft({target:e?"nav-swipe":"nav-tap"}),this.timeout=Date.now()+150)},rightToTheLast(){this.timeout>Date.now()||(this.movePagerRightmost({navTarget:!0}),this.timeout=Date.now()+150)},leftToTheLast(){this.timeout>Date.now()||(this.movePagerLeftmost({navTarget:!0}),this.timeout=Date.now()+150)}}};const Hs=(0,R.Z)(As,Ws,Bs,!1,null,"b2596fc6",null).exports;var Ns=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"zoom-panel",class:t.panelClass,style:t.panelStyle,attrs:{id:"zoom-panel",dir:t.dir}},[i("span",{staticClass:"zoom-panel-caption minus",attrs:{title:t.$t("ZoomBar.ZOOM_OUT_TIP")},on:{click:t.zoomOut}},[t._v("")]),t._v(" "),i("div",{ref:"zoomLine",staticClass:"zoom-panel-line",on:{click:t.lineClick}},[i("v-touch",{ref:"zoomSlider",staticClass:"zoom-panel-slider",style:t.sliderStyle,attrs:{id:"zoom-slider","pan-options":{direction:"horizontal",threshold:1}},on:{panstart:t.onPanStart,panmove:t.onPanMove,panend:t.onPanEnd,pancancel:t.onPanEnd}})],1),t._v(" "),i("span",{staticClass:"zoom-panel-caption plus",attrs:{title:t.$t("ZoomBar.ZOOM_IN_TIP")},on:{click:t.zoomIn}},[t._v("+")])])},Zs=[];i(169),i(2209);const Vs={name:"ZoomPanel",data:function(){return{scalePosition:0,savedScalePosition:null,lineWidth:90,forceOpacity:!1,forceVisibility:!1,opacityTimer:null,isGrabbing:!1}},mounted(){window.addEventListener("keydown",this.keyDownHandler),this.$root.$on("unzoomed",this.hide),this.updateScalePosition(this.zoomFactor)},beforeDestroy(){window.removeEventListener("keydown",this.keyDownHandler),this.$root.$off("unzoomed",this.hide)},watch:{zoomFactor:"updateScalePosition",minZoom(t){this.zoomFactor>t?this.scalePosition=1*((this.zoomFactor-t)/(this.maxZoom-t)).toFixed(2):this.scalePosition=0},scalePosition(){this.forceOpacity=!0,clearTimeout(this.opacityTimer),this.opacityTimer=setTimeout((()=>{this.forceOpacity=!1}),2e3)},pagerState(){this.forceVisibility=!1},visible(t){this.$store.dispatch("workspace/setZoomPanel",t)},zoomPanel(t){t||(this.forceVisibility=!1)}},computed:{zoomFactor(){return this.$store.state.pages.size.zoomFactor},isRtl(){return this.$store.getters["i18n/isLocaleRtl"]},dir(){return this.isRtl?"rtl":"ltr"},pagerState(){return[this.$store.state.pager.currentPage]},visible(){return this.zoomFactor>this.minZoom||this.forceVisibility},zoomPanel(){return this.$store.state.workspace.zoomPanel},minZoom(){if("slide-book"===this.$store.state.workspace.bookComponent)return 1;const t=this.isHardcover&&(this.isFirstPage||this.isLastPage)?1.03:1,e=this.isSingleMode?1:2,i=this.$store.state.workspace.bookSize/100,s=this.$store.state.workspace.containerSize.height*i/(this.$store.state.pages.size.height*t/this.$store.state.pages.size.zoomFactor),o=this.$store.state.workspace.containerSize.width*i/(this.$store.state.pages.size.width*t*e/this.$store.state.pages.size.zoomFactor),r=Math.round(100*s)/100,a=Math.round(100*o)/100;return Math.min(r,a)},isFirstPage:function(){return this.$store.getters["pager/isFirstSpread"]},isLastPage:function(){return this.$store.getters["pager/isLastSpread"]},isSingleMode(){return"single"===this.$store.getters["pager/mode"]},maxZoom(){return this.$store.state.workspace.maxZoom},sliderStyle(){const t={},e=6;return this.isRtl?t.right=Math.round((this.lineWidth-e)*this.scalePosition)+"px":t.left=Math.round((this.lineWidth-e)*this.scalePosition)+"px",t},panelClass(){return{grabbing:this.isGrabbing}},panelStyle(){return{opacity:this.forceOpacity?.9:null,visibility:this.visible?"visible":"hidden"}},shouldBlockHotkeys(){return null!==this.$store.state.popup.opened||this.$store.state.workspace.modalOpened||this.$store.getters["lightbox/isShown"]}},methods:{zoomOut(){if(!this.$store.state.workspace.animationInProgress&&(!1!==this.forceVisibility||0!==this.scalePosition)){if(this.scalePosition>.1)this.scalePosition-=.1;else{if(!0===this.forceVisibility&&0===this.scalePosition)return this.forceVisibility=!1,void this.$root.$emit("zoomPanel",{action:"zoomOut"});this.forceVisibility=!0,this.scalePosition=0}this.$root.$emit("zoomPanel",{action:"setZoom",zoomFactor:1*(this.scalePosition*(this.maxZoom-this.minZoom)+this.minZoom).toFixed(2),fast:!0})}},zoomOutFull(){this.$store.state.workspace.animationInProgress||(this.forceVisibility=!1,this.$root.$emit("zoomPanel",{action:"zoomOut"}))},zoomIn(){this.$store.state.workspace.animationInProgress||(0!==this.scalePosition||this.visible?(this.scalePosition<0&&(this.scalePosition=0),this.scalePosition<.9?this.scalePosition+=.1:this.scalePosition=1,this.$root.$emit("zoomPanel",{action:"setZoom",zoomFactor:1*(this.scalePosition*(this.maxZoom-this.minZoom)+this.minZoom).toFixed(2),fast:!0})):this.$root.$emit("zoomPanel",{action:"zoomIn"}))},lineClick(t){if(this.$store.state.workspace.animationInProgress)return;const e=this.$refs.zoomLine.getBoundingClientRect();this.isRtl?this.scalePosition=(this.lineWidth-t.clientX+e.left)/this.lineWidth:this.scalePosition=(t.clientX-e.left)/this.lineWidth,this.scalePosition<=0&&(this.scalePosition=0),0===this.scalePosition&&(this.forceVisibility=!0),this.$nextTick((()=>{this.$root.$emit("zoomPanel",{action:"setZoom",zoomFactor:1*(this.scalePosition*(this.maxZoom-this.minZoom)+this.minZoom).toFixed(2),fast:!1})}))},onPanStart(){this.savedScalePosition=this.scalePosition,this.isGrabbing=!0,this.$root.$emit("zoomPanel",{action:"startScale"})},onPanMove(t){const e=1*(this.isRtl?-t.deltaX/this.lineWidth:t.deltaX/this.lineWidth).toFixed(2);this.scalePosition=this.savedScalePosition+e,this.scalePosition>1&&(this.scalePosition=1),this.scalePosition<=0&&(this.scalePosition=0);const i=this.scalePosition/this.savedScalePosition;this.$root.$emit("zoomPanel",{action:"changeScale",scalePosition:this.scalePosition,scaleRatio:i})},onPanEnd(t){this.isGrabbing=!1;const e=1*(this.isRtl?-t.deltaX/this.lineWidth:t.deltaX/this.lineWidth).toFixed(2);this.scalePosition+=e,this.scalePosition>1&&(this.scalePosition=1),this.scalePosition<=0&&(this.scalePosition=0),0===this.scalePosition?this.forceVisibility=!0:this.forceVisibility=!1,this.$root.$emit("zoomPanel",{action:"endScale",zoomFactor:this.scalePosition*(this.maxZoom-this.minZoom)+this.minZoom})},keyDownHandler(t){if(((0,y.Ft)(t.target)||(0,y.o8)(t.target)||"input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()&&"select"!==t.target.tagName.toLowerCase()&&"option"!==t.target.tagName.toLowerCase())&&!this.shouldBlockHotkeys)switch(t.code){case"Equal":case"NumpadAdd":(t.metaKey||t.ctrlKey)&&(t.preventDefault(),this.zoomIn());break;case"Minus":case"NumpadSubtract":(t.metaKey||t.ctrlKey)&&(t.preventDefault(),this.zoomOut());break;case"Digit0":(t.metaKey||t.ctrlKey)&&this.zoomOutFull()}},hide(){this.forceVisibility=!1,this.$store.dispatch("workspace/setZoomPanel",!1)},updateScalePosition(t){t>this.minZoom?this.scalePosition=1*((t-this.minZoom)/(this.maxZoom-this.minZoom)).toFixed(2):this.scalePosition=0}}};const Us=(0,R.Z)(Vs,Ns,Zs,!1,null,"9d1e0d5e",null).exports;var Gs=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"note-editor"},[t.showRect?i("div",{ref:"rect",class:t.rectClass,style:t.rectStyle,attrs:{role:"dialog",tabindex:"0"},on:{mousedown:function(t){t.stopPropagation()},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:t.onTabRect(e)}}},[i("div",{staticClass:"note-body"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textAreaValue,expression:"textAreaValue"}],ref:"text",staticClass:"note-article",attrs:{role:"textbox",dir:t.textareaDir,maxlength:"500",placeholder:t.localization.placeholderText,tabindex:"0"},domProps:{value:t.textAreaValue},on:{focus:t.focusTextArea,keydown:[function(e){return(e.type.indexOf("key")||13===e.keyCode)&&e.ctrlKey?t.setViewState(e):null},function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab"))return null;e.stopPropagation()}],input:function(e){e.target.composing||(t.textAreaValue=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"note-footer",attrs:{"aria-hidden":"true"}},[i("div",{class:t.colorSetClass},[i("div",{staticClass:"note-border-color green",attrs:{title:t.localization.colorGreen},on:{click:function(e){return t.setColor("green")}}},[i("div",{staticClass:"note-color"})]),t._v(" "),i("div",{staticClass:"note-border-color blue",attrs:{title:t.localization.colorBlue},on:{click:function(e){return t.setColor("blue")}}},[i("div",{staticClass:"note-color"})]),t._v(" "),i("div",{staticClass:"note-border-color violet",attrs:{title:t.localization.colorViolet},on:{click:function(e){return t.setColor("violet")}}},[i("div",{staticClass:"note-color"})]),t._v(" "),i("div",{staticClass:"note-border-color red",attrs:{title:t.localization.colorRed},on:{click:function(e){return t.setColor("red")}}},[i("div",{staticClass:"note-color"})]),t._v(" "),i("div",{staticClass:"note-border-color orange",attrs:{title:t.localization.colorOrange},on:{click:function(e){return t.setColor("orange")}}},[i("div",{staticClass:"note-color"})]),t._v(" "),i("div",{staticClass:"note-border-color gray",attrs:{title:t.localization.colorGray},on:{click:function(e){return t.setColor("gray")}}},[i("div",{staticClass:"note-color"})])]),t._v(" "),i("div",{staticClass:"note-time"},[t._v(t._s(t.formattedTime))]),t._v(" "),i("span",{staticClass:"icon icon-trash-can note-button note-delete-button",attrs:{title:t.localization.deleteTip},on:{click:t.deleteNoteCheck}},[i("svgicon",{attrs:{focusable:"false",name:"trash-can"}})],1)])]):t._e(),t._v(" "),t.deleteDialog?i("div",{ref:"deleteDialog",class:t.rectClass,style:t.rectStyle,attrs:{role:"dialog"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.deleteDialogCancel(e)},mousedown:function(t){t.stopPropagation()}}},[i("div",{staticClass:"note-delete-dialog",attrs:{dir:t.dir,"aria-hidden":"true"}},[i("div",{staticClass:"note-delete-dialog-text"},[i("div",{staticClass:"note-delete-dialog-text-flex"},[i("span",[t._v(t._s(t.localization.dialogDeleteText))])])]),t._v(" "),i("div",{staticClass:"note-delete-dialog-buttons"},[i("button",{ref:"cancelButton",staticClass:"note-delete-dialog-cancel",attrs:{tabindex:"0"},on:{click:t.deleteDialogCancel}},[t._v("\n                    "+t._s(t.localization.cancelButton)+"\n                ")]),t._v(" "),i("button",{staticClass:"note-delete-dialog-confirm",attrs:{tabindex:"0"},on:{click:function(e){return t.deleteNote(e,t.deleteTarget)}}},[t._v("\n                    "+t._s(t.localization.deleteButton)+"\n                ")])])])]):t._e()])},Xs=[],js=(i(6062),i(6382)),Ys=i.n(js);const qs=24,Ks=4,Qs=1.03,Js={name:"NoteEditor",data:function(){return{rectLeft:-115,rectTop:4,rectHeight:125,rectWidth:230,rectPadding:10,rectState:"view",deleteDialog:!1,textAreaValue:"",deleteTarget:"editor"}},computed:{textareaDir:function(){if(""!==this.textAreaValue){const t=Ys().getDirection(this.textAreaValue);return t&&"ltr"!==t?"rtl":"ltr"}return this.dir},isOpened:function(){return!!this.currentNoteId&&!!this.currentNoteData},isMovingNote:function(){return this.$store.state.notes.isMoving},showRect(){return this.isOpened&&!this.isMovingNote&&this.enoughSpace},currentNoteId:function(){return this.$store.state.notes.opened},currentNoteData:function(){return this.$store.getters["notes/noteByID"](this.currentNoteId)},oneCurrentPage:function(){const t=this.pagerState.singleMode,e=this.pagerState.slideMode,i=this.$store.state.pages.structure.length%2==0,s=this.pagerState.isFirstSpread||this.pagerState.isLastSpread&&i;return t||e||s},rightPageOffset:function(){const t=this.pagerState.wide;return!this.oneCurrentPage&&!t&&this.rtl!==(this.pagerState.rightPage===this.currentNoteData.page)?this.pageSize.width:0},singleModeRightPageCorrectionX:function(){const t=this.pagerState.singleMode,e=this.pagerState.wide,i="right"===this.pagerState.pageSide;return t&&e&&i?-this.pageSize.width:0},leftZoomOffset:function(){return this.containerSize.width>this.pageSize.width&&this.oneCurrentPage?(this.containerSize.width-this.pageSize.width)/2+this.leftHardcoverZoomOffset:0},topZoomOffset:function(){return this.containerSize.height>this.pageSize.height?(this.containerSize.height-this.pageSize.height)/2:0},topHardcoverZoomOffset:function(){return this.pagerState.hardcover?-this.pageSize.height*(Qs-1)/2:0},leftHardcoverZoomOffset:function(){if(!this.pagerState.hardcover)return 0;const t=this.pageSize.width*(Qs-1)/2;return this.isRtlOrientation?t:-t},isZoomed(){return 1!==this.$store.state.pages.size.zoomFactor},hardcoverTopPadding(){let t=Math.round(this.pageSize.height*Qs);return t%2!=0&&(t+=1),this.pagerState.hardcover?Math.round((t-this.pageSize.height)/2):0},isRtlOrientation(){return this.pagerState.isFirstSpread&&this.rtl||this.pagerState.isLastSpread&&!this.rtl},hardcoverLeftPadding(){return this.pagerState.hardcover&&this.isRtlOrientation?this.pageSize.width*(1-Qs):0},currentNotePosition:function(){let t,e;if(this.isZoomed){const i="[data-zoom-wrapper]",s=new window.WebKitCSSMatrix(window.getComputedStyle(this.$root.$el.querySelector(i)).transform);t=s.m41+this.leftZoomOffset,e=s.m42+this.topZoomOffset+this.topHardcoverZoomOffset}else t=this.holderSize.left,e=this.holderSize.top-this.hardcoverTopPadding;return{left:t+this.rightPageOffset+this.singleModeRightPageCorrectionX+this.hardcoverLeftPadding+Math.round(this.currentNoteData.pX*this.scale.w),top:Math.max(e+Math.round(this.currentNoteData.pY*this.scale.h),e+qs+Ks)}},pagerState:function(){return this.$store.getters["pager/state"]},slideComponent:function(){return"slide-book"===this.$store.state.workspace.bookComponent},isContentCropMode(){return this.pagerState.slideMode&&this.$store.state.book.contentCrop},pageSize:function(){if(this.slideComponent){const t=this.pagerState.currentPage;return this.$store.getters["pages/currentSize"](t)}return this.$store.getters["pages/size"]},holderSize:function(){return this.$store.getters["workspace/holderSize"]},containerSize:function(){return this.$store.getters["workspace/containerSize"]},enoughSpace:function(){return this.containerSize.width>=this.rectWidth+2*this.rectPadding&&this.containerSize.height>=this.rectHeight+2*this.rectPadding},scale:function(){const t=this.slideComponent&&this.pagerState.wide;return{w:this.pageSize.width*(this.pagerState.hardcover?Qs:1)/this.$store.state.book.bookSize.width/(t?2:1),h:this.pageSize.height*(this.pagerState.hardcover?Qs:1)/this.$store.state.book.bookSize.height}},rectStyle:function(){return{top:this.currentNotePosition.top+this.rectTop+"px",left:this.currentNotePosition.left+this.rectLeft+"px"}},rectClass:function(){return["note-rect",this.rectState]},colorSetClass:function(){return["note-color-set",this.currentNoteData.color]},formattedTime:function(){const t=new Date(Date.now()),e=new Date(this.currentNoteData.date);let i=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return t.getDay()===e.getDay()&&t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()||(i=e.toLocaleDateString()+", "+i),i},dir:function(){return this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"},rtl:function(){return this.$store.state.book.rightToLeft},localization(){return{placeholderText:this.$i18n.t("Notes.PLACEHOLDER"),dialogDeleteText:this.$i18n.t("Notes.DIALOG_DELETE_TEXT"),deleteTip:this.$i18n.t("Notes.DELETE_TIP"),deleteButton:this.$i18n.t("AlertWindow.BUTTON_DELETE"),cancelButton:this.$i18n.t("AlertWindow.BUTTON_CANCEL"),colorRed:this.$i18n.t("Notes.COLOR_RED"),colorGray:this.$i18n.t("Notes.COLOR_GRAY"),colorOrange:this.$i18n.t("Notes.COLOR_ORANGE"),colorViolet:this.$i18n.t("Notes.COLOR_VIOLET"),colorBlue:this.$i18n.t("Notes.COLOR_BLUE"),colorGreen:this.$i18n.t("Notes.COLOR_GREEN")}},isFrozenOrNotReady(){return this.$store.state.workspace.freezed||"ready"!==this.$store.state.workspace.status||this.$store.state.workspace.isResizing||this.$store.state.pager.freezed},activeInteractiveElement(){return this.$store.state.workspace.activeInteractiveElement}},watch:{activeInteractiveElement:function(t){"note"!==t&&this.hideEditor()},isOpened:function(t){t&&(this.rectState=this.currentNoteData?.new?"edit":"view",this.showEditor(),setTimeout((()=>{"edit"===this.rectState?this.forceFocus():"view"===this.rectState&&"icon"===this.$store.state.notes.target&&this.$refs.rect.focus()}),100))},isMovingNote:function(t){t?(this.saveText(this.currentNoteId),this.deleteDialog=!1):this.updateEditorParams()},currentNoteId:function(t,e){null!==e&&this.saveText(e)},size:function(){this.isOpened&&this.updateEditorParams()},containerSize:function(){this.updateEditorParams()},currentNoteData:function(t){this.textAreaValue=t?t.text:"",t?.new&&(this.rectState="edit",this.forceFocus())}},mounted:function(){this.$root.$on("contextMenu:deleteNote",this.onDelete),this.$root.$on("contextMenu:editNote",this.onEdit),this.$root.$on("note:deleteDialog",this.onDeleteDialog),this.updateEditorParams(),this.isOpened&&this.showEditor(),this.parentEl=this.$el.parentElement},beforeDestroy:function(){this.$root.$off("contextMenu:deleteNote",this.onDelete),this.$root.$off("contextMenu:editNote",this.onEdit),this.$root.$off("note:deleteDialog",this.onDeleteDialog),document.removeEventListener("keydown",this.checkKeydown),this.deleteDialog=!1},methods:{onTabRect(t){!t.shiftKey&&this.forceFocus()},showEditor:function(){this.$store.dispatch("workspace/setActiveInteractiveElement","note"),this.updateEditorParams(),this.$store.dispatch("notes/setOpenedId",{id:this.currentNoteId}),this.$store.dispatch("notes/setActiveItemById",this.currentNoteId),document.addEventListener("keydown",this.checkKeydown)},hideEditor:function(){this.deleteDialog=!1,document.activeElement===this.$refs.text&&this.$refs.text.blur(),this.$store.dispatch("notes/setOpenedId",{id:null}),this.$store.dispatch("workspace/setHighlightTimeout",Date.now()+300),document.removeEventListener("keydown",this.checkKeydown),this.rectState="view"},updateEditorParams:function(){if(!this.isOpened)return;const t=this.containerSize.width-this.currentNotePosition.left;this.currentNotePosition.left<this.rectWidth/2+this.rectPadding?this.rectLeft=-this.currentNotePosition.left+this.rectPadding:t<this.rectWidth/2+this.rectPadding?this.rectLeft=t-this.rectWidth-this.rectPadding:this.rectLeft=-this.rectWidth/2;const e=this.containerSize.height-this.currentNotePosition.top>this.rectHeight+2*Ks,i=this.currentNotePosition.top>this.rectHeight+qs+2*Ks;if(e)this.rectTop=Ks;else if(i)this.rectTop=-(this.rectHeight+qs+2*Ks);else{this.rectTop=-(this.rectHeight+qs+2*Ks)/2,this.rectLeft=-this.rectWidth/2;const e=this.rectWidth/2+qs+Ks,i=this.currentNotePosition.left>this.rectWidth+this.rectPadding,s=t-qs>this.rectWidth+this.rectPadding;if(i||s)this.rectLeft+="rtl"===this.dir&&i||!s?-e:e;else{const t=this.$el.getBoundingClientRect().right+this.rectWidth+this.rectPadding>this.$store.state.workspace.size.width;this.rectLeft+=t?-e:e}}},saveText:function(t){const e=this.$store.getters["notes/noteByID"](t);e&&this.$refs.text&&e.text!==this.$refs.text.value&&(this.$store.dispatch("notes/changeText",{id:t,text:this.$refs.text.value}),this.$root.$emit("note",{action:"changeText"}))},setColor:function(t){this.currentNoteData.color!==t&&(this.$store.dispatch("notes/changeColor",{id:this.currentNoteId,color:t}),this.$root.$emit("note",{action:"changeColor",value:t}))},focusTextArea:function(){this.rectState="edit",document.removeEventListener("keydown",this.checkKeydown)},deleteNoteCheck:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"editor";this.currentNoteData&&(""===this.currentNoteData.text?this.deleteNote(t,e):(this.deleteTarget=e,this.deleteDialog=!0,this.isOpened||document.addEventListener("mousedown",this.deleteDialogCancel),this.$nextTick((()=>{document.removeEventListener("keydown",this.checkKeydown),this.$refs.cancelButton.focus()}))))},onDeleteDialog:function(t,e){this.currentNoteId!==t&&this.$store.dispatch("notes/setOpenedId",{id:t,target:"noteWindowDelete"}),this.deleteNoteCheck(null,e)},checkKeydown:function(t){if("Escape"===t.code&&this.$store.dispatch("workspace/setActiveInteractiveElement",null),"view"===this.rectState&&t.preventDefault(),"Backspace"===t.code||"Delete"===t.code){if(this.$refs.text===document.activeElement)return;this.deleteNoteCheck(t,"hotkey")}},deleteNote:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;document.removeEventListener("keydown",this.checkKeydown),this.$store.dispatch("notes/deleteNote",{id:this.currentNoteId,target:e}),this.$store.dispatch("workspace/setActiveInteractiveElement",null),this.deleteDialogCancel()},deleteDialogCancel:function(){this.isOpened&&document.addEventListener("keydown",this.checkKeydown),document.removeEventListener("mousedown",this.deleteDialogCancel),this.deleteDialog=!1,this.$nextTick((()=>{this.$root.$emit("note:closeDeleteDialog")}))},setViewState:function(t){this.rectState="view",t.target.blur()},forceFocus:function(){this.$refs.text?.focus()},onDelete(t){this.currentNoteId!==t&&this.$store.dispatch("notes/setOpenedId",{id:t,target:"contextMenu"}),this.deleteNoteCheck(null,"contextMenu")},onEdit(t){this.$store.dispatch("notes/setOpenedId",{id:t,target:"contextMenu"})}}},to=Js;const eo=(0,R.Z)(to,Gs,Xs,!1,null,"bf390c46",null).exports;i(5903);const io=getComputedStyle(document.documentElement).getPropertyValue("--z-index-book-substrate"),so={mixins:[g.Z],data:function(){return{containerSize:{width:0,height:0},bookSize:{width:0,height:0},miniFullScreen:!1,ctrFade:"no-fade"}},props:{size:{required:!1},wsToggleFullscreen:{type:Function,default:()=>{}}},components:{slideNavButtons:Hs,flipBook:xs,slideBook:Ms,navButtons:Ds,zoomPanel:Us,logo:Es,noteEditor:eo},computed:{inspectorMode(){return this.$store.state.workspace.inspectorMode},version(){return this.$store.getters["info/version"]},layout(){return this.$store.state.workspace.layout},bookScaleSize(){return this.$store.state.workspace&&this.$store.state.workspace.bookSize},originalBookSize(){return{width:this.$store.state.book.bookSize.width*(this.isSingleMode?1:2),height:1*this.$store.state.book.bookSize.height,zoomFactor:this.$store.state.book.bookSize.zoomFactor}},showPrevSubstrate(){return this.isRTLBook?!this.$store.getters["pager/isLastSpread"]:!this.$store.getters["pager/isFirstSpread"]},showNextSubstrate(){return this.isRTLBook?!this.$store.getters["pager/isFirstSpread"]:!this.$store.getters["pager/isLastSpread"]},isHardcover(){return this.$store.getters["book/hasHardcover"]},hasThickness(){return this.$store.state.book.thickness},isSingleMode(){return"single"===this.$store.getters["pager/mode"]},isZoomed(){return 1!==this.$store.state.pages.size.zoomFactor},isScaled(){return!!this.$refs.bookComponent&&this.$refs.bookComponent.scaleFactor<1},showSimpleArrows(){return!("flip-book"===this.currentBookComponent&&"html"===this.version&&(!this.isZoomed||this.isScaled)||this.showSmartArrows)},showSmartArrows(){return"html"===this.version&&"slide-book"===this.currentBookComponent},isRTLBook:function(){return this.$store.state.book.rightToLeft},bookComponent(){return"mobile-old"===this.version?"slide-book":this.$store.state.workspace.components.book.flip?"flip-book":"slide-book"},currentBookComponent(){return this.$store.state.workspace.bookComponent},isLightboxShown(){return this.$store.getters["lightbox/isShown"]},containerClass(){return{animation:"ready"!==this.$store.state.workspace.status&&!this.$store.state.pager.zoomMode&&!this.$store.state.workspace.zoomPanel,"arrow-attract-left":"left"===this.arrowAttract&&!this.isLightboxShown,"arrow-attract-right":"right"===this.arrowAttract&&!this.isLightboxShown}},miniState(){return this.$store.state.workspace.mini},clickToReadText:function(){return this.$i18n.t("Other.CLICK_TO_READ")},pagerState:function(){return this.$store.getters["pager/state"]},clickToReadClass:function(){return{clickToRead:!0,hideTop:this.miniTopPosition}},miniClickToReadClass:function(){return{miniClickToRead:!0,hideTop:this.miniTopPosition}},arrowAttract:function(){const t=this.$store.getters["workspace/callToNavigation"];return"arrow"===t.type&&t.side},miniTopPosition:function(){return this.$store.getters["logo/showLogo"]&&"bottom-right"===this.$store.state.logo.position},pagesCount:function(){return this.$store.getters["pages/pagesCount"]},hasPages:function(){return this.pagesCount>0},substrateStyle(){let t,e;if(this.$store.getters["pager/state"].slideMode)e="100%",t=0;else{const i=this.$store.state.workspace.holderSize.top,s=this.$store.getters["pages/size"].height,o=this.$store.state.workspace.containerSize.height;t=1===this.$store.state.book.bookSize.zoomFactor?i+"px":o>=s?Math.round(i)+"px":0,e=Math.min(s,o)+"px"}return{display:"block",height:e,top:t,cursor:this.isFrozen?"inherit":"pointer","z-index":this.isFrozen&&"flip-book"===this.bookComponent?io:"auto"}},logoKey:function(){return this.$store.getters["logo/logoKey"]},renderLogo:function(){return this.$store.getters["logo/renderLogo"]},isMobile(){return this.$store.getters["workspace/isMobile"]},isMobileApp(){return"mobile-app"===this.$store.getters["info/version"]},isFrozen(){return this.$store.getters["workspace/isFrozen"]||this.$store.getters["pager/isFrozen"]}},methods:{documentOnMouseUp(){clearTimeout(this.inspectorModeTimeoutId)},documentOnMouseDown(t){t.shiftKey&&t.altKey&&(t.ctrlKey||t.metaKey)&&(t.preventDefault(),this.inspectorModeTimeoutId=setTimeout((()=>{this.$store.dispatch("workspace/setInspectorMode",!this.inspectorMode)}),1e3))},fitBook(t,e){const i=Object.assign({},e),s=this.$store.state.book.bookSize,o=this.bookScaleSize,r=this.pagesCount,a=(0,ae.Tj)({width:2*s.width,height:s.height},i),n=ne(r,r,a,.1*a.width),h=(o||100)/100,l=28,c=34,d=this.isSingleMode?2*c:2*l,p=10;"desktop"===this.layout?(this.hasThickness&&(i.width-=n),i.width-=d):this.isMobile&&(!this.isSingleMode&&this.hasThickness&&(i.width-=n),i.height-=p);const g=(0,ae.Tj)(t,i);if(this.isHardcover){const t=this.isSingleMode?1.04:1.03;g.width=g.width/t,g.height=g.height/t}const u=g.height/g.width;return g.width=Math.floor(g.width*h),g.width=g.width%2==0?g.width:g.width+1,g.height=Math.floor(u*g.width),{width:g.width,height:g.height}},resize(t){const e=window.getComputedStyle(this.$el),i={left:1*e.getPropertyValue("margin-left").split("px")[0],right:1*e.getPropertyValue("margin-right").split("px")[0],top:1*e.getPropertyValue("margin-top").split("px")[0],bottom:1*e.getPropertyValue("margin-bottom").split("px")[0]};this.containerSize={width:this.size.width-i.left-i.right,height:this.size.height-i.top-i.bottom,top:this.size.top+i.top,left:this.size.left+i.left},this.$store.dispatch("workspace/setContainerSize",this.containerSize);const s=this.fitBook(this.originalBookSize,this.containerSize),o=Math.round(s.width/(this.isSingleMode?1:2));let r=Math.round(s.height);r=r%2==0?r:r+1,this.bookSize={width:o,height:r,zoomFactor:this.originalBookSize.zoomFactor}},goToRightPage(){this.$store.state.pager.freezed||setTimeout((()=>{this.movePagerRight({target:"free-space-tap"})}),0)},goToLeftPage(){this.$store.state.pager.freezed||setTimeout((()=>{this.movePagerLeft({target:"free-space-tap"})}),0)},arrowHover(t,e){this.$refs.bookComponent&&"function"==typeof this.$refs.bookComponent.arrowHover&&this.$refs.bookComponent.arrowHover(t,e)},afterFade(){this.ctrFade="no-fade"}},beforeMount:function(){this.$root.$once("before-preloader-off",this.resize),this.$store.dispatch("workspace/setBookComponent",this.bookComponent),this.$root.$on("forceBookResize",this.resize)},mounted:function(){this.resize(!0),this.hasPages||this.$root.onPublicationLoad({}),document.addEventListener("mousedown",this.documentOnMouseDown),document.addEventListener("mouseup",this.documentOnMouseUp)},beforeDestroy:function(){this.$root.$off("forceBookResize",this.resize),document.removeEventListener("mousedown",this.documentOnMouseDown),document.removeEventListener("mouseup",this.documentOnMouseUp)},watch:{size:function(){this.resize()},bookScaleSize:function(){this.resize()},originalBookSize:function(){this.resize()},hasThickness:function(){this.resize()},bookComponent:function(t){this.$store.dispatch("pager/setForceRerender",{forceRerender:!1}),this.$store.dispatch("workspace/setBookComponent",t),this.resize()},pagerState:function(t,e){!this.miniState||this.miniFullScreen||t.isEqualState(e)||(this.ctrFade="ctr-fade",this.$nextTick((()=>{this.miniFullScreen=!0})))},renderLogo:function(t){t||(this.$refs?.logoComponent?.$el&&!this.$refs.logoComponent.$el.parentElement&&this.$el.appendChild(this.$refs.logoComponent.$el),this.$nextTick((()=>{this.$store.dispatch("logo/updateKey")})))}}},oo=so;const ro=(0,R.Z)(oo,s,o,!1,null,"42bb92b2",null).exports},5343:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{staticClass:"flash-message",style:t.messageData.style,attrs:{role:"alert","aria-live":"assertive","aria-atomic":"true"}},[t._v("\n        "+t._s(t.messageData.text)+"\n    ")])])},o=[];const r={name:"FlashMessage",mounted(){null!==this.$store.getters["workspace/flashMessage"]&&setTimeout((()=>{this.$store.dispatch("workspace/setFlashMessage",null)}),this.delay)},computed:{messageData(){return this.$store.getters["workspace/flashMessage"]},delay(){return this.messageData&&this.messageData.delay?this.messageData.delay:900}}};const a=(0,i(1900).Z)(r,s,o,!1,null,"8ce2c984",null).exports},7592:(t,e,i)=>{"use strict";i.d(e,{Z:()=>H});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.show?i("v-touch",{on:{swipeleft:function(e){t.isNavEnabled&&t.goRight("swipe")},swiperight:function(e){t.isNavEnabled&&t.goLeft("swipe")},swipeup:t.close,swipedown:t.close}},[i("span",{ref:"first-trap",attrs:{tabindex:"0","aria-hidden":"true"}}),t._v(" "),i("transition",{attrs:{name:"lightbox"},on:{"after-enter":function(e){!t.isMobile&&t.setFocusTraps({})}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isLightboxActive&&(t.areThumbnailsReady||t.isSmallWorkspace||!t.isNavEnabled),expression:"isLightboxActive && (areThumbnailsReady || isSmallWorkspace || !isNavEnabled)"}],class:t.lightboxClasses,style:t.lightboxStyle},[i("div",{staticClass:"lightbox-main"},[i("div",{staticClass:"lightbox-content",style:t.lightboxSizeStyle,on:{click:function(e){!t.isMobile&&t.setFocusTraps({justResetFocus:!0})}}},[i("transition",{attrs:{name:"lightbox-element"}},[i(t.item.component,{key:t.item.key,tag:"component",staticClass:"lightbox-element",attrs:{currentItem:t.item.data},on:{"lightbox-rect":t.setLightboxRect,"toggle-overlap-visibility":t.toggleOverlapVisibility}})],1),t._v(" "),i("button",{ref:"btn-close",staticClass:"lightbox-btn close",style:t.closeButtonStyle,attrs:{tabindex:"0","aria-label":t.localization.closeButton,title:t.localization.closeButton},on:{click:t.close}},[i("svgicon",{staticClass:"svg-icon",attrs:{focusable:"false",name:"cross"}})],1),t._v(" "),t.currentLightboxItem&&t.currentLightboxItem.descriptionByType&&t.isOverlapVisible?i("div",{staticClass:"lightbox-description-wrapper",attrs:{dir:t.currentLightboxItem.descriptionDir}},[i("div",{staticClass:"lightbox-description-container",on:{click:function(e){e.preventDefault(),t.isDescriptionOverflowing&&t.toggleDescription()},mousedown:function(t){t.preventDefault()},mouseup:function(t){t.preventDefault()}}},[null!==t.isDescriptionOverflowing?i("div",{ref:"lightbox-description",class:t.descriptionClasses,attrs:{id:"lightbox-description"}},t._l(t.currentLightboxItem.descriptionByType,(function(e){return i("span",["text"===e.type?[t._v(t._s(e.text))]:"link"===e.type?i("a",{staticClass:"description-link",attrs:{href:e.link,target:"_blank"},on:{click:function(t){t.stopPropagation()},mousedown:function(t){t.preventDefault()},mouseup:function(t){t.preventDefault()}}},[t._v(t._s(e.text))]):t._e()],2)})),0):t._e(),t._v(" "),i("div",{ref:"description-placeholder",staticClass:"lightbox-description lightbox-description-placeholder",attrs:{"aria-hidden":"true"}},t._l(t.currentLightboxItem.descriptionByType,(function(e){return i("span",["text"===e.type?[t._v(t._s(e.text))]:"link"===e.type?i("a",{staticClass:"description-link",attrs:{href:e.link,tabindex:"-1"}},[t._v("\n                                        "+t._s(e.text))]):t._e()],2)})),0),t._v(" "),t.isDescriptionOverflowing?i("div",{staticClass:"lightbox-description-more"},[t._v("\n                                "+t._s(t.descriptionMore)+"\n                            ")]):t._e()])]):t._e()],1)]),t._v(" "),!t.isSmallWorkspace&&t.isNavEnabled?[i("div",{staticClass:"nav-area nav-area-left",on:{click:function(e){return t.goLeft("area")}}}),t._v(" "),i("div",{staticClass:"nav-area nav-area-right",on:{click:function(e){return t.goRight("area")}}})]:t._e(),t._v(" "),!t.isSmallWorkspace&&t.isNavEnabled?i("div",{staticClass:"nav-btns"},[i("button",{ref:"nav-btn-left",staticClass:"lightbox-btn nav-btn nav-btn-left",attrs:{tabindex:"0","aria-label":t.localization.leftButton,title:t.localization.leftButton},on:{click:function(e){return t.goLeft("button")}}},[i("svgicon",{staticClass:"chevron-left",attrs:{focusable:"false",name:"chevron-right"}})],1),t._v(" "),i("button",{ref:"nav-btn-right",staticClass:"lightbox-btn nav-btn nav-btn-right",attrs:{tabindex:"0","aria-label":t.localization.rightButton,title:t.localization.rightButton},on:{click:function(e){return t.goRight("button")}}},[i("svgicon",{attrs:{focusable:"false",name:"chevron-right"}})],1)]):t._e(),t._v(" "),t.isSmallWorkspace&&t.isNavEnabled?i("div",{ref:"small-workspace-nav",staticClass:"small-workspace-nav",attrs:{dir:"ltr"}},[i("div",{ref:"nav-btn-left",staticClass:"lightbox-btn small-workspace-nav-btn small-workspace-nav-btn-left",attrs:{role:"button",tabindex:"0","aria-label":t.localization.leftButton,title:t.localization.leftButton},on:{click:function(e){return t.goLeft("button")}}},[i("svgicon",{staticClass:"chevron-left",attrs:{focusable:"false",name:"chevron-right"}})],1),t._v(" "),i("div",{staticClass:"lightbox-nav-dots-wrapper",attrs:{"data-lightbox-nav-dots-wrapper":"true"}},[i("div",{staticClass:"lightbox-nav-dots-grad-left"}),t._v(" "),i("div",{staticClass:"lightbox-nav-dots-grad-right"}),t._v(" "),i("div",{staticClass:"lightbox-nav-dots"},[i("lightbox-nav-dots")],1)]),t._v(" "),i("div",{ref:"nav-btn-right",staticClass:"lightbox-btn small-workspace-nav-btn small-workspace-nav-btn-right",attrs:{role:"button",tabindex:"0","aria-label":t.localization.rightButton,title:t.localization.rightButton},on:{click:function(e){return t.goRight("button")}}},[i("svgicon",{attrs:{focusable:"false",name:"chevron-right"}})],1)]):t._e(),t._v(" "),!t.isSmallWorkspace&&t.isNavEnabled?i("div",{staticClass:"lightbox-nav"},[i("lightbox-thumbnails")],1):t._e(),t._v(" "),i("div",{staticClass:"lightbox-overlay",on:{click:t.close}})],2)]),t._v(" "),i("span",{ref:"last-trap",attrs:{tabindex:"0","aria-hidden":"true"}})],1):t._e()},o=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:[{"lightbox-thumbnail-image":t.thumbnail}]},[i("transition",{attrs:{name:t.thumbnail?null:"image"}},[t.blobUrl?i("div",{staticClass:"image-wrapper"},[i("div",{staticClass:"image",style:t.imageStyle,attrs:{role:"img","aria-labelledby":"lightbox-description"},on:{click:function(e){!t.thumbnail&&t.isSmallWorkspace&&t.$emit("toggle-overlap-visibility")}}})]):t._e()]),t._v(" "),t.hasError?i("div",{staticClass:"icon-wrap"},[i("svgicon",{staticClass:"error-icon",attrs:{focusable:"false",name:"error"}})],1):t.blobUrl?t._e():i("div",{staticClass:"icon-wrap"},[i("spinner",{attrs:{size:t.thumbnail?12:36,"line-size":3,"line-fg-color":"#5692AE","line-bg-color":"#333"}})],1)],1)},a=[],n=i(9426),h=i(9937),l=i(776),c=i(5657),d=i(2918),p=i(2358);const g={},u={props:{currentItem:{type:Object,required:!1}},computed:{workspaceSize:function(){return this.$store.getters["workspace/size"]},isPortrait(){return this.$store.getters["workspace/isPortrait"]},isSmallWorkspace(){return this.$store.getters["workspace/isSmallWorkspace"]},isMobile(){return this.$store.getters["workspace/isMobile"]},isLocaleRtl:function(){return this.$store.getters["i18n/isLocaleRtl"]},isPublisher(){return this.$store.state.workspace.userAgentInfo.browser.publisher},buttonSize(){return this.isSmallWorkspace?this.$store.state.lightbox.smallWorkspaceButtonSize:this.$store.state.lightbox.buttonSize},bannerHeight(){return this.$store.state.workspace.bannerHeight}},methods:{getSafeAreaInset(t){return!this.isMobile||this.isPublisher?0:(g[this.workspaceSize.width]=g[this.workspaceSize.width]||{},void 0===g[this.workspaceSize.width][t]&&(g[this.workspaceSize.width][t]=Number(getComputedStyle(document.documentElement).getPropertyValue("--safe-area-inset-"+t).trim().slice(0,-2))),g[this.workspaceSize.width][t])}}};i(6177);const f={},m={components:{Spinner:n.Z},mixins:[u],props:{thumbnail:{type:Boolean,default:!1}},data:()=>({crossOrigin:(0,l.Z)().getCrossOrigin(),blobUrl:null,naturalWidth:null,naturalHeight:null,hasError:null}),computed:{isNavEnabled(){return this.$store.getters["lightbox/isNavEnabled"]},wrapperRect:function(){if(this.thumbnail)return this.$store.state.lightbox.thumbnailSizeLimits;if(!this.currentItem||!this.workspaceSize.width)return null;const t=this.getSafeAreaInset("top"),e=this.getSafeAreaInset("right"),i=this.getSafeAreaInset("bottom"),s=this.getSafeAreaInset("left"),o=t+"-"+e+"-"+i+"-"+s+"-"+this.isSmallWorkspace+"-"+this.isPortrait+"-"+this.isNavEnabled+"-"+this.workspaceSize.width+"-"+this.workspaceSize.height+"-"+this.bannerHeight;f[this.currentItem.name]=f[this.currentItem.name]||{};let r=f[this.currentItem.name][o];if(void 0===r){let a,n;a=this.currentItem.originalSize?{width:this.currentItem.originalSize[0],height:this.currentItem.originalSize[1]}:this.naturalWidth?{width:this.naturalWidth,height:this.naturalHeight}:{width:Math.round(this.currentItem.rect[0]*this.currentItem.scaleRatio.w),height:Math.round(this.currentItem.rect[1]*this.currentItem.scaleRatio.h)};const h=Math.max(s,e);if(this.isSmallWorkspace){const e=4;n=this.isPortrait?{width:this.workspaceSize.width-2*e,height:this.workspaceSize.height-2*this.buttonSize-this.navHeight-(this.bannerHeight||t)-i}:{width:this.workspaceSize.width-2*this.buttonSize-2*h,height:this.workspaceSize.height-this.bannerHeight-(this.navHeight||e)-i-e}}else{const t=this.isNavEnabled?Math.max(this.$store.state.lightbox.navAreaPadding,h):0;n={width:this.workspaceSize.width-2*(this.buttonSize+2*t),height:this.workspaceSize.height-this.bannerHeight-2*this.buttonSize-this.navHeight}}r=(0,d.Tj)(a,n,!0),r.width=Math.round(r.width)||1,r.height=Math.round(r.height)||1,f[this.currentItem.name][o]=r}return this.$emit("lightbox-rect",r),r},rawUrl:function(){return this.currentItem&&this.fileName?(0,p.n)({filenameOrUrl:this.fileName}):null},fileName(){const t=this.currentItem;if(!(t&&t.name&&t.sizes&&this.wrapperRect))return null;const e=Math.max(this.wrapperRect.width,this.wrapperRect.height),i=(0,c.F)({data:t,maxSize:e});return(0,l.Z)().getImageFileName(i)},imageStyle(){const{width:t,height:e}=this.wrapperRect;return{width:`${t}px`,height:`${e}px`,"background-size":this.thumbnail?"cover":`${t}px ${e}px`,"background-image":this.blobUrl?"url("+this.blobUrl+")":null}},navHeight(){return this.$store.getters["lightbox/navHeight"]}},watch:{rawUrl:{handler:function(t){this.clear(),t&&this.load()},immediate:!0}},methods:{clear(){this.blobUrl=null,this.naturalWidth=null,this.naturalHeight=null,this.hasError=null},load(){(0,h.Z)({url:this.rawUrl,callback:t=>{const e=document.createElement("img");e.onload=()=>{this.blobUrl=t,this.naturalWidth=e.naturalWidth,this.naturalHeight=e.naturalHeight,!this.thumbnail&&this.currentItem&&this.$root.$emit("image",{action:"loaded",pageId:this.currentItem.pageId,url:(0,c.q)(this.currentItem),lightboxUrl:window.location.href})},e.onerror=this.onLoadError,e.crossOrigin=this.crossOrigin,e.src=t,e.style.width="100%"},errorback:this.onLoadError})},onLoadError(t){console.error("Image loading error from LightboxImage component.",t),this.hasError=!0}}};var b=i(1900);const S=(0,b.Z)(m,r,a,!1,null,"c1eef398",null).exports;var v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-touch",[i("form-container",{ref:"formContainer",style:t.formContainerStyle,attrs:{url:t.currentItem.url,provider:t.currentItem.provider,msFormScaledSize:t.msFormScaledSize}})],1)},w=[],y=i(9712);const k={large:1,medium:.7,small:.5},x={components:{FormContainer:y.Z},mixins:[u],computed:{wrapperRect:function(){if(!this.currentItem||!this.workspaceSize.width)return null;const t=this.getSafeAreaInset("top"),e=this.getSafeAreaInset("right"),i=this.getSafeAreaInset("bottom"),s=this.getSafeAreaInset("left"),o=this.isSmallWorkspace?1:k[this.currentItem.popupSize]||1,r=this.isSmallWorkspace&&!this.isPortrait?8:2*this.buttonSize+2*Math.max(i,t),a=this.isSmallWorkspace&&this.isPortrait?8:2*this.buttonSize+2*Math.max(e,s),n=this.workspaceSize.width*o,h=this.workspaceSize.height*o,l=this.workspaceSize.width-a,c=this.workspaceSize.height-r,d={width:Math.min(n,l),height:Math.min(h,c)-this.bannerHeight};return"google"===this.currentItem.provider&&(d.width=Math.min(d.width,750)),d.width=Math.round(d.width)||1,d.height=Math.round(d.height)||1,this.$emit("lightbox-rect",d),d},formContainerStyle(){return{width:this.wrapperRect.width+"px",height:this.wrapperRect.height+"px"}},isSmallMSForm(){return(this.wrapperRect.width<=320||this.wrapperRect.height<=320)&&"office"===this.currentItem.provider},msFormScaledSize(){const t=(this.wrapperRect.width<=320?this.wrapperRect.width:this.wrapperRect.height)/325;let e=Math.ceil(this.wrapperRect.width/t),i=Math.ceil(this.wrapperRect.height/t);return i%2!=0&&i--,e%2!=0&&e--,this.isSmallMSForm?{width:e,height:i,scale:t}:null}},watch:{msFormScaledSize(t){this.$refs.formContainer.updateFormSize(t)}}};const $=(0,b.Z)(x,v,w,!1,null,null,null).exports;var z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"nav-dots"},t._l(t.currentContent,(function(e,s){return i("lightbox-nav-dot",{key:e.itemId,style:t.navDotsStyle,attrs:{item:e}})})),1)},P=[],C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.navDotClass,attrs:{"data-active":t.isActive,"data-active-gallery-item":t.isActive&&t.isGalleryItem}},[t.isGallery?t._l(t.item.items,(function(e,s){return i("lightbox-nav-dot",{key:t.item.itemId+"-"+s,attrs:{item:e,itemId:t.item.itemId,galleryItemIndex:s}})})):i("div",{staticClass:"circle"})],2)},T=[];const M={name:"lightbox-nav-dot",props:{item:{type:Object,required:!0},galleryItemIndex:{type:Number},itemId:{type:Number}},computed:{navDotClass(){return{"nav-dot":!this.isGallery,gallery:this.isGallery,active:this.isActive,"gallery-item":this.isGalleryItem}},isGallery(){return"gallery"===this.item.type},isGalleryItem(){return this.galleryItemIndex||0===this.galleryItemIndex},currentItemId(){return this.$store.state.lightbox.currentItemId},currentGalleryItemIndex(){return this.$store.state.lightbox.currentGalleryItemIndex},isActive(){return this.isGalleryItem?this.itemId===this.currentItemId&&this.galleryItemIndex===this.currentGalleryItemIndex:this.item.itemId===this.currentItemId}}};const I={components:{LightboxNavDot:(0,b.Z)(M,C,T,!1,null,"430c6897",null).exports},data:()=>({translateX:0}),mounted(){setTimeout(this.moveDots)},computed:{currentContent(){return this.$store.getters["lightbox/currentContent"]},currentItemId(){return this.$store.state.lightbox.currentItemId},currentGalleryItemIndex(){return this.$store.state.lightbox.currentGalleryItemIndex},navDotsStyle(){return{transform:"translateX("+this.translateX+"px)"}}},watch:{currentItemId(t){t&&this.$nextTick(this.moveDots)},currentGalleryItemIndex(t){(t||0===t)&&this.$nextTick(this.moveDots)}},methods:{moveDots(){const t=this.$el.querySelector("[data-active]"),e=null===this.currentGalleryItemIndex?null:this.$el.querySelector("[data-active-gallery-item]"),i=(e||t).offsetWidth,s=document.querySelector("[data-lightbox-nav-dots-wrapper]").offsetWidth;this.translateX=s/2-t.offsetLeft-i/2,e&&(this.translateX=this.translateX-e.offsetLeft-2)}}};const L=(0,b.Z)(I,z,P,!1,null,"7fd5bd80",null).exports;var R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lightbox-thumbnails",style:t.thumbnailsStyle},[t._l(t.currentContent,(function(e,s){return i("lightbox-thumbnail",{key:e.itemId,attrs:{index:s,thumbnail:t.thumbnails[s]}})})),t._v(" "),i("transition",{attrs:{name:"pager"}},["gallery"===t.currentContent[t.currentItemIndex].type?i("div",{staticClass:"lightbox-thumbnails-pager",attrs:{dir:t.workspaceDir}},[i("span",[t._v(t._s(t.currentGalleryItemIndex+1+" / "+t.currentContent[t.currentItemIndex].items.length))])]):t._e()])],2)},E=[],F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.thumbnailClass,style:t.thumbnailStyle,on:{click:function(e){!t.thumbnail.isActive&&t.lightboxGoTo(e)}}},["image"===t.thumbnail.type?i("lightbox-image",{attrs:{currentItem:t.thumbnail,thumbnail:!0}}):t.isGallery?i("div",{staticClass:"gallery-items-wrapper",attrs:{dir:"ltr"}},t._l(t.thumbnail.items,(function(e,s){return i("div",{key:s,class:["gallery-item",{active:t.thumbnail.isActive&&s===t.thumbnail.galleryItemIndex}],style:{width:t.thumbnailsSizes[t.thumbnail.itemId][s].width+"px",height:t.thumbnailsSizes[t.thumbnail.itemId][s].height+"px"},on:{click:function(e){return t.lightboxGoTo(e,s)}}},["image"===e.type?i("lightbox-image",{attrs:{currentItem:e,thumbnail:!0}}):t._e()],1)})),0):t._e()],1)},O=[];const _={components:{LightboxImage:S},props:{thumbnail:{type:Object,required:!0,default:()=>({})}},computed:{isGallery(){return"gallery"===this.thumbnail.type},thumbnailStyle(){return{transform:"translateX("+this.thumbnail.translateX+"px)",width:this.isGallery?this.$store.getters["lightbox/galleriesThumbnailsWidth"][this.thumbnail.itemId]+"px":this.thumbnailsSizes[this.thumbnail.itemId].width+"px",height:this.isGallery?null:this.thumbnailHeight+"px"}},thumbnailHeight(){if(this.isGallery){const t=this.thumbnailsSizes[this.thumbnail.itemId].map((t=>t.height));return Math.max(...t)}return this.thumbnailsSizes[this.thumbnail.itemId].height},thumbnailTop(){return this.$store.state.lightbox.thumbnailsPaddingTop+this.$store.state.lightbox.thumbnailBaseMargin+this.$store.state.lightbox.thumbnailBorderWidth+(this.$store.state.lightbox.thumbnailSizeLimits.height-this.thumbnailHeight)/2},thumbnailClass(){return{"lightbox-thumbnail":!0,active:this.thumbnail.isActive,gallery:this.isGallery}},thumbnailsSizes(){return this.$store.getters["lightbox/thumbnailsSizes"]}},methods:{lightboxGoTo(t,e){t.target.classList.contains("image")&&this.$store.dispatch("lightbox/lightboxGoTo",{itemId:this.thumbnail.itemId,galleryItemIndex:e,target:"th-click",type:this.thumbnail.type})}}};const D={components:{LightboxThumbnail:(0,b.Z)(_,F,O,!1,null,"65764538",null).exports},data:()=>({thumbnails:[]}),created(){this.moveThumbnails()},computed:{currentContent(){return this.$store.getters["lightbox/currentContent"]},currentItemState(){return{itemId:this.currentItemId,itemIndex:this.currentItemIndex,galleryItemIndex:this.currentGalleryItemIndex}},currentItemId(){return this.$store.state.lightbox.currentItemId},currentItemIndex(){return this.$store.getters["lightbox/currentItemIndex"]},currentGalleryItemIndex(){return this.$store.state.lightbox.currentGalleryItemIndex},thumbnailsOffsetsLeft(){return this.$store.getters["lightbox/thumbnailsOffsetsLeft"]},workspaceSize:function(){return this.$store.getters["workspace/size"]},workspaceDir(){return this.$store.getters["i18n/isLocaleRtl"]?"rtl":"ltr"},thumbnailsStyle(){return{"--thumbnail-margin":this.$store.getters["lightbox/thumbnailMargin"]+"px","--thumbnail-base-margin":this.$store.state.lightbox.thumbnailBaseMargin+"px"}}},watch:{currentItemState(t,e){!t.itemId||t.itemId===e.itemId&&t.galleryItemIndex===e.galleryItemIndex||(t.itemIndex===e.itemIndex&&t.galleryItemIndex!==e.galleryItemIndex||t.itemIndex!==e.itemIndex)&&this.$nextTick(this.moveThumbnails)},workspaceSize(t,e){t.width===e.width&&t.height===e.height||this.$nextTick(this.moveThumbnails)}},methods:{moveThumbnails(){this.workspaceSize.width&&(this.thumbnails.length!==this.currentContent.length&&(this.thumbnails=this.currentContent.map((t=>({...t})))),this.thumbnails.forEach((t=>{const e=t.itemId===this.currentItemId;this.$set(t,"isActive",e),"gallery"===t.type&&e&&this.$set(t,"galleryItemIndex",this.currentGalleryItemIndex)})),setTimeout((()=>{const t=this.thumbnailsOffsetsLeft[this.currentItemId],e=this.$store.getters["lightbox/currentThumbnailWidth"]/2,i=this.$store.getters["lightbox/currentGalleryItemThumbnailOffsetLeft"],s=Math.round(this.workspaceSize.width/2);this.thumbnails.forEach((o=>{this.$set(o,"translateX",this.thumbnailsOffsetsLeft[o.itemId]+s-t-i-e)})),this.$store.commit("lightbox/SET_THUMBNAILS_READY",!0)})))}}};const W=(0,b.Z)(D,R,E,!1,null,"511b6300",null).exports;i(3374),i(1691);var B=i(1909);const A={components:{LightboxImage:S,LightboxForm:$,LightboxNavDots:L,LightboxThumbnails:W},data:()=>({isOverlapVisible:!0,isDescriptionOverflowing:null,isDescriptionExpanded:!1,lightboxRect:{width:null,height:null},item:null,isFocusTrapped:!1}),computed:{show(){return this.isLightboxShown&&this.item&&null!==this.isSmallWorkspace},isLightboxShown(){return this.$store.getters["lightbox/isShown"]},isLightboxActive:{get(){return this.$store.state.lightbox.isLightboxActive},set(t){this.$store.commit("lightbox/SET_LIGHTBOX_ACTIVE",t,{root:!0})}},isSpreadMode(){return this.$store.state.pager.spreadMode},isNavEnabled(){return this.$store.getters["lightbox/isNavEnabled"]},currentItem(){return this.$store.getters["lightbox/currentItem"]},currentGalleryItem(){return this.$store.getters["lightbox/currentGalleryItem"]},currentLightboxItem(){return this.currentItem?"gallery"===this.currentItem.type?this.currentGalleryItem:this.currentItem:null},isRtl(){return this.$store.getters["i18n/isLocaleRtl"]},lightboxStyle(){return{top:`${this.bannerHeight}px`,"--button-size":this.isSmallWorkspace?this.$store.state.lightbox.smallWorkspaceButtonSize+"px":this.$store.state.lightbox.buttonSize+"px","--nav-area-padding":this.$store.state.lightbox.navAreaPadding+"px","--thumbnails-height":this.$store.getters["lightbox/thumbnailsHeight"]+"px","--thumbnails-padding-top":this.$store.state.lightbox.thumbnailsPaddingTop+"px","--thumbnails-padding-bottom":this.$store.state.lightbox.thumbnailsPaddingBottom+"px"}},lightboxSizeStyle(){return this.lightboxRect.width&&this.lightboxRect.height?{width:this.lightboxRect.width+"px",height:this.lightboxRect.height+"px"}:{}},localization(){const t=this.$t("Lightbox.NEXT_BUTTON_TEXT"),e=this.$t("Lightbox.PREV_BUTTON_TEXT");return{closeButton:this.$t("Lightbox.CLOSE_BUTTON_TEXT"),leftButton:this.isRtl?t:e,rightButton:this.isRtl?e:t}},isMobile(){return this.$store.getters["workspace/isMobile"]},isSmallWorkspace(){return this.$store.getters["workspace/isSmallWorkspace"]},currentGalleryItemIndex(){return this.$store.state.lightbox.currentGalleryItemIndex},descriptionClasses(){return["lightbox-description",{"lightbox-description-expandable":this.isDescriptionOverflowing,"lightbox-description-expanded":this.isDescriptionExpanded}]},descriptionMore(){return this.isDescriptionExpanded?this.$t("Lightbox.DESCRIPTION_HIDE"):"..."+this.$t("Lightbox.DESCRIPTION_SHOW_MORE")},lightboxClasses(){return["lightbox",{"small-workspace":this.isSmallWorkspace,"nav-enabled":this.isNavEnabled}]},areThumbnailsReady(){return this.$store.state.lightbox.areThumbnailsReady},bannerHeight(){return this.$store.state.workspace.bannerHeight},closeButtonStyle(){return{top:this.isSmallWorkspace?`${this.bannerHeight}px`:null}}},mounted(){this.$root.$on("lightbox-go-right",this.goRight),this.$root.$on("lightbox-go-left",this.goLeft),this.$root.$on("lightbox-close",this.close)},watch:{show:{handler:function(t,e){t&&!e?(this.$root.$emit("popupStateChanged",{state:1}),this.$nextTick((()=>{this.isLightboxActive=!0,this.$store.commit("sound/SET_MUTE_TEMPORARY",!1)}))):!this.isLightboxShown&&this.isLightboxActive&&this.close()},immediate:!0},isLightboxActive(t,e){t&&!e?(this.emitLightboxEvent("open"),this.emitLightboxEvent("show_content")):!t&&e&&this.emitLightboxEvent("close")},currentLightboxItem(t,e){if(!t)return this.item=null,this.isFocusTrapped=!1,this.isDescriptionOverflowing=null,void(this.isDescriptionExpanded=!1);switch(t.type){case"image":case"gallery":this.createImageItem(t);break;case"form":this.createFormItem(t)}}},beforeDestroy(){this.$root.$off("lightbox-go-right",this.goRight),this.$root.$off("lightbox-go-left",this.goLeft),this.$root.$off("lightbox-close",this.close)},methods:{toggleOverlapVisibility(){this.isOverlapVisible=!this.isOverlapVisible},toggleDescription(){this.isDescriptionExpanded=!this.isDescriptionExpanded},close(){this.$root.$emit("popupStateChanged",{state:0}),this.$store.dispatch("lightbox/closeLightbox")},goRight(t){this.isOverlapVisible=!0,this.isRtl?this.$store.dispatch("lightbox/lightboxGoPrev",t):this.$store.dispatch("lightbox/lightboxGoNext",t),this.emitLightboxEvent("show_content")},goLeft(t){this.isOverlapVisible=!0,this.isRtl?this.$store.dispatch("lightbox/lightboxGoNext",t):this.$store.dispatch("lightbox/lightboxGoPrev",t),this.emitLightboxEvent("show_content")},emitLightboxEvent(t){if(!this.currentLightboxItem)return;const e=["open","show_content"].includes(t)?500:0;setTimeout((()=>{this.$root.$emit("lightbox",{action:t,openTarget:"open"===t||"show_content"===t?this.$store.state.lightbox.target:null,itemType:this.currentLightboxItem.type,itemId:this.$store.state.lightbox.currentItemId,galleryItemIndex:this.currentGalleryItemIndex,itemUrl:(0,c.q)(this.currentLightboxItem),lightboxUrl:window.location.href,pageId:this.currentItem.pageId,formUrl:"form"===this.currentItem.type?this.currentItem.url:null})}),e)},setLightboxRect(t){this.lightboxRect.width=t.width,this.lightboxRect.height=t.height},setFocusTraps(t){let{justResetFocus:e}=t;const i=this.$refs["first-trap"],s=this.$refs["last-trap"],o=this.$refs["nav-btn-right"],r=this.$refs["nav-btn-left"],a=this.$refs["btn-close"];a&&(this.isNavEnabled?(this.isRtl?r.focus():o.focus(),e||(i.addEventListener("focusin",(t=>{t.relatedTarget!==r?o.focus():a.focus()})),s.addEventListener("focusin",(t=>{a.focus()})),this.isFocusTrapped=!0)):a.focus())},getElementComponent(t){switch(t.type){case"image":return"lightbox-image";case"form":return"lightbox-form"}return null},createImageItem(t){let e;this.isMobile||this.setFocusTraps({justResetFocus:this.isFocusTrapped}),this.currentItem&&(e=this.currentItem.itemId+("gallery"===this.currentItem.type?"-"+this.currentGalleryItemIndex:"")),this.item?.key!==e&&(this.item={component:this.getElementComponent(t),data:t,key:e},this.isDescriptionOverflowing=null,this.isDescriptionExpanded=!1,t.descriptionByType&&setTimeout((()=>{const t=48;this.isDescriptionOverflowing=this.$refs["description-placeholder"].scrollHeight>=t,!this.isMobile&&this.isDescriptionOverflowing&&this.$nextTick((()=>{this.$refs["lightbox-description"].addEventListener("focusin",(t=>{this.isDescriptionExpanded=!0})),this.$refs["lightbox-description"].addEventListener("focusout",(t=>{this.isDescriptionExpanded=!1}))}))}),100))},createFormItem(t){this.item=t?{component:this.getElementComponent(t),data:{url:t.url,popupSize:t.popupSize,provider:(0,B.V)(t.url)}}:null}}};const H=(0,b.Z)(A,s,o,!1,null,"66001db2",null).exports},9426:(t,e,i)=>{"use strict";i.d(e,{Z:()=>c});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"vue-simple-spinner",style:t.spinnerStyle}),t._v(" "),t.message.length>0?i("div",{staticClass:"vue-simple-spinner-text",style:t.textStyle},[t._v("\n        "+t._s(t.message)+"\n    ")]):t._e()])},o=[];const r=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},a=16;let n=0,h=0;const l={props:{size:{default:32},"line-size":{type:Number,default:3},"line-bg-color":{type:String,default:"#eee"},"line-fg-color":{type:String,default:"#2196f3"},speed:{type:Number,default:.8},sync:{type:Boolean,default:!1},spacing:{type:Number,default:4},message:{type:String,default:""},"font-size":{type:Number,default:13},"text-fg-color":{type:String,default:"#555"}},data:()=>({syncAngle:null}),mounted(){this.sync&&(this.syncAngle=n,requestAnimationFrame(this.rotate),h++)},beforeDestroy(){clearTimeout(this.rotateTimeoutId),h--,h||(n=0)},computed:{oneDegDelay(){return 1e3*this.speed/360},syncStep(){return Math.round(a/this.oneDegDelay)},spinnerSize(){switch(this.size){case"tiny":return 12;case"small":return 16;case"medium":return 32;case"large":return 48;case"big":return 64;case"huge":return 96;case"massive":return 128}return r(this.size)?this.size:32},spinnerBorderWidth(){switch(this.size){case"tiny":return 1;case"small":return 2;case"medium":case"large":return 3;case"big":case"huge":return 4;case"massive":return 5}return r(this.lineSize)?this.lineSize:4},spinnerStyle(){return{border:this.spinnerBorderWidth+"px solid "+this.lineBgColor,borderTop:this.spinnerBorderWidth+"px solid "+this.lineFgColor,width:this.spinnerSize+"px",height:this.spinnerSize+"px",animation:this.sync?null:"vue-simple-spinner-spin "+this.speed+"s linear infinite",transition:this.sync?null:"all  0.3s linear",transform:this.sync?"rotate("+this.syncAngle+"deg)":null}},textStyle(){let t,e;switch(this.size){case"tiny":case"small":case"medium":case"large":case"big":case"huge":case"massive":t=Math.min(Math.max(Math.ceil(this.spinnerSize/8),3),12),e=Math.min(Math.max(Math.ceil(.4*this.spinnerSize),11),32);break;default:t=r(this.spacing)?this.spacing:4,e=r(this.fontSize)?this.fontSize:13}return{marginTop:t+"px",fontSize:e+"px",color:this.textFgColor}}},methods:{rotate:function(){this.rotateTimeoutId=setTimeout((()=>{this.syncAngle===n?(this.syncAngle=this.syncAngle+this.syncStep,this.syncAngle=this.syncAngle>360?this.syncAngle-360:this.syncAngle,n=this.syncAngle):this.syncAngle=n,requestAnimationFrame(this.rotate)}),a)}}};const c=(0,i(1900).Z)(l,s,o,!1,null,null,null).exports},7503:(t,e,i)=>{"use strict";i.d(e,{Z:()=>l});var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.className,style:t.pageStyle},[t.preloaderVisible?i("div",{staticClass:"preloader",attrs:{"aria-hidden":"true"}},[i("div",{staticClass:"preloader-container"},[t.isLoading?i("spinner",{staticClass:"preloader-spinner",attrs:{size:t.preloaderSize,"line-size":t.preloaderLineSize,"line-fg-color":"#5692AE","line-bg-color":"#ffffff"}}):t._e()],1)]):t._e(),t._v(" "),t.rightPreloaderVisible?i("div",{staticClass:"preloader right",attrs:{"aria-hidden":"true"}},[i("div",{staticClass:"preloader-container"},[t.isLoading?i("spinner",{staticClass:"preloader-spinner",attrs:{size:t.preloaderSize,"line-size":t.preloaderLineSize,"line-fg-color":"#5692AE","line-bg-color":"#ffffff"}}):t._e()],1)]):t._e(),t._v(" "),t.enforceWhiteBg?i("img",{staticClass:"enforce-white-bg",attrs:{src:t.whitePixelUrl}}):t._e(),t._v(" "),t.background?i("img",{staticClass:"background",style:t.contentStyle,attrs:{crossOrigin:t.crossOrigin,src:t.background,role:"img","data-id":t.pageId,title:t.$t("AlertMessage.LINK_PAGE_TIP"),"aria-label":t.$t("AlertMessage.LINK_PAGE_TIP"),alt:t.imageAlt}}):t._e()])},o=[],r=i(9426),a=i(776),n=i(2918);const h={name:"Thumb",props:{id:{type:[String,Number],required:!0},side:{type:String,required:!1,default:"both",validator:function(t){return-1!==["left","right","both"].indexOf(t)}},size:{type:Object,required:!1,default:null},contentCrop:{type:Boolean,default:!1},showPreloader:{type:Boolean,default:!0}},data:function(){return{isReady:!0,pageId:this.id,pageSide:this.side,crossOrigin:(0,a.Z)().getCrossOrigin(),isWide:!1,hasMargins:!0,isStub:!1,hasError:!1,backgroundColor:"#ffffff",thumbnailUrl:null,pageResize:null,contentWidth:0,contentHeight:0,whitePixelUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="}},components:{spinner:r.Z},beforeMount:function(){this.getProperties()},watch:{id:function(t){this.pageId=t},side:function(t){this.pageSide=t},changeProperty:function(t){t.pageID===this.pageId&&this.getProperties()},pageId:function(){this.getProperties()}},methods:{getProperties(){this.isWide=this.$store.getters["pages/pageProp"](this.pageId,"wide"),this.hasMargins=this.$store.getters["pages/pageProp"](this.pageId,"hasMargins"),this.isStub=this.$store.getters["pages/pageProp"](this.pageId,"stub"),this.hasError=-1===this.$store.getters["pages/pageProp"](this.pageId,"thumbnailUrl"),this.backgroundColor=this.$store.getters["pages/pageProp"](this.pageId,"backgroundColor"),this.thumbnailUrl=this.$store.getters["pages/pageProp"](this.pageId,"thumbnailUrl"),this.pageResize=this.$store.getters["pages/pageProp"](this.pageId,"pageResize"),this.contentWidth=this.$store.getters["pages/pageProp"](this.pageId,"width")/this.contentWidthMultiplier,this.contentHeight=this.$store.getters["pages/pageProp"](this.pageId,"height")}},computed:{imageAlt(){return this.$i18n.t("AlertMessage.LINK_PAGE_TIP")+" "+this.pageCaption+" ("+this.$i18n.t("ThumbnailsToolWindow.TITLE")+")"},pageCaption(){return this.$store.getters["pages/pageCaptionById"]({id:this.id})},className(){return{thumb:!0,double:this.bookMode&&this.isWide&&"both"===this.pageSide,loading:this.isLoading,unready:!this.isReady,error:this.hasError}},preloaderVisible(){return this.showPreloader&&!this.isStub&&(this.isLoading||!this.isReady||this.hasError)},rightPreloaderVisible(){return this.preloaderVisible&&this.bookMode&&this.isWide&&"both"===this.pageSide},preloaderSize(){const t=2,e=this.contentCrop?this.contentSize.height:this.pageSize.height,i=this.contentCrop?this.contentSize.width:this.pageSize.width,s=Math.min(i,e)-2*t;return Math.min(24,s)},preloaderLineSize:()=>2,enforceWhiteBg(){return this.$store.state.workspace.alteredSVGColors&&this.$store.state.workspace.userAgentInfo.browser.samsung},background(){if(!this.pageId||!this.isReady||this.hasError)return null;if(this.isStub){this.$store.state.workspace.policiesUpdated;return this.enforceWhiteBg?this.whitePixelUrl:(0,a.Z)().translatePath("assets/pages/pagestub.png")}return this.thumbnailUrl?this.thumbnailUrl:null},isLoading(){return!this.thumbnailUrl||(0===this.$store.state.pages.size.width||null===this.$store.state.pages.size.width)},pageWidthMultiplier(){return this.isWide&&"both"===this.pageSide?2:1},contentWidthMultiplier:function(){return this.isWide&&"both"!==this.pageSide?"2":"1"},pagesSize(){return this.$store.getters["pages/size"]},pageSize(){return this.size&&this.size.width&&this.size.height?{width:this.size.width,height:this.size.height}:{width:this.pagesSize.width*this.pageWidthMultiplier,height:1*this.pagesSize.height}},singleMode(){return this.$store.state.pager.singleMode},slideMode(){return this.$store.state.pager.slideMode},bookMode(){return this.$store.state.pager.spreadMode},pageStyle(){return{width:(this.contentCrop?this.contentSize.width:this.pageSize.width)+"px",height:(this.contentCrop?this.contentSize.height:this.pageSize.height)+"px","background-color":this.enforceWhiteBg?null:this.backgroundColor}},contentSize(){if(this.pageId){const t=this.pageResize,e=this.contentWidth,i=this.contentHeight,s="FIT"===t?n.Tj:n.hl,o=!(this.$store.state.workspace.userAgentInfo.browser.publisher?(0,n.lx)({rect:{width:e,height:i},bounds:this.$store.state.book.bookSize}):this.hasMargins)||this.slideMode&&this.contentCrop?this.pageSize:s({width:e,height:i},this.pageSize);return{width:Math.ceil(o.width),height:Math.ceil(o.height),scaleRatio:{w:o.width/e,h:o.height/i}}}return{width:0,height:0,scaleRatio:{w:0,h:0}}},contentStyle(){const t=this.contentCrop?0:(this.pageSize.width-this.contentSize.width)/(this.isWide&&"both"!==this.pageSide?1:2),e=this.contentCrop?0:(this.pageSize.height-this.contentSize.height)/2,i={width:this.contentSize.width*this.contentWidthMultiplier+"px",height:this.contentSize.height+"px"};return"right"===this.pageSide?(i.right="0",t&&(i.marginRight=t+"px")):(i.left="0",t&&(i.marginLeft=t+"px")),e&&(i.marginTop=e+"px"),i},changeProperty(){return this.$store.state.pages.changeInPage}}};const l=(0,i(1900).Z)(h,s,o,!1,null,null,null).exports},9712:(t,e,i)=>{"use strict";i.d(e,{Z:()=>n});var s=function(){var t=this,e=t.$createElement;return(t._self._c||e)("v-touch",{style:t.formContainerStyle})},o=[],r=i(1909);const a={name:"FormContainer",props:{url:{type:String,required:!1},provider:{type:String,required:!1},msFormScaledSize:{type:Object,default:null}},data:function(){return{formId:(0,r.c)(this.url)}},mounted(){switch(this.provider){case"typeform":this.iframe=document.createElement("iframe"),this.iframe.src=this.url,this.iframe.style.border="none",this.iframe.allowFullscreen=!0;break;case"google":this.iframe=document.createElement("iframe");const t=this.url.split("?");this.iframe.src=t[0]+"?embedded=true",this.iframe.innerHTML="Loading";break;case"office":case"microsoft":this.iframe=document.createElement("iframe"),this.iframe.src=this.url+"&embedded=true",this.iframe.style.border="none",this.iframe.allowFullscreen=!0}this.iframe&&(this.isMobile&&(document.body.style["overscroll-behavior-y"]="none",document.body.style.overflow="hidden"),this.iframe.style.frameBorder=0,this.iframe.style.marginHeight=0,this.iframe.style.marginWidth=0,this.updateFormSize(this.msFormScaledSize),this.$el.appendChild(this.iframe))},beforeDestroy(){this.iframe&&this.iframe.remove(),delete this.iframe,this.isMobile&&(document.body.style["overscroll-behavior-y"]="",document.body.style.overflow="")},computed:{formContainerStyle(){return{"background-color":"google"===this.provider?"#fff":null}},isMobile(){return this.$store.getters["workspace/isMobile"]}},methods:{updateFormSize:function(t){t?(this.iframe.style.width=`${t.width}px`,this.iframe.style.height=`${t.height}px`,this.iframe.style.transform=`scale(${t.scale})`,this.iframe.style["transform-origin"]="left top"):(this.iframe.style.width="100%",this.iframe.style.height="100%",this.iframe.style.transform=null,this.iframe.style["transform-origin"]=null)}}};const n=(0,i(1900).Z)(a,s,o,!1,null,null,null).exports},4186:(t,e,i)=>{var s={"./":[2565,17],"./arrow":[4902,22],"./arrow.js":[4902,22],"./audio":[2400,16],"./audio.js":[2400,16],"./cart":[7875,26],"./cart.js":[7875,26],"./close":[5483,23],"./close.js":[5483,23],"./error":[6177],"./error.js":[6177],"./gallery":[7537,25],"./gallery.js":[7537,25],"./gif":[4582,21],"./gif.js":[4582,21],"./image":[4136,20],"./image.js":[4136,20],"./index":[2565,17],"./index.js":[2565,17],"./made-with":[5284],"./made-with.js":[5284],"./page":[9719],"./page-wide":[1619],"./page-wide.js":[1619],"./page.js":[9719],"./pause":[8175,27],"./pause.js":[8175,27],"./play":[9783,30],"./play.js":[9783,30],"./point":[9596,29],"./point.js":[9596,29],"./replay":[148],"./replay.js":[148]};function o(t){if(!i.o(s,t))return Promise.resolve().then((()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=s[t],o=e[0];return Promise.all(e.slice(1).map(i.e)).then((()=>i.t(o,23)))}o.keys=()=>Object.keys(s),o.id=4186,t.exports=o}}]);